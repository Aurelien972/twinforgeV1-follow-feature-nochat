import{r as h,j as s}from"./vendor-ZbFMzY-i.js";import{a as H,b as J}from"./stores-ZZM8MTtI.js";import{i as K,j as Q,F as W,k as X,l as Y}from"./page-fridge-scan-C_CisW7P.js";import{o as Z,l as n}from"./page-fridge-C1QVLxk9.js";import{m as $}from"./motion-HGAT--uT.js";import"./utils-CUtLAp28.js";import"./supabase-8_3juhcZ.js";import"./ui-components-OHztaiDj.js";import"./date-utils-BlBdbPk_.js";const pe=()=>{const{profile:p}=H(),[C,y]=h.useState(!1),o=h.useRef(null),{currentStep:e,isActive:i,currentSessionId:t,simulatedOverallProgress:d,simulatedLoadingStep:F,simulatedScanProgress:m,loadingState:c,loadingMessage:u,capturedPhotos:r,rawDetectedItems:g,userEditedInventory:v,suggestedComplementaryItems:S,steps:f,startScan:E,resumePipeline:A,goToStep:a,previousStep:I,setLoadingState:D,startProgressSimulation:x,processVisionResults:G,setSuggestedComplementaryItems:R,addCapturedPhotos:j,updateInventory:_,removeCapturedPhoto:k,resetPipeline:N,addSelectedComplementaryItems:w}=J();K({isActive:i,currentStep:e,currentSessionId:t,simulatedOverallProgress:d,loadingState:c,capturedPhotos:r,startScan:E,resumePipeline:A});const{handleManualExit:P,handleInventoryUpdate:O,handleFileSelect:B,removePhoto:T,handleAnalyzePhotos:U}=Q({currentStep:e,loadingState:c,isActive:i,currentSessionId:t,capturedPhotos:r,rawDetectedItems:g,suggestedComplementaryItems:S,goToStep:a,setLoadingState:D,startProgressSimulation:x,processVisionResults:G,setSuggestedComplementaryItems:R,addCapturedPhotos:j,updateInventory:_,removeCapturedPhoto:k,resetPipeline:N}),b=p?Z.checkCompleteness(p):null,L=()=>{n.info("FRIDGE_SCAN_PAGE","Camera capture requested",{currentStep:e,sessionId:t,timestamp:new Date().toISOString()}),o.current&&o.current.click()},M=()=>{n.info("FRIDGE_SCAN_PAGE","File upload requested",{currentStep:e,sessionId:t,timestamp:new Date().toISOString()}),o.current&&o.current.click()},V=()=>{n.info("FRIDGE_SCAN_PAGE","Continuing to validation step",{currentStep:e,sessionId:t,timestamp:new Date().toISOString()}),a("validation")},q=()=>{n.info("FRIDGE_SCAN_PAGE","Going back to photo step",{currentStep:e,sessionId:t,timestamp:new Date().toISOString()}),a("photo")},z=()=>{n.info("FRIDGE_SCAN_PAGE","Going to previous step",{currentStep:e,sessionId:t,timestamp:new Date().toISOString()}),I()};return s.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[s.jsx(W,{currentStep:f.find(l=>l.id===e)||f[0],overallProgress:d,stepProgress:m,loadingMessage:u}),s.jsx(X,{isActive:i,currentStep:e,onManualExit:P}),s.jsx("input",{ref:o,type:"file",accept:"image/png,image/jpeg,image/jpg,image/gif,image/webp",multiple:!0,style:{display:"none"},onChange:l=>B(l.target.files)}),s.jsx(Y,{currentStep:e,capturedPhotos:r,simulatedLoadingStep:F,simulatedScanProgress:m,loadingMessage:u,userEditedInventory:v,suggestedComplementaryItems:S,rawDetectedItems:g,profileCompletion:b,nudgeDismissed:C,onCameraCapture:L,onFileUpload:M,onRemovePhoto:T,onAnalyzePhotos:U,onInventoryUpdate:O,onContinueToValidation:V,onBackToPhoto:q,onBack:z,onNudgeDismiss:()=>y(!0),addSelectedComplementaryItems:w,goToStep:a,previousStep:I,handleManualExit:P})]})};export{pe as default};
