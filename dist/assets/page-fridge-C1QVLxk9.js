import{r as j,j as e,u as ne,b as jt,R as ce,c as ct}from"./vendor-ZbFMzY-i.js";import{u as wt,a as ve,b as ye,c as Nt,d as Ce,g as Ze,e as kt,f as Be}from"./stores-ZZM8MTtI.js";import{G as E,S as p,I as d,P as St,a as Ct,u as _e,b as It}from"./ui-components-OHztaiDj.js";import{m as k,A as de}from"./motion-HGAT--uT.js";import{f as Ge,a as Xe}from"./date-utils-BlBdbPk_.js";import{c as Et}from"./supabase-8_3juhcZ.js";const Ft="modulepreload",Tt=function(t){return"/"+t},et={},Pt=function(r,s,a){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");n=Promise.allSettled(s.map(c=>{if(c=Tt(c),c in et)return;et[c]=!0;const x=c.endsWith(".css"),g=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const m=document.createElement("link");if(m.rel=x?"stylesheet":Ft,x||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),x)return new Promise((u,b)=>{m.addEventListener("load",u),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return r().catch(i)})},tt={development:{level:"info"},staging:{level:"info"},production:{level:"warn"}};function Rt(){return tt["production"]||tt.development}let dt=null;function Dt(t){dt=t}function At(){try{return dt?.()||{}}catch(t){return console.warn("Failed to get context from provider:",t),{}}}function pe(t){const r=Rt(),s={trace:0,debug:1,info:2,warn:3,error:4},a=s[r.level];return s[t]>=a}function me(t,r,s,a){const n=At();let i,o,l;a!==void 0?(i=r,o=s,l=a):typeof s=="string"?(i=r,o=s,l=void 0):(i=void 0,o=r,l=s),l&&typeof l!="object"&&(o=`${o} — ${String(l)}`,l=void 0);const c=i?`${i} — ${o}`:o,x={...n,...i&&{category:i},...l||{}};return{level:t,message:c,timestamp:new Date().toISOString(),context:x}}function xt(t,r,s){if(!pe("trace"))return;const a=me("trace",t,r,s);console.trace(JSON.stringify(a,null,2))}function pt(t,r,s){if(!pe("debug"))return;const a=me("debug",t,r,s);console.debug(JSON.stringify(a,null,2))}function mt(t,r,s){if(!pe("info"))return;const a=me("info",t,r,s);console.log(JSON.stringify(a,null,2))}function gt(t,r,s){if(!pe("warn"))return;const a=me("warn",t,r,s);console.warn(JSON.stringify(a,null,2))}function ut(t,r,s){if(!pe("error"))return;const a=me("error",t,r,s);console.error(JSON.stringify(a,null,2))}function Bt(t,r,s,a){if(!pe("info"))return;const n=Number.isFinite(r)&&!Number.isNaN(r)?Math.max(0,Math.min(100,r)):0,i=me("info",`${t}: ${n}% - ${s}`,{category:t,progress:n,message:s,...a&&{subMessage:a}});console.log(JSON.stringify(i,null,2))}function _t(t,r,s={}){if(!pe("error"))return;const a=r,n=me("error",t,{error:{name:a?.name||"Unknown",message:a?.message||"No message",stack:a?.stack||"No stack trace"},...s});console.error(JSON.stringify(n,null,2))}const N={trace:xt,info:mt,warn:gt,debug:pt,error:ut,progress:Bt,logError:_t,logOnce:Mt,setContextProvider:Dt,jsonLog:zt},rt=new Set;function Mt(t,r,s,a){if(!rt.has(t))switch(rt.add(t),r){case"trace":xt(s,a);break;case"debug":pt(s,a);break;case"info":mt(s,a);break;case"warn":gt(s,a);break;case"error":ut(s,a);break}}function zt(t,r,s){if(!pe("info"))return;const a=me("info",`${t}: ${r}`,{category:t,data:s,structured:!0});console.log(JSON.stringify(a,null,2))}const re={supabaseUrl:(()=>{const t="https://kwipydbtjagypocpvbwn.supabase.co".trim()||"";return t&&(t.includes("supabase.co")||t.includes("supabase.in"))?t.replace(/^http:\/\//,"https://"):t})(),supabaseAnon:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U".trim()||""},$t=()=>{const t=re.supabaseUrl&&re.supabaseUrl.length>0,r=re.supabaseAnon&&re.supabaseAnon.length>0,s=t&&(re.supabaseUrl.includes("supabase.co")||re.supabaseUrl.includes("supabase.in"));return t&&r&&s};function Lt(){try{const t=new URL(re.supabaseUrl).hostname.split(".")[0],r=window.location.hostname.toLowerCase();let s="default";if(r.includes("localhost")||r.includes("127.0.0.1"))s="dev";else if(r.includes("webcontainer")||r.includes("stackblitz"))s="preview";else{const n=r.split(".");n.length>2,s=n[0]}const a=s.replace(/[^a-z0-9-]/gi,"").toLowerCase();return`sb-${t}-${a}-auth-token`}catch(t){return console.warn("Failed to generate auth storage key:",t),"sb-auth-token-fallback"}}const qt=()=>{if(!re.supabaseUrl||!re.supabaseAnon)throw console.error("Missing environment variables. Please check your .env file."),console.error("Required: VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY"),new Error("Supabase configuration missing");const t=re.supabaseUrl,r=re.supabaseAnon,s=Lt();try{return Et(t,r,{auth:{storage:window.localStorage,storageKey:s,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"fastlift-pwa@9.77"}}})}catch(a){throw console.error("SUPABASE","Failed to create client",{error:a}),a}},W=qt();$t();const Gt=Object.freeze(Object.defineProperty({__proto__:null,supabase:W},Symbol.toStringTag,{value:"Module"}));function st(){const t=window.innerWidth,r=window.innerHeight,s=window.devicePixelRatio||1,a=t<768,n=t>=768&&t<1024,i=t>=1024,o=window.matchMedia("(hover: hover) and (pointer: fine)").matches,l="ontouchstart"in window||navigator.maxTouchPoints>0,c=navigator.deviceMemory||4,x=navigator.hardwareConcurrency||4,g=navigator.connection;let m="medium";if(g){const b=g.effectiveType;b==="slow-2g"||b==="2g"?m="slow":b==="3g"?m="medium":(b==="4g"||b==="5g")&&(m="fast")}let u="balanced";return a?u="high-performance":i&&c>=8&&x>=8?u="quality":u="balanced",{isMobile:a,isTablet:n,isDesktop:i,supportsHover:o,supportsTouch:l,screenWidth:t,screenHeight:r,devicePixelRatio:s,memoryGB:c,cores:x,connectionSpeed:m,recommendedMode:u}}function Ot(){const[t,r]=j.useState(()=>st());return j.useEffect(()=>{const s=()=>{r(st())};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]),t}const bt=j.createContext({mode:"balanced",recommendedMode:null,isPerformanceMode:!1,isLoading:!0,setMode:async()=>{},togglePerformanceMode:async()=>{}}),q=()=>j.useContext(bt),Es=({children:t})=>{const{mode:r,recommendedMode:s,isPerformanceMode:a,isLoading:n,setMode:i,loadMode:o}=wt(),{profile:l}=ve(),c=Ot();j.useEffect(()=>{o(l?.id,c.recommendedMode)},[l?.id,c.recommendedMode,o]);const x=async u=>{await i(u,l?.id)},m={mode:r,recommendedMode:s,isPerformanceMode:a,isLoading:n,setMode:x,togglePerformanceMode:async()=>{await x(a?"balanced":"high-performance")}};return e.jsx(bt.Provider,{value:m,children:t})};let be=null;function Ut(){return be||(be=new(window.AudioContext||window.webkitAudioContext)),be.state==="suspended"&&be.resume().catch(t=>{console.error("AUDIO_FEEDBACK_ERROR","Failed to resume AudioContext",{error:t instanceof Error?t.message:"Unknown error",contextState:be?.state,timestamp:new Date().toISOString()})}),be}function Ht(){return be?.state==="running"}function Vt(t,r,s){const a=t.createOscillator(),n=t.createGain();a.frequency.setValueAtTime(r.frequency,s),a.type=r.waveform;let i=null;r.filter&&(i=t.createBiquadFilter(),i.type=r.filter.type,i.frequency.setValueAtTime(r.filter.frequency,s),r.filter.Q!==void 0&&i.Q.setValueAtTime(r.filter.Q,s)),i?(a.connect(i),i.connect(n)):a.connect(n);const{attack:o,decay:l,sustain:c,release:x}=r.adsr,g=r.gain,m=g*c,u=s+o,b=u+l,v=b+x,F=o+l+x;return n.gain.setValueAtTime(0,s),n.gain.linearRampToValueAtTime(g,u),c>0?n.gain.exponentialRampToValueAtTime(Math.max(.001,m),b):n.gain.exponentialRampToValueAtTime(.001,b),n.gain.exponentialRampToValueAtTime(.001,v),{oscillator:a,gainNode:n,duration:F}}function Ie(t,r="click",s){try{const a=Ut();if(!Ht())return;const n=a.currentTime,i=a.createGain();i.connect(a.destination);const o=(t.masterGain||1)*.1;i.gain.setValueAtTime(o,n);const l=[];let c=0;t.layers.forEach(g=>{const m=Vt(a,g,n);l.push(m),m.gainNode.connect(i),c=Math.max(c,m.duration)}),l.forEach(({oscillator:g})=>{g.start(n)});const x=n+c;l.forEach(({oscillator:g})=>{g.stop(x)}),N.trace("TWINFORGE_AUDIO: Layered sound played",{layersCount:t.layers.length,totalDuration:(c*1e3).toFixed(1)+"ms",masterGain:o.toFixed(3),soundType:r,soundId:s})}catch(a){N.error("AUDIO_FEEDBACK_ERROR: Layered audio playback failed",{error:a instanceof Error?a.message:"Unknown error",layersCount:t.layers.length,soundType:r,audioContextSupported:!!(window.AudioContext||window.webkitAudioContext)})}}const $={frequency:290,waveform:"square",adsr:{attack:.003,decay:.085,sustain:0,release:.02},gain:.85,filter:{type:"lowpass",frequency:1600,Q:1.2}},le={frequency:102,waveform:"sine",adsr:{attack:.008,decay:.055,sustain:0,release:.012},gain:.6,filter:{type:"highpass",frequency:60,Q:1}},se={frequency:1500,waveform:"triangle",adsr:{attack:.01,decay:.15,sustain:0,release:.03},gain:.4,filter:{type:"lowpass",frequency:6e3,Q:1}},we={frequency:440,waveform:"sawtooth",adsr:{attack:.015,decay:.18,sustain:.1,release:.25},gain:.25,filter:{type:"bandpass",frequency:800,Q:3.5}},De={frequency:1800,waveform:"sawtooth",adsr:{attack:.002,decay:.05,sustain:0,release:.01},gain:.15,filter:{type:"highpass",frequency:1200,Q:1}},he={enabled:!0,volume:1,reducedMotion:!1};function Wt(){return{...he}}function at(t){Object.assign(he,t)}function Me(){return he.enabled}function ze(t){if(!he.enabled)return t;const r={...t,masterGain:(t.masterGain||1)*he.volume};return he.reducedMotion&&r.layers&&(r.layers=r.layers.map(s=>({...s,adsr:s.adsr?{...s.adsr,attack:Math.max(s.adsr.attack,.01),release:Math.max(s.adsr.release,.01)}:s.adsr}))),r}function T(t,r=2){if(he.reducedMotion)return t;const s=(Math.random()-.5)*2*(r/100);return t*(1+s)}function Fs(t){Ie(t)}const nt=new Map,Yt=50;function $e(t,r){const s=r||t,a=Date.now(),n=nt.get(s);return n&&a-n<Yt?!1:(nt.set(s,a),!0)}function Ne(t,r="click",s){if(!Me()||!$e(r,s))return;const a=ze(t);Ie(a,r,s)}function Jt(){const t={layers:[{...$,frequency:T($.frequency),gain:$.gain*.7},{...le,frequency:T(le.frequency),gain:le.gain*.3}],masterGain:1};Ne(t,"click")}function Qt(){const t={layers:[{...$,frequency:T($.frequency),gain:$.gain*.7},{...le,frequency:T(le.frequency),gain:le.gain*.3}],masterGain:1};Ne(t,"click")}function Kt(){Ne({layers:[{frequency:800,waveform:"triangle",adsr:{attack:.005,decay:.02,sustain:0,release:.005},gain:.3,filter:{type:"lowpass",frequency:3e3,Q:.8}}],masterGain:.8},"click")}function Zt(){Ne({layers:[{frequency:520,waveform:"triangle",adsr:{attack:.01,decay:.05,sustain:0,release:.01},gain:.5,filter:{type:"lowpass",frequency:2500,Q:1.2}}],masterGain:1},"click")}function Xt(){Ne({layers:[{frequency:740,waveform:"triangle",adsr:{attack:.015,decay:.105,sustain:0,release:.015},gain:.5,filter:{type:"lowpass",frequency:4e3,Q:1}}],masterGain:1},"click")}function er(){Ne({layers:[{frequency:800,waveform:"sine",adsr:{attack:.01,decay:.07,sustain:0,release:.01},gain:.4,filter:{type:"lowpass",frequency:3500,Q:1}}],masterGain:1},"click")}function fe(t,r="success",s){if(!Me()||!$e(r,s))return;const a=ze(t);Ie(a,r,s)}function tr(){const t={layers:[{...$,frequency:T($.frequency),gain:$.gain*.6},{...se,frequency:T(se.frequency),gain:se.gain*.4}],masterGain:1.26};fe(t,"success")}function rr(){const t={layers:[{...$,frequency:T($.frequency),gain:$.gain*.6},{...se,frequency:T(se.frequency),gain:se.gain*.2}],masterGain:1.58};fe(t,"success")}function sr(){fe({layers:[{frequency:220,waveform:"sine",adsr:{attack:.005,decay:.08,sustain:0,release:.01},gain:.6}],masterGain:.79},"error"),setTimeout(()=>{fe({layers:[{frequency:180,waveform:"sine",adsr:{attack:.005,decay:.1,sustain:0,release:.01},gain:.6}],masterGain:.79},"error")},110)}function ar(){const t={layers:[{...$,frequency:T($.frequency),gain:$.gain*1,adsr:{attack:.005,decay:.11,sustain:0,release:.015}}],masterGain:2.51};fe(t,"success"),setTimeout(()=>{const r={layers:[{...se,frequency:1400,gain:se.gain*.8,adsr:{attack:.01,decay:.15,sustain:0,release:.03},filter:{type:"bandpass",frequency:1400,Q:1.5}}],masterGain:2.51};fe(r,"success")},120),setTimeout(()=>{fe({layers:[{frequency:600,waveform:"sine",adsr:{attack:.02,decay:.14,sustain:0,release:.02},gain:.35,filter:{type:"lowpass",frequency:800,Q:1.2}}],masterGain:2.51},"success")},220)}function Ee(t,r){if(!Me()||!$e("navigation",r))return;const s=ze(t);Ie(s,"navigation",r)}function nr(){const t={layers:[{...$,frequency:T(660),gain:$.gain*.5}],masterGain:1};Ee(t)}function ir(){const t={layers:[{...$,frequency:T(350),gain:$.gain*.4},{...le,frequency:T(le.frequency),gain:le.gain*.2}],masterGain:1};Ee(t)}function or(){Ee({layers:[{frequency:880,waveform:"sine",adsr:{attack:.006,decay:.026,sustain:0,release:.006},gain:.4}],masterGain:1})}function lr(){const t={layers:[{...$,frequency:T(400),gain:$.gain*.4},{...se,frequency:T(1200),gain:se.gain*.3}],masterGain:1};Ee(t)}function cr(){const t={layers:[{...$,frequency:T(350),gain:$.gain*.3}],masterGain:.9};Ee(t)}const dr={light:{pattern:10,description:"Light tap"},medium:{pattern:20,description:"Medium tap"},heavy:{pattern:30,description:"Heavy tap"},success:{pattern:[10,50,10],description:"Success double tap"},warning:{pattern:[20,100,20,100,20],description:"Warning triple tap"},error:{pattern:[30,50,30],description:"Error alert pattern"},selection:{pattern:5,description:"Selection tick"}};function xr(){return"vibrate"in navigator}function pr(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||!xr())return!1;try{const t=localStorage.getItem("haptics-enabled");return t===null||t==="true"}catch{return!0}}function ue(t="light"){if(pr())try{const r=dr[t];navigator.vibrate(r.pattern)||(N.debug("HAPTICS","Vibration pattern not supported, using fallback"),navigator.vibrate(10)),N.debug("HAPTICS","Triggered haptic feedback",{pattern:t,description:r.description})}catch(r){N.error("HAPTICS","Failed to trigger haptic feedback",r)}}const ae={tap:()=>ue("light"),press:()=>ue("medium"),impact:()=>ue("heavy"),success:()=>ue("success"),warning:()=>ue("warning"),error:()=>ue("error"),selection:()=>ue("selection")};function Oe(t,r=1){const s=[.025,.045,.07],a=[.15,.1,.06].map(i=>i*r),n=t.layers.flatMap(i=>[i,...s.map((o,l)=>({...i,gain:i.gain*a[l],adsr:{...i.adsr,attack:i.adsr.attack+o}}))]);return{...t,layers:n,masterGain:t.masterGain*.9}}let it=0;function mr(){const t=Date.now(),r=t-it;return it=t,r<200?.5:r<500?.7:r<1e3?1:1.3}function xe(t,r="click",s){if(!Me()||!$e(r,s))return;const a=ze(t);Ie(a,r,s)}function Ts(){const t={layers:[{frequency:T(280),waveform:"triangle",adsr:{attack:.01,decay:.15,sustain:.3,release:.25},gain:.35},{frequency:T(440),waveform:"sine",adsr:{attack:.02,decay:.2,sustain:.25,release:.3},gain:.25},{frequency:T(660),waveform:"sine",adsr:{attack:.03,decay:.25,sustain:.2,release:.35},gain:.15}],masterGain:1.2};xe(t,"navigation","forge-strike"),ae.press()}function Ps(t){const r=Ue(t),s={layers:[{frequency:T(r),waveform:"triangle",adsr:{attack:.008,decay:.12,sustain:.25,release:.18},gain:.28},{frequency:T(r*1.5),waveform:"sine",adsr:{attack:.01,decay:.15,sustain:.2,release:.22},gain:.18}],masterGain:1};xe(s,"click",`tile-${t}`),ae.tap()}function Rs(t){const r=Ue(t),s={layers:[{frequency:T(r*1.2),waveform:"sine",adsr:{attack:.005,decay:.08,sustain:.15,release:.12},gain:.22},{frequency:T(r*2),waveform:"sine",adsr:{attack:.008,decay:.1,sustain:.12,release:.15},gain:.12}],masterGain:1};xe(s,"click",`pill-${t}`),ae.selection()}function Ds(){const t={layers:[{frequency:T(440),waveform:"sine",adsr:{attack:.01,decay:.12,sustain:.15,release:.2},gain:.18},{frequency:T(330),waveform:"sine",adsr:{attack:.02,decay:.15,sustain:.12,release:.25},gain:.15}],masterGain:.9};xe(t,"navigation","panel-close"),ae.tap()}function As(){const t={layers:[{frequency:T(261.63),waveform:"sine",adsr:{attack:.008,decay:.15,sustain:.32,release:.28},gain:.35},{frequency:T(329.63),waveform:"sine",adsr:{attack:.012,decay:.18,sustain:.28,release:.32},gain:.28},{frequency:T(523.25),waveform:"sine",adsr:{attack:.015,decay:.2,sustain:.25,release:.35},gain:.22}],masterGain:1.15};xe(t,"navigation","home-click"),ae.press()}function Bs(t,r){const s=Ue(t),a=r?1.2:1,n={layers:[{frequency:T(s),waveform:"sine",adsr:{attack:.008,decay:.12,sustain:.2,release:.18},gain:.25*a},{frequency:T(s*1.5),waveform:"sine",adsr:{attack:.012,decay:.15,sustain:.18,release:.22},gain:.15*a}],masterGain:1};xe(n,"navigation",`bottom-bar-${t}`),r?ae.press():ae.tap()}function Ue(t){return{"#10B981":349.23,"#3B82F6":392,"#F59E0B":440,"#A855F7":493.88,"#18E3FF":523.25,"#3D13B3":329.63,"#EC4899":466.16,"#8B5CF6":493.88,"#F7931E":329.63,"#EF4444":261.63}[t]||440}function gr(t=1){const r=mr(),s={layers:[{frequency:T(180),waveform:"square",adsr:{attack:.001,decay:.04,sustain:0,release:.015},gain:.9*t},{...we,frequency:T(we.frequency),gain:we.gain*t},{...De,frequency:T(2400),gain:De.gain*t*1.3}],masterGain:1.1},a=Oe(s,r);xe(a,"click","hammer-strike"),ae.press()}function ur(){const t={layers:[{frequency:T(340),waveform:"triangle",adsr:{attack:.01,decay:.12,sustain:.15,release:.18},gain:.45},{frequency:T(680),waveform:"sawtooth",adsr:{attack:.02,decay:.1,sustain:.08,release:.15},gain:.25,filter:{type:"bandpass",frequency:650,Q:4}},{...De,frequency:T(1600),gain:De.gain*.6}],masterGain:.9},r=Oe(t,.8);xe(r,"click","hot-metal"),ae.selection()}function br(){const t={layers:[{frequency:T(220),waveform:"triangle",adsr:{attack:.005,decay:.2,sustain:.15,release:.35},gain:.5},{...we,frequency:T(440),adsr:{...we.adsr,decay:.3,release:.4},gain:we.gain*1.2},{frequency:T(880),waveform:"sine",adsr:{attack:.015,decay:.25,sustain:.1,release:.3},gain:.18}],masterGain:1},r=Oe(t,1.2);xe(r,"click","anvil-ring"),ae.impact()}function K(){return j.useMemo(()=>({click:Jt,glassClick:Qt,formInput:Kt,toggle:Zt,notif:Xt,timer:er,formSubmit:tr,success:rr,error:sr,successMajor:ar,tabClick:nr,sidebarClick:ir,headerClick:or,navOpen:lr,navClose:cr,hammerStrike:gr,hotMetalHiss:ur,anvilRing:br,setAudioEnabled:t=>{at({enabled:t})},setDiscreteMode:t=>{at({discreteMode:t})},getAudioPreferences:Wt}),[])}const je=[{key:"sex",label:"Genre",description:"Nécessaire pour calculer les besoins nutritionnels",profileTab:"identity",priority:"high"},{key:"weight_kg",label:"Poids",description:"Essentiel pour les portions et calories",profileTab:"identity",priority:"high"},{key:"height_cm",label:"Taille",description:"Nécessaire pour les calculs métaboliques",profileTab:"identity",priority:"high"},{key:"nutrition.allergies",label:"Allergies",description:"Important pour la sécurité alimentaire",profileTab:"nutrition",sectionHash:"restrictions-section",priority:"medium"},{key:"householdDetails.adults",label:"Nombre d'adultes",description:"Pour adapter les portions des recettes",profileTab:"nutrition",sectionHash:"essentials-section",priority:"high"},{key:"nutrition.diet",label:"Régime alimentaire",description:"Pour des recettes adaptées à votre style",profileTab:"nutrition",sectionHash:"diet-section",priority:"medium"},{key:"mealPrepPreferences.cookingSkill",label:"Niveau de cuisine",description:"Pour adapter la complexité des recettes",profileTab:"nutrition",sectionHash:"essentials-section",priority:"medium"},{key:"kitchenEquipment",label:"Équipement de cuisine",description:"Pour des recettes réalisables chez vous",profileTab:"nutrition",sectionHash:"essentials-section",priority:"medium"},{key:"objective",label:"Objectif fitness",description:"Pour des recettes alignées sur vos objectifs",profileTab:"identity",priority:"medium"},{key:"nutrition.intolerances",label:"Intolérances",description:"Pour éviter les inconforts digestifs",profileTab:"nutrition",sectionHash:"restrictions-section",priority:"low"},{key:"foodPreferences.cuisines",label:"Cuisines préférées",description:"Pour des recettes qui vous plaisent",profileTab:"nutrition",sectionHash:"preferences-section",priority:"low"},{key:"macroTargets.kcal",label:"Objectif calories",description:"Pour des recettes équilibrées",profileTab:"nutrition",sectionHash:"macros-section",priority:"low"}];function ht(t,r){if(r==="nutrition.allergies"){const n=t?.nutrition?.allergies&&Array.isArray(t.nutrition.allergies)&&t.nutrition.allergies.length>0,i=t?.nutrition?.noKnownAllergies===!0;return n||i}const s=r.split(".");let a=t;for(const n of s){if(!a||a[n]===void 0||a[n]===null)return!1;a=a[n]}return typeof a=="string"&&a.trim()===""||Array.isArray(a)&&a.length===0||typeof a=="object"&&Object.keys(a).length===0?!1:r==="householdDetails.adults"?typeof a=="number"&&a>=1:!(typeof a=="number"&&a<=0)}function Fe(t){if(!t)return{isSufficient:!1,completionPercentage:0,missingCriticalFields:je,missingHighPriorityFields:je.filter(b=>b.priority==="high"),suggestedMessage:"Créez votre profil pour des recettes personnalisées",nextAction:{label:"Créer mon profil",route:"/profile#identity"}};N.debug("PROFILE_COMPLETION_SERVICE","Calculating Recipe Workshop completion",{userId:t.userId,hasBasicInfo:!!(t.sex&&t.weight_kg&&t.height_cm),hasNutritionInfo:!!t.nutrition,hasHouseholdInfo:!!t.householdDetails,timestamp:new Date().toISOString()});const r=[],s=[];je.forEach(b=>{ht(t,b.key)||(r.push(b),b.priority==="high"&&s.push(b))});const a=je.length,n=a-r.length,i=Math.round(n/a*100);je.filter(b=>b.priority==="high");const o=je.filter(b=>b.priority==="medium"),l=r.filter(b=>b.priority==="medium"),c=s.length===0,x=l.length<=Math.floor(o.length*.5),g=c&&x;let m,u=null;if(s.length>0){const b=s[0];m=`Complétez votre ${b.label.toLowerCase()} pour des recettes personnalisées`;const w=b.sectionHash?`#${b.sectionHash}`:"";u={label:`Ajouter ${b.label}`,route:`/profile?tab=${b.profileTab}${w}`}}else if(r.length>0){const b=r[0];m=`Ajoutez votre ${b.label.toLowerCase()} pour une meilleure personnalisation`;const w=b.sectionHash?`#${b.sectionHash}`:"";u={label:`Compléter ${b.label}`,route:`/profile?tab=${b.profileTab}${w}`}}else m="Profil complet ! Recettes ultra-personnalisées disponibles",u=null;return N.debug("PROFILE_COMPLETION_SERVICE","Recipe Workshop completion calculated",{userId:t.userId,isSufficient:g,completionPercentage:i,missingHighPriorityCount:s.length,missingTotalCount:r.length,hasAllHighPriority:c,hasEnoughMediumPriority:x,timestamp:new Date().toISOString()}),{isSufficient:g,completionPercentage:i,missingCriticalFields:r,missingHighPriorityFields:s,suggestedMessage:m,nextAction:u}}function ft(t,r){const s=Fe(t),n={recipes:["sex","weight_kg","nutrition.allergies","householdDetails.adults"],shopping:["householdDetails.adults","nutrition.allergies","shoppingPreferences.frequencyPerWeek"],planning:["householdDetails.adults","mealPrepPreferences.cookingSkill","macroTargets.kcal"]}[r]||[],i=s.missingCriticalFields.filter(c=>n.includes(c.key)),o=i.length===0||s.isSufficient;let l="";return!o&&i.length>0&&(l=`Ajoutez votre ${i.slice(0,2).map(x=>x.label.toLowerCase()).join(" et ")} pour une ${r==="recipes"?"génération":r==="shopping"?"liste":"planification"} optimale`),{canProceed:o,warningMessage:l,missingForFeature:i}}function hr(t){return t?!!(t.sex&&t.weight_kg&&t.height_cm):!1}function fr(t){return Te(t,[{key:"sex",label:"Genre",description:"Pour calculer vos besoins caloriques",profileTab:"identity",priority:"high"},{key:"weight_kg",label:"Poids",description:"Essentiel pour le suivi nutritionnel",profileTab:"identity",priority:"high"},{key:"height_cm",label:"Taille",description:"Pour calculer votre métabolisme de base",profileTab:"identity",priority:"high"},{key:"nutrition.allergies",label:"Allergies",description:"Important pour la sécurité alimentaire",profileTab:"nutrition",sectionHash:"restrictions-section",priority:"medium"},{key:"macroTargets.kcal",label:"Objectif calories",description:"Pour suivre vos apports quotidiens",profileTab:"nutrition",sectionHash:"macros-section",priority:"medium"}],"Scannez votre premier repas")}function vr(t){return Te(t,[{key:"sex",label:"Genre",description:"Pour calculer vos dépenses caloriques",profileTab:"identity",priority:"high"},{key:"weight_kg",label:"Poids",description:"Essentiel pour le calcul des calories brûlées",profileTab:"identity",priority:"high"},{key:"height_cm",label:"Taille",description:"Pour les calculs métaboliques",profileTab:"identity",priority:"high"},{key:"objective",label:"Objectif fitness",description:"Pour des recommandations adaptées",profileTab:"identity",priority:"medium"}],"Enregistrez votre première activité")}function yr(t){return Te(t,[{key:"sex",label:"Genre",description:"Pour des recommandations de jeûne adaptées",profileTab:"identity",priority:"high"},{key:"weight_kg",label:"Poids",description:"Pour suivre l'impact du jeûne",profileTab:"identity",priority:"high"},{key:"fastingPreferences.experience",label:"Expérience jeûne",description:"Pour des protocoles adaptés à votre niveau",profileTab:"fasting",priority:"medium"},{key:"objective",label:"Objectif",description:"Pour optimiser votre stratégie de jeûne",profileTab:"identity",priority:"medium"}],"Commencez votre premier jeûne")}function jr(t){return Te(t,[{key:"sex",label:"Genre",description:"Essentiel pour la génération de l'avatar",profileTab:"identity",priority:"high"},{key:"weight_kg",label:"Poids",description:"Pour calibrer les proportions",profileTab:"identity",priority:"high"},{key:"height_cm",label:"Taille",description:"Base pour les dimensions corporelles",profileTab:"identity",priority:"high"}],"Scannez votre corps en 3D")}function Te(t,r,s){if(!t)return{isSufficient:!1,completionPercentage:0,missingCriticalFields:r,missingHighPriorityFields:r.filter(v=>v.priority==="high"),suggestedMessage:"Complétez votre profil pour commencer",nextAction:{label:"Compléter mon profil",route:"/profile#identity"}};const a=[],n=[];r.forEach(v=>{ht(t,v.key)||(a.push(v),v.priority==="high"&&n.push(v))});const i=r.length,o=i-a.length,l=Math.round(o/i*100);r.filter(v=>v.priority==="high");const c=r.filter(v=>v.priority==="medium"),x=a.filter(v=>v.priority==="medium"),g=n.length===0,m=x.length<=Math.floor(c.length*.5),u=g&&m;let b,w=null;if(n.length>0){const v=n[0];b=`Ajoutez votre ${v.label.toLowerCase()} pour ${s.toLowerCase()}`;const F=v.sectionHash?`#${v.sectionHash}`:"";w={label:`Ajouter ${v.label}`,route:`/profile?tab=${v.profileTab}${F}`}}else if(a.length>0){const v=a[0];b=`Complétez votre ${v.label.toLowerCase()} pour une meilleure expérience`;const F=v.sectionHash?`#${v.sectionHash}`:"";w={label:`Compléter ${v.label}`,route:`/profile?tab=${v.profileTab}${F}`}}else b="Profil complet ! Toutes les fonctionnalités sont disponibles",w=null;return{isSufficient:u,completionPercentage:l,missingCriticalFields:a,missingHighPriorityFields:n,suggestedMessage:b,nextAction:w}}function wr(t){return Te(t,[{key:"sex",label:"Genre",description:"Pour des programmes d'entraînement adaptés",profileTab:"identity",priority:"high"},{key:"weight_kg",label:"Poids",description:"Essentiel pour calibrer les charges",profileTab:"identity",priority:"high"},{key:"height_cm",label:"Taille",description:"Pour adapter les mouvements",profileTab:"identity",priority:"high"},{key:"objective",label:"Objectif fitness",description:"Pour construire le programme optimal",profileTab:"identity",priority:"high"},{key:"trainingPreferences.experienceLevel",label:"Niveau d'expérience",description:"Pour adapter la complexité des exercices",profileTab:"identity",priority:"high"},{key:"trainingPreferences.availableEquipment",label:"Équipement disponible",description:"Pour générer des séances réalisables",profileTab:"identity",priority:"high"}],"Démarrez votre coaching")}const _s={checkCompleteness:Fe,getFeatureGuidance:ft,hasMinimumData:hr,checkMealTracking:fr,checkActivityTracking:vr,checkFastingTracking:yr,checkAvatarScan:jr,checkTraining:wr},Nr=()=>{const t=ne(),{click:r}=K(),{isPerformanceMode:s}=q(),[a,n]=j.useState({scans:0,items:0,recipes:0}),i=s?"div":k.div;j.useEffect(()=>{(async()=>{try{const{data:{user:c}}=await W.auth.getUser();if(!c)return;const{data:x}=await W.from("recipe_sessions").select("inventory_final, selected_recipe_ids").eq("user_id",c.id).not("inventory_final","is",null);if(x&&x.length>0){const g=x.length,m=x.reduce((b,w)=>b+(Array.isArray(w.inventory_final)?w.inventory_final.length:0),0),u=x.reduce((b,w)=>b+(Array.isArray(w.selected_recipe_ids)?w.selected_recipe_ids.length:0),0);n({scans:g,items:m,recipes:u})}}catch(c){N.warn("FRIDGE_SCAN_MAIN_CTA","Failed to load stats",{error:c instanceof Error?c.message:"Unknown error"})}})()},[]);const o=()=>{r(),t("/fridge/scan")};return e.jsxs(E,{className:"relative overflow-hidden p-10 text-center",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EC4899 20%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F472B6 18%, transparent) 0%, transparent 50%),
          radial-gradient(circle at 50% 50%, color-mix(in srgb, #DB2777 15%, transparent) 0%, transparent 70%),
          linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.10)),
          rgba(11, 14, 23, 0.85)
        `,borderColor:"color-mix(in srgb, #EC4899 45%, transparent)",boxShadow:`
          0 20px 60px rgba(0, 0, 0, 0.35),
          0 0 40px color-mix(in srgb, #EC4899 30%, transparent),
          0 0 80px color-mix(in srgb, #F472B6 25%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.2)
        `,backdropFilter:"blur(32px) saturate(170%)",WebkitBackdropFilter:"blur(32px) saturate(170%)"},children:[e.jsx("div",{className:"training-hero-corners","aria-hidden":"true",children:[0,1,2,3].map(l=>e.jsx(i,{className:"corner-particle",style:{position:"absolute",width:"12px",height:"12px",borderRadius:"2px",background:"linear-gradient(135deg, #EC4899, rgba(244, 114, 182, 0.8))",boxShadow:"0 0 20px #EC4899",top:l<2?"12px":"auto",bottom:l>=2?"12px":"auto",left:l%2===0?"12px":"auto",right:l%2===1?"12px":"auto",willChange:s?"auto":"transform, opacity"},...!s&&{initial:{rotate:l%2===0?45:-45},animate:{scale:[1,1.2,1],opacity:[.6,.9,.6],rotate:l%2===0?[45,55,45]:[-45,-55,-45]},transition:{duration:3.5,repeat:1/0,delay:l*.25,ease:[.45,.05,.55,.95]}}},l))}),e.jsxs("div",{className:"relative z-10 space-y-8",children:[e.jsx("div",{className:"relative inline-block",children:e.jsx(i,{className:"w-28 h-28 mx-auto rounded-full flex items-center justify-center relative",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                radial-gradient(circle at 70% 70%, color-mix(in srgb, #EC4899 20%, transparent) 0%, transparent 50%),
                linear-gradient(135deg, color-mix(in srgb, #EC4899 40%, transparent), color-mix(in srgb, #F472B6 35%, transparent))
              `,border:"3px solid color-mix(in srgb, #EC4899 50%, transparent)",boxShadow:`
                0 0 30px color-mix(in srgb, #EC4899 40%, transparent),
                inset 0 2px 0 rgba(255,255,255,0.3)
              `,willChange:s?"auto":"transform"},...!s&&{animate:{scale:[1,1.04,1]},transition:{duration:3,repeat:1/0,ease:[.45,.05,.55,.95]}},children:e.jsx(p,{Icon:d.Refrigerator,size:56,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})})}),e.jsxs(i,{...!s&&{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2}},children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-4",style:{textShadow:"0 0 25px color-mix(in srgb, #EC4899 50%, transparent)"},children:"Scanner Votre Frigo"}),e.jsx("p",{className:"text-white/85 text-lg leading-relaxed max-w-2xl mx-auto",children:"Capturez l'intérieur de votre réfrigérateur pour une analyse instantanée. Générez des recettes personnalisées et des plans repas adaptés à vos ingrédients."})]}),e.jsx(i,{...!s&&{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3}},children:e.jsxs("button",{onClick:o,className:"relative overflow-hidden px-12 py-5 text-xl font-bold rounded-2xl transition-all duration-300 group",style:{background:`
                linear-gradient(135deg,
                  color-mix(in srgb, #EC4899 85%, transparent),
                  color-mix(in srgb, #F472B6 70%, transparent),
                  color-mix(in srgb, #DB2777 60%, transparent)
                )
              `,border:"2px solid color-mix(in srgb, #EC4899 60%, transparent)",boxShadow:`
                0 20px 50px color-mix(in srgb, #EC4899 45%, transparent),
                inset 0 3px 0 rgba(255,255,255,0.5)
              `,color:"white"},onMouseEnter:l=>{!s&&window.matchMedia("(hover: hover)").matches&&(l.currentTarget.style.transform="translateY(-3px) scale(1.03)",l.currentTarget.style.boxShadow=`
                  0 24px 60px color-mix(in srgb, #EC4899 55%, transparent),
                  inset 0 3px 0 rgba(255,255,255,0.6)
                `)},onMouseLeave:l=>{!s&&window.matchMedia("(hover: hover)").matches&&(l.currentTarget.style.transform="translateY(0) scale(1)",l.currentTarget.style.boxShadow=`
                  0 20px 50px color-mix(in srgb, #EC4899 45%, transparent),
                  inset 0 3px 0 rgba(255,255,255,0.5)
                `)},children:[!s&&e.jsx(k.div,{className:"absolute inset-0 rounded-2xl pointer-events-none",style:{background:"linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.5) 50%, transparent 100%)"},animate:{x:["-200%","200%"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"}}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[e.jsx(p,{Icon:d.ScanLine,size:24,color:"white",variant:"pure"}),e.jsx("span",{children:"Lancer le Scan"})]})]})}),e.jsx(i,{...!s&&{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5}},className:"flex flex-wrap items-center justify-center gap-6 pt-4",children:[{icon:d.ScanLine,label:`${a.scans} Scan${a.scans>1?"s":""}`,color:"#EC4899"},{icon:d.Package,label:`${a.items} Item${a.items>1?"s":""}`,color:"#F472B6"},{icon:d.ChefHat,label:`${a.recipes} Recette${a.recipes>1?"s":""}`,color:"#DB2777"}].map((l,c)=>e.jsxs(i,{className:"flex items-center gap-2.5 px-5 py-2.5 rounded-full",style:{background:`color-mix(in srgb, ${l.color} 18%, transparent)`,border:`2px solid color-mix(in srgb, ${l.color} 35%, transparent)`,backdropFilter:"blur(18px) saturate(150%)"},...!s&&{whileHover:{scale:1.05},transition:{duration:.2}},children:[e.jsx(p,{Icon:l.icon,size:18,style:{color:l.color}}),e.jsx("span",{className:"text-white/90 text-sm font-semibold",children:l.label})]},c))})]})]})},kr=()=>{const t=ne(),{click:r}=K(),[s,a]=j.useState([]);j.useEffect(()=>{(async()=>{try{const{data:{user:l}}=await W.auth.getUser();if(!l)return;const{data:c}=await W.from("recipe_sessions").select("id, created_at, inventory_final, status").eq("user_id",l.id).not("inventory_final","is",null).order("created_at",{ascending:!1}).limit(3);c&&a(c)}catch(l){N.warn("RECENT_SCANS_CARD","Failed to load recent sessions",{error:l instanceof Error?l.message:"Unknown error"})}})()},[]);const n=o=>{r(),t("/fridge#inventaire")},i=()=>{r(),t("/fridge#inventaire")};return e.jsxs(E,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EC4899 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F472B6 10%, transparent) 0%, transparent 50%),
          linear-gradient(145deg, rgba(255,255,255,0.12), rgba(255,255,255,0.08)),
          rgba(11, 14, 23, 0.80)
        `,borderColor:"color-mix(in srgb, #EC4899 35%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #EC4899 20%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `,backdropFilter:"blur(24px) saturate(150%)",WebkitBackdropFilter:"blur(24px) saturate(150%)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k.div,{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #EC4899 45%, transparent), color-mix(in srgb, #F472B6 35%, transparent))
              `,border:"2px solid color-mix(in srgb, #EC4899 60%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EC4899 40%, transparent)"},animate:{scale:[1,1.05,1],boxShadow:["0 0 20px rgba(236, 72, 153, 0.4)","0 0 30px rgba(236, 72, 153, 0.55)","0 0 20px rgba(236, 72, 153, 0.4)"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},children:e.jsx(p,{Icon:d.History,size:20,className:"text-pink-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Scans Récents"}),e.jsx("p",{className:"text-sm text-white/70",children:"Vos derniers inventaires"})]})]}),e.jsx("button",{onClick:i,className:"px-4 py-2 rounded-xl text-sm font-semibold transition-all duration-300",style:{background:"color-mix(in srgb, #EC4899 15%, transparent)",border:"2px solid color-mix(in srgb, #EC4899 30%, transparent)",color:"#F472B6"},onMouseEnter:o=>{window.matchMedia("(hover: hover)").matches&&(o.currentTarget.style.background="color-mix(in srgb, #EC4899 25%, transparent)",o.currentTarget.style.borderColor="color-mix(in srgb, #EC4899 45%, transparent)")},onMouseLeave:o=>{window.matchMedia("(hover: hover)").matches&&(o.currentTarget.style.background="color-mix(in srgb, #EC4899 15%, transparent)",o.currentTarget.style.borderColor="color-mix(in srgb, #EC4899 30%, transparent)")},children:"Voir tout"})]}),e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #EC4899 15%, transparent)",border:"2px solid color-mix(in srgb, #EC4899 25%, transparent)"},children:e.jsx(p,{Icon:d.Package,size:32,className:"text-pink-300 opacity-50"})}),e.jsx("p",{className:"text-white/60 text-sm",children:"Aucun scan effectué pour le moment"}),e.jsx("p",{className:"text-white/50 text-xs mt-2",children:"Lancez votre premier scan pour commencer"})]}):s.map((o,l)=>e.jsx(k.button,{onClick:()=>n(o.id),className:"w-full text-left rounded-xl p-4 transition-all duration-300",style:{background:"rgba(255, 255, 255, 0.03)",border:"2px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(12px)"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:l*.1},whileHover:{scale:1.02,background:"rgba(236, 72, 153, 0.08)",borderColor:"rgba(236, 72, 153, 0.3)",boxShadow:"0 0 20px rgba(236, 72, 153, 0.2)"},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                      linear-gradient(135deg, color-mix(in srgb, #EC4899 35%, transparent), color-mix(in srgb, #F472B6 25%, transparent))
                    `,border:"2px solid color-mix(in srgb, #EC4899 40%, transparent)",boxShadow:"0 4px 12px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.2)"},children:e.jsx(p,{Icon:d.Refrigerator,size:32,className:"text-pink-300"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-white font-semibold text-base truncate",children:["Scan du ",Ge(new Date(o.created_at),"d MMM yyyy",{locale:Xe})]}),o.status==="completed"&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-medium",style:{background:"color-mix(in srgb, #10B981 20%, transparent)",color:"#10B981",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:"Terminé"})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-white/70",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(p,{Icon:d.Package,size:14}),e.jsxs("span",{children:[Array.isArray(o.inventory_final)?o.inventory_final.length:0," items"]})]})}),e.jsx("p",{className:"text-xs text-white/50 mt-1",children:Ge(new Date(o.created_at),"HH:mm",{locale:Xe})})]}),e.jsx(p,{Icon:d.ChevronRight,size:20,className:"text-white/40 flex-shrink-0"})]})},o.id))})]})},Sr=()=>{const[t,r]=j.useState({}),[s,a]=j.useState(0),[n,i]=j.useState(0),[o,l]=j.useState([]);j.useEffect(()=>{(async()=>{try{const{data:{user:m}}=await W.auth.getUser();if(!m)return;const{data:u}=await W.from("recipe_sessions").select("inventory_final").eq("user_id",m.id).not("inventory_final","is",null);if(u&&u.length>0){const b=u.length,w=u.reduce((I,P)=>I+(Array.isArray(P.inventory_final)?P.inventory_final.length:0),0),v={};u.forEach(I=>{Array.isArray(I.inventory_final)&&I.inventory_final.forEach(P=>{const D=P.category||"Autre";v[D]=(v[D]||0)+1})});const F=Object.entries(v).sort(([,I],[,P])=>P-I).slice(0,3).map(([I,P],D)=>({name:I,count:P,color:["#10B981","#F59E0B","#EC4899"][D]}));a(b),i(w),l(F)}}catch(m){N.warn("SCANNER_STATS_CARD","Failed to load stats",{error:m instanceof Error?m.message:"Unknown error"})}})()},[]);const c=n>0?85:0,x=[{label:"Scans Effectués",value:s,icon:"Scan",color:"#EC4899",unit:""},{label:"Items Détectés",value:n,icon:"Package",color:"#F472B6",unit:""},{label:"Taux de Fraîcheur",value:c,icon:"Sparkles",color:"#10B981",unit:"%"}];return j.useEffect(()=>{x.forEach(g=>{const m=g.label;let u=0;const b=g.value/30,w=setInterval(()=>{u+=b,u>=g.value&&(u=g.value,clearInterval(w)),r(v=>({...v,[m]:Math.floor(u)}))},30);return()=>clearInterval(w)})},[s,n]),e.jsxs(E,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EC4899 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F472B6 10%, transparent) 0%, transparent 50%),
          linear-gradient(145deg, rgba(255,255,255,0.12), rgba(255,255,255,0.08)),
          rgba(11, 14, 23, 0.80)
        `,borderColor:"color-mix(in srgb, #EC4899 35%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #EC4899 20%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `,backdropFilter:"blur(24px) saturate(150%)",WebkitBackdropFilter:"blur(24px) saturate(150%)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(k.div,{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #EC4899 45%, transparent), color-mix(in srgb, #F472B6 35%, transparent))
            `,border:"2px solid color-mix(in srgb, #EC4899 60%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EC4899 40%, transparent)"},animate:{scale:[1,1.05,1],boxShadow:["0 0 20px color-mix(in srgb, #EC4899 40%, transparent)","0 0 30px color-mix(in srgb, #EC4899 55%, transparent)","0 0 20px color-mix(in srgb, #EC4899 40%, transparent)"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},children:e.jsx(p,{Icon:d.BarChart3,size:20,className:"text-pink-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Statistiques"}),e.jsx("p",{className:"text-sm text-white/70",children:"Vue d'ensemble de vos scans"})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:x.map((g,m)=>{const u=t[g.label]||0,b=g.unit==="%"?u:u/(g.value||1)*100;return e.jsxs(k.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:m*.1},className:"text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-3",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:"8"}),e.jsx(k.circle,{cx:"48",cy:"48",r:"40",fill:"none",stroke:g.color,strokeWidth:"8",strokeLinecap:"round",strokeDasharray:`${2*Math.PI*40}`,initial:{strokeDashoffset:2*Math.PI*40},animate:{strokeDashoffset:2*Math.PI*40*(1-(g.unit==="%"?u/100:Math.min(b/100,1)))},transition:{duration:1,ease:"easeOut"},style:{filter:`drop-shadow(0 0 8px ${g.color}80)`}})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(p,{Icon:d[g.icon],size:20,style:{color:g.color}}),e.jsxs("span",{className:"text-xl font-bold text-white mt-1",children:[u,g.unit]})]})]}),e.jsx("p",{className:"text-xs text-white/70 font-medium",children:g.label})]},g.label)})}),e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"rounded-xl p-4 mb-4",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:"Tendance des Scans"}),e.jsx("span",{className:"text-xs text-white/60",children:"7 derniers jours"})]}),e.jsx("div",{className:"flex items-end justify-between h-16 gap-1",children:[3,5,4,7,6,8,9].map((g,m)=>e.jsx(k.div,{className:"flex-1 rounded-t-lg",style:{background:`linear-gradient(180deg, ${d?"#EC4899":"#F472B6"}, ${d?"#F472B6":"#DB2777"})`,boxShadow:"0 0 10px color-mix(in srgb, #EC4899 40%, transparent)"},initial:{height:0},animate:{height:`${g/10*100}%`},transition:{duration:.5,delay:m*.05}},m))})]}),e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Top Catégories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map((g,m)=>e.jsxs(k.div,{className:"px-4 py-2 rounded-full flex items-center gap-2",style:{background:`color-mix(in srgb, ${g.color} 15%, transparent)`,border:`2px solid color-mix(in srgb, ${g.color} 30%, transparent)`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.6+m*.1},whileHover:{scale:1.05},children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:g.color}}),e.jsx("span",{className:"text-sm font-medium text-white",children:g.name}),e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full",style:{background:`color-mix(in srgb, ${g.color} 25%, transparent)`,color:g.color},children:g.count})]},g.name))})]}),s>0&&e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},className:"mt-4 p-3 rounded-xl flex items-start gap-3",style:{background:"color-mix(in srgb, #10B981 10%, transparent)",border:"2px solid color-mix(in srgb, #10B981 25%, transparent)"},children:[e.jsx(p,{Icon:d.Lightbulb,size:18,className:"text-green-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-green-300 mb-1",children:"Excellent Progrès!"}),e.jsxs("p",{className:"text-xs text-white/70",children:["Vous avez scanné ",s," frigo",s>1?"s":""," et détecté ",n," ingrédients. Continuez pour débloquer plus de recettes personnalisées."]})]})]})]})},Cr=()=>{const t=ne(),{isPerformanceMode:r}=q(),{startScan:s}=ye(),a=r?"div":k.div,{profile:n}=ve(),i=Fe(n),o=()=>{s(),t("/fridge/scan")};return e.jsxs(a,{...!r&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"}},className:"text-center py-12 py-1",children:[!i.isSufficient&&e.jsx("div",{className:"mb-6",children:e.jsx(St,{completion:i,forgeName:"la forge culinaire",forgeColor:"#EC4899"})}),e.jsx(E,{className:"p-8",style:{background:`radial-gradient(ellipse at center,
            rgba(236, 72, 153, 0.15) 0%,
            rgba(244, 114, 182, 0.08) 50%,
            rgba(0, 0, 0, 0.4) 100%)`,borderColor:"rgba(236, 72, 153, 0.3)",boxShadow:`
            0 0 30px rgba(236, 72, 153, 0.2),
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1)
          `,backdropFilter:"blur(20px) saturate(1.2)"},children:e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                rgba(236, 72, 153, 0.3) 0%,
                rgba(244, 114, 182, 0.15) 70%,
                transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                0 0 25px rgba(236, 72, 153, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(p,{Icon:d.ChefHat,size:48,className:"text-pink-400",style:{filter:`drop-shadow(0 0 12px rgba(236, 72, 153, 0.8))
                         drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3))`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Scannez votre frigo pour des recettes sur mesure"}),e.jsx("p",{className:"text-white/70 text-lg",children:"Découvrez la magie de la forge culinaire intelligente"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(236, 72, 153, 0.3) 0%,
                    rgba(244, 114, 182, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                    0 0 20px rgba(236, 72, 153, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(p,{Icon:d.Camera,size:24,className:"text-pink-400",style:{filter:`drop-shadow(0 0 8px rgba(236, 72, 153, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Scanner intelligent"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Détection automatique de vos ingrédients disponibles"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(236, 72, 153, 0.3) 0%,
                    rgba(244, 114, 182, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                    0 0 20px rgba(236, 72, 153, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(p,{Icon:d.Sparkles,size:24,className:"text-pink-400",style:{filter:`drop-shadow(0 0 8px rgba(236, 72, 153, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Forge personnalisée"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Recettes adaptées à vos contraintes et préférences"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(236, 72, 153, 0.3) 0%,
                    rgba(244, 114, 182, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                    0 0 20px rgba(236, 72, 153, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(p,{Icon:d.ShoppingCart,size:24,className:"text-pink-400",style:{filter:`drop-shadow(0 0 8px rgba(236, 72, 153, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Zéro gaspillage"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Plans repas et listes de courses optimisés"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:o,className:"group relative px-8 py-4 text-white font-semibold rounded-2xl transform hover:scale-105 transition-all duration-300",style:{background:`linear-gradient(135deg,
                  rgba(236, 72, 153, 0.8) 0%,
                  rgba(244, 114, 182, 0.9) 100%)`,border:"2px solid rgba(236, 72, 153, 0.6)",boxShadow:`
                  0 0 30px rgba(236, 72, 153, 0.4),
                  0 8px 25px rgba(0, 0, 0, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(10px) saturate(1.2)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{Icon:d.Camera,size:24,className:"group-hover:rotate-12 transition-transform duration-300",style:{color:"white",filter:`drop-shadow(0 0 10px rgba(236, 72, 153, 0.8))
                             drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3))`}}),e.jsx("span",{className:"text-lg",children:"Scanner mon frigo"})]}),e.jsx("div",{className:"absolute inset-0 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300 -z-10",style:{background:`linear-gradient(135deg,
                    rgba(236, 72, 153, 0.6) 0%,
                    rgba(244, 114, 182, 0.6) 100%)`}})]})}),e.jsx("div",{className:"text-white/50 text-sm p-3 rounded-xl",style:{background:`radial-gradient(ellipse at center,
                rgba(236, 72, 153, 0.1) 0%,
                transparent 70%)`,border:"1px solid rgba(236, 72, 153, 0.2)",boxShadow:"0 0 15px rgba(236, 72, 153, 0.1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(p,{Icon:d.Lightbulb,size:16,className:"text-pink-400",style:{filter:"drop-shadow(0 0 6px rgba(236, 72, 153, 0.6))"}}),e.jsx("span",{children:"Astuce : Plus votre frigo est rempli, plus vous aurez de recettes créatives !"})]})})]})})]})},Ms=()=>{const{profile:t,session:r}=ve(),{loadRecentSessions:s}=ye();j.useEffect(()=>{s()},[s]);const{data:a=!1,isLoading:n}=jt({queryKey:["fridge-scan-sessions","has-history",r?.user?.id],queryFn:async()=>{if(!r?.user?.id)return!1;const{supabase:i}=await Pt(async()=>{const{supabase:c}=await Promise.resolve().then(()=>Gt);return{supabase:c}},void 0),{data:o,error:l}=await i.from("recipe_sessions").select("id").eq("user_id",r.user.id).not("inventory_final","is",null).limit(1);return l?!1:(o?.length||0)>0},enabled:!!r?.user?.id,staleTime:30*1e3});return!n&&!a?e.jsx(Cr,{}):e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(Ct,{profile:t,forgeContext:"culinary"}),e.jsx(Nr,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(kr,{}),e.jsx(Sr,{})]})]})},Ir=()=>{const t=ne(),{click:r}=K(),{startScan:s}=ye(),{isPerformanceMode:a}=q(),n=()=>{r(),s(),t("/fridge/scan")};return e.jsx(E,{className:"fridge-glass-inventory p-8 text-center relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",children:e.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[e.jsx("div",{className:`fridge-icon-inventory ${a?"":"fridge-ai-focus-inventory"} w-20 h-20 mx-auto`,children:e.jsx(p,{Icon:d.Refrigerator,size:36,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white",children:"Mon Inventaire"}),e.jsx("p",{className:"text-white/80 text-base md:text-lg leading-relaxed",children:"Gérez vos ingrédients, générez des recettes et des plans alimentaires"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"fridge-icon-inventory w-12 h-12 mx-auto",children:e.jsx(p,{Icon:d.Camera,size:24,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})}),e.jsx("h4",{className:"text-lg font-semibold text-white",children:"Scan Rapide"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Photographiez votre frigo en quelques secondes pour un inventaire automatique"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"fridge-icon-inventory w-12 h-12 mx-auto",children:e.jsx(p,{Icon:d.Utensils,size:24,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})}),e.jsx("h4",{className:"text-lg font-semibold text-white",children:"Recettes Personnalisées"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Générez des recettes adaptées à vos ingrédients disponibles"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"fridge-icon-inventory w-12 h-12 mx-auto",children:e.jsx(p,{Icon:d.Calendar,size:24,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})}),e.jsx("h4",{className:"text-lg font-semibold text-white",children:"Plans de Repas"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Créez des plans alimentaires équilibrés pour toute la semaine"})]})]}),e.jsx("button",{onClick:n,className:"fridge-btn-inventory-primary px-6 md:px-8 py-3 md:py-4 text-lg md:text-xl font-bold relative overflow-hidden rounded-full transition-all duration-200 hover:scale-105 active:scale-95",children:e.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[e.jsx(p,{Icon:d.Camera,size:20,color:"white",variant:"pure"}),"Commencer - Scanner Mon Frigo"]})}),e.jsx("div",{className:"fridge-info-panel mt-8 p-4 w-full",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(p,{Icon:d.Lightbulb,size:20,color:"rgba(255, 255, 255, 0.95)",variant:"pure",style:{marginTop:"2px"}}),e.jsxs("div",{className:"text-left",children:[e.jsx("h5",{className:"text-sm font-semibold text-white/90 mb-1",children:"Astuce TwinForge"}),e.jsx("p",{className:"text-white/70 text-xs leading-relaxed",children:"Pour de meilleurs résultats, photographiez votre frigo avec un bon éclairage et organisez vos aliments de manière visible."})]})]})})]})})},Er=({session:t,onDeleteIndividualInventory:r})=>{const s=ne(),a=()=>{s("/fridge#recipes")},n=()=>{s("/fridge#plan")},i=()=>{r(t.id)};return e.jsxs("div",{className:"glass-card p-6 rounded-3xl",style:{background:`
          linear-gradient(135deg,
            color-mix(in srgb, var(--color-fridge-primary) 15%, transparent) 0%,
            color-mix(in srgb, var(--color-plasma-cyan) 12%, transparent) 50%,
            color-mix(in srgb, var(--color-fridge-primary) 8%, transparent) 100%
          )
        `,borderColor:"color-mix(in srgb, var(--color-fridge-primary) 40%, transparent)",borderRadius:"1.5rem",boxShadow:`
          0 12px 40px color-mix(in srgb, var(--color-fridge-primary) 25%, transparent),
          0 4px 16px rgba(0, 0, 0, 0.3),
          inset 0 2px 0 rgba(255, 255, 255, 0.15),
          inset 0 -2px 0 rgba(0, 0, 0, 0.1)
        `},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-xl",style:{background:`
              radial-gradient(circle at center, 
                color-mix(in srgb, var(--color-fridge-primary) 30%, transparent) 0%,
                color-mix(in srgb, var(--color-fridge-primary) 20%, transparent) 50%,
                color-mix(in srgb, var(--color-fridge-primary) 10%, transparent) 100%
              )
            `,border:"1px solid color-mix(in srgb, var(--color-fridge-primary) 50%, transparent)",boxShadow:`
              0 0 20px color-mix(in srgb, var(--color-fridge-primary) 40%, transparent),
              0 4px 12px rgba(0, 0, 0, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.2)
            `},children:e.jsx(p,{Icon:d.CheckCircle,size:20,className:"text-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Inventaire Sélectionné"})]}),e.jsxs("div",{className:"mb-4 p-4 bg-white/5 rounded-lg border border-white/10",children:[e.jsxs("p",{className:"text-gray-300 text-sm",children:["Inventaire du ",new Date(t.created_at).toLocaleDateString("fr-FR")]}),e.jsxs("p",{className:"text-white font-medium",children:[t.inventory_final?.length||0," articles détectés"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsx("button",{onClick:a,className:"btn-glass--primary px-4 py-3 text-sm font-medium rounded-2xl",style:{background:`
              linear-gradient(135deg,
                var(--color-fridge-primary) 0%,
                color-mix(in srgb, var(--color-fridge-primary) 80%, #ffffff) 100%
              )
            `,borderColor:"color-mix(in srgb, var(--color-fridge-primary) 70%, transparent)",borderRadius:"1rem",boxShadow:`
              0 8px 24px color-mix(in srgb, var(--color-fridge-primary) 35%, transparent),
              0 3px 12px rgba(0, 0, 0, 0.25),
              inset 0 2px 0 rgba(255, 255, 255, 0.2),
              inset 0 -2px 0 rgba(0, 0, 0, 0.1)
            `,color:"white",transform:"translateZ(0)",transition:"all 0.2s ease"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.ChefHat,size:16}),e.jsx("span",{children:"Générer Recettes"})]})}),e.jsx("button",{onClick:n,className:"btn-glass--primary px-4 py-3 text-sm font-medium rounded-2xl",style:{background:`
              linear-gradient(135deg,
                var(--color-plasma-cyan) 0%,
                color-mix(in srgb, var(--color-plasma-cyan) 80%, #ffffff) 100%
              )
            `,borderColor:"color-mix(in srgb, var(--color-plasma-cyan) 70%, transparent)",borderRadius:"1rem",boxShadow:`
              0 8px 24px color-mix(in srgb, var(--color-plasma-cyan) 35%, transparent),
              0 3px 12px rgba(0, 0, 0, 0.25),
              inset 0 2px 0 rgba(255, 255, 255, 0.2),
              inset 0 -2px 0 rgba(0, 0, 0, 0.1)
            `,color:"white",transform:"translateZ(0)",transition:"all 0.2s ease"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Calendar,size:16}),e.jsx("span",{children:"Plan de Repas"})]})}),e.jsx("button",{onClick:i,className:"btn-glass--danger px-4 py-3 text-sm font-medium rounded-2xl",style:{borderRadius:"1rem"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Trash2,size:16}),e.jsx("span",{children:"Supprimer cet inventaire"})]})})]})]})},Fr=({onDeleteAllInventories:t,onRefresh:r})=>e.jsx("div",{className:"glass-card rounded-3xl",style:{background:"color-mix(in srgb, var(--color-plasma-cyan) 8%, transparent)",borderColor:"color-mix(in srgb, var(--color-plasma-cyan) 30%, transparent)",borderRadius:"1.5rem",boxShadow:`
          0 8px 32px color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent),
          0 2px 8px rgba(0, 0, 0, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1)
        `,overflow:"visible",isolation:"isolate",padding:0,paddingBottom:"1rem"},children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"flex-shrink-0",style:{width:"56px",height:"56px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.22) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent) 0%, transparent 60%),
                linear-gradient(135deg,
                  color-mix(in srgb, var(--color-plasma-cyan) 25%, transparent),
                  color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent))
              `,border:"2px solid color-mix(in srgb, var(--color-plasma-cyan) 45%, transparent)",boxShadow:`
                0 8px 32px color-mix(in srgb, var(--color-plasma-cyan) 25%, transparent),
                0 0 40px color-mix(in srgb, var(--color-plasma-cyan) 18%, transparent),
                inset 0 2px 0 rgba(255, 255, 255, 0.25)
              `,backdropFilter:"blur(16px) saturate(150%)",WebkitBackdropFilter:"blur(16px) saturate(150%)",transform:"translateZ(0)",overflow:"visible"},children:e.jsx(p,{Icon:d.Archive,size:28,style:{color:"#06B6D4",filter:"drop-shadow(0 0 8px rgba(6, 182, 212, 0.6))"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white mb-1 tracking-tight",children:"Gestion des Inventaires"}),e.jsx("p",{className:"text-gray-400 text-sm md:text-base leading-relaxed",children:"Vos inventaires de frigo sauvegardés"})]}),r&&e.jsx("button",{onClick:r,className:"flex-shrink-0 p-3 rounded-xl transition-all duration-200 hover:scale-105 active:scale-95",style:{background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.15)",backdropFilter:"blur(8px)"},title:"Rafraîchir les inventaires",children:e.jsx(p,{Icon:d.RefreshCw,size:20,style:{color:"#06B6D4"}})})]})})}),Tr=({sessions:t,selectedInventorySessionId:r,onInventorySelect:s,formatDate:a,getInventoryPreview:n})=>{const{isPerformanceMode:i}=q();return i||k.div,t.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-white/60",children:"Aucun inventaire disponible. Scannez votre frigo pour commencer !"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i?t.map(o=>e.jsx("div",{children:e.jsx(E,{className:`fridge-glass-inventory p-6 h-full cursor-pointer group relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] ${r===o.id?"fridge-glass-inventory--selected ring-2 ring-indigo-400/50":""}`,onClick:()=>s(o),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"fridge-icon-inventory w-10 h-10",children:e.jsx(p,{Icon:d.Package,size:18,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white text-sm",children:"Inventaire"}),e.jsx("p",{className:"text-white/60 text-xs",children:a(o.created_at)})]})]}),e.jsxs("div",{className:"fridge-badge-success flex items-center gap-1 px-2 py-1",children:[e.jsx(p,{Icon:d.Package,size:12,color:"rgba(16, 185, 129, 1)",variant:"pure"}),e.jsx("span",{className:"text-emerald-300 text-xs font-medium",children:o.inventory_final?.length||0})]})]}),e.jsx("div",{className:"flex-1 mb-4",children:e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:n(o.inventory_final)})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:`px-3 py-1 rounded-lg text-xs font-medium transition-all duration-200 ${r===o.id?"fridge-badge-inventory-active text-cyan-300":"fridge-badge-inventory text-white/60"}`,children:r===o.id?"Sélectionné":"Cliquer pour sélectionner"})})]})})},o.id)):e.jsx(de,{children:t.map((o,l)=>e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:l*.1},children:e.jsx(E,{className:`fridge-glass-inventory p-6 h-full cursor-pointer group relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] ${r===o.id?"fridge-glass-inventory--selected ring-2 ring-indigo-400/50":""}`,onClick:()=>s(o),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"fridge-icon-inventory w-10 h-10",children:e.jsx(p,{Icon:d.Package,size:18,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white text-sm",children:"Inventaire"}),e.jsx("p",{className:"text-white/60 text-xs",children:a(o.created_at)})]})]}),e.jsxs("div",{className:"fridge-badge-success flex items-center gap-1 px-2 py-1",children:[e.jsx(p,{Icon:d.Package,size:12,color:"rgba(16, 185, 129, 1)",variant:"pure"}),e.jsx("span",{className:"text-emerald-300 text-xs font-medium",children:o.inventory_final?.length||0})]})]}),e.jsx("div",{className:"flex-1 mb-4",children:e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:n(o.inventory_final)})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:`px-3 py-1 rounded-lg text-xs font-medium transition-all duration-200 ${r===o.id?"fridge-badge-inventory-active text-cyan-300":"fridge-badge-inventory text-white/60"}`,children:r===o.id?"Sélectionné":"Cliquer pour sélectionner"})})]})})},o.id))})})},Pr=({loading:t,error:r})=>t?e.jsx(E,{className:"p-8 text-center relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
            rgba(255, 255, 255, 0.06)
          `,borderColor:"color-mix(in srgb, #06B6D4 25%, transparent)",backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #06B6D4 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center relative",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 20%, transparent) 0%, transparent 60%),
                rgba(255, 255, 255, 0.1)
              `,border:"2px solid color-mix(in srgb, #06B6D4 50%, transparent)",boxShadow:`
                0 8px 32px color-mix(in srgb, #06B6D4 25%, transparent),
                inset 0 2px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(p,{Icon:d.Loader2,size:24,className:"animate-spin",style:{color:"#06B6D4",filter:"drop-shadow(0 0 8px color-mix(in srgb, #06B6D4 40%, transparent))"},variant:"pure"})}),e.jsx("span",{className:"text-white text-lg font-medium",children:"Chargement de vos inventaires..."})]})}):r?e.jsx(E,{className:"p-6 relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #F97316 8%, transparent) 0%, transparent 60%),
            rgba(255, 255, 255, 0.06)
          `,borderColor:"color-mix(in srgb, #EF4444 25%, transparent)",backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #EF4444 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center relative",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 20%, transparent) 0%, transparent 60%),
                rgba(255, 255, 255, 0.1)
              `,border:"2px solid color-mix(in srgb, #EF4444 50%, transparent)",boxShadow:`
                0 8px 32px color-mix(in srgb, #EF4444 25%, transparent),
                inset 0 2px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(p,{Icon:d.AlertCircle,size:24,style:{color:"#EF4444",filter:"drop-shadow(0 0 8px color-mix(in srgb, #EF4444 40%, transparent))"},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:"Erreur de Chargement"}),e.jsx("p",{className:"text-white/70",children:r})]})]})}):null,Rr=({loading:t,sessions:r})=>t||r.length===0?null:e.jsx(E,{className:"p-4 relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
          rgba(255, 255, 255, 0.06)
        `,borderColor:"color-mix(in srgb, #06B6D4 20%, transparent)",backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
          0 8px 32px rgba(0, 0, 0, 0.2),
          0 0 20px color-mix(in srgb, #06B6D4 10%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{Icon:d.Info,size:16,style:{color:"#06B6D4",filter:"drop-shadow(0 0 6px color-mix(in srgb, #06B6D4 30%, transparent))"},variant:"pure"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-cyan-300 font-medium",children:"Inventaires disponibles : "}),e.jsxs("span",{className:"text-white/80",children:[r.length," inventaire",r.length>1?"s":""," sauvegardé",r.length>1?"s":""]})]})]})}),Dr=t=>{const[r,s]=j.useState(!1),[a,n]=j.useState([]),[i,o]=j.useState(null),[l,c]=j.useState(0),x=()=>{c(g=>g+1)};return j.useEffect(()=>{let g=!0;async function m(){if(!t){n([]);return}s(!0),o(null);try{N.info("FRIDGES_TAB","Loading fridge sessions",{userId:t,timestamp:new Date().toISOString()});const{data:u,error:b}=await W.from("recipe_sessions").select("id, created_at, inventory_final, status").eq("user_id",t).not("inventory_final","is",null).order("created_at",{ascending:!1});if(b)throw new Error(`Failed to fetch fridge sessions: ${b.message}`);if(!g)return;const w=(u||[]).filter(v=>v.inventory_final&&Array.isArray(v.inventory_final)&&v.inventory_final.length>0);n(w),N.info("FRIDGES_TAB","Loaded fridge sessions",{sessionsCount:w.length,timestamp:new Date().toISOString()})}catch(u){if(N.error("FRIDGES_TAB","Failed to load fridge sessions",{error:u instanceof Error?u.message:"Unknown error",userId:t,timestamp:new Date().toISOString()}),!g)return;o("Erreur lors du chargement des inventaires")}finally{g&&s(!1)}}return m(),()=>{g=!1}},[t,l]),{loading:r,sessions:a,error:i,setSessions:n,setLoading:s,refreshSessions:x}},Ar=(t,r,s,a,n)=>{const{showToast:i}=_e(),{showModal:o}=Nt(),l=j.useCallback(()=>{!t||r.length===0||o({title:"Supprimer tous les inventaires",message:"Êtes-vous sûr de vouloir supprimer tous vos inventaires de frigo ? Cette action est irréversible.",confirmText:"Supprimer tout",cancelText:"Annuler",onConfirm:async()=>{a(!0);try{const x=r.map(g=>g.id);if(x.length>0){const{error:g}=await W.from("recipes").delete().in("session_id",x);if(g)throw console.error("Error deleting recipes:",g),g;const{error:m}=await W.from("recipe_sessions").delete().eq("user_id",t);if(m)throw console.error("Error deleting recipe sessions:",m),m}s([]),n(null),i("Tous les inventaires ont été supprimés avec succès","success")}catch(x){console.error("Error deleting all inventories:",x),i("Erreur lors de la suppression des inventaires","error")}finally{a(!1)}}})},[t,r,s,a,n,o,i]),c=j.useCallback(x=>{if(!t)return;const g=r.find(m=>m.id===x);g&&o({title:"Supprimer cet inventaire",message:`Êtes-vous sûr de vouloir supprimer l'inventaire du ${new Date(g.created_at).toLocaleDateString("fr-FR")} ? Cette action est irréversible.`,confirmText:"Supprimer",cancelText:"Annuler",onConfirm:async()=>{a(!0);try{const{error:m}=await W.from("recipes").delete().eq("session_id",x);if(m)throw console.error("Error deleting recipes:",m),m;const{error:u}=await W.from("recipe_sessions").delete().eq("id",x).eq("user_id",t);if(u)throw console.error("Error deleting recipe session:",u),u;const b=r.filter(w=>w.id!==x);s(b),n(null),i("Inventaire supprimé avec succès","success")}catch(m){console.error("Error deleting individual inventory:",m),i("Erreur lors de la suppression de l'inventaire","error")}finally{a(!1)}}})},[t,r,s,a,n,o,i]);return{handleDeleteAllInventories:l,handleDeleteIndividualInventory:c}},Br=()=>{const{click:t}=K(),[r,s]=j.useState(null);return{selectedInventorySessionId:r,handleInventorySelect:n=>{t(),s(n.id),setTimeout(()=>{const i=document.getElementById("selected-inventory-actions");i&&i.scrollIntoView({behavior:"smooth",block:"center"})},100)},setSelectedInventorySessionId:s}},_r=t=>new Date(t).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),Mr=t=>{if(!t||t.length===0)return"Inventaire vide";const r=t.slice(0,3).map(a=>a.name||a.item||"Article").join(", "),s=t.length-3;return s>0?`${r} et ${s} autre${s>1?"s":""}`:r},zs=()=>{const t=ne(),{showToast:r}=_e(),{session:s}=ve(),{startRecipeGenerationFromInventory:a}=ye(),{generateMealPlan:n}=Ce(),i=s?.user?.id,{loading:o,sessions:l,error:c,setSessions:x,setLoading:g,refreshSessions:m}=Dr(i);j.useEffect(()=>{const P=()=>{!document.hidden&&i&&m()},D=()=>{i&&m()};return document.addEventListener("visibilitychange",P),window.addEventListener("focus",D),()=>{document.removeEventListener("visibilitychange",P),window.removeEventListener("focus",D)}},[i,m]);const{selectedInventorySessionId:u,handleInventorySelect:b,setSelectedInventorySessionId:w}=Br(),{handleDeleteAllInventories:v,handleDeleteIndividualInventory:F}=Ar(i,l,x,g,w),I=l.find(P=>P.id===u);return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[!o&&l.length===0&&e.jsx(Ir,{}),l.length>0&&e.jsx(Fr,{onDeleteAllInventories:v,onRefresh:m}),e.jsx(Pr,{loading:o,error:c}),!o&&!c&&e.jsx(Tr,{sessions:l,selectedInventorySessionId:u,onInventorySelect:b,formatDate:_r,getInventoryPreview:Mr}),I&&e.jsx(Er,{session:I,onGenerateRecipes:a,onGenerateMealPlan:n,onDeleteIndividualInventory:F,navigate:t,showToast:r}),e.jsx(Rr,{loading:o,sessions:l}),l.length>0&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{onClick:v,className:"btn-glass--danger px-8 py-3 text-base font-medium rounded-2xl",style:{borderRadius:"1rem"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{Icon:d.AlertTriangle,size:20}),e.jsx("span",{children:"Supprimer tous les inventaires"})]})})})]})},vt=({recipe:t,onClose:r,onToggleSave:s,isSaved:a=!1})=>{const{click:n}=K(),i=c=>{c.target===c.currentTarget&&(n(),r())},o=()=>{s&&(n(),s(t))},l="#10B981";return ce.useEffect(()=>{const c=window.innerWidth-document.documentElement.clientWidth;return document.body.style.overflow="hidden",document.body.style.paddingRight=`${c}px`,()=>{document.body.style.overflow="",document.body.style.paddingRight=""}},[]),ce.useEffect(()=>{const c=x=>{x.key==="Escape"&&(n(),r())};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[n,r]),ct.createPortal(e.jsx(de,{children:e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},onClick:i,role:"dialog","aria-modal":"true","aria-labelledby":"recipe-detail-title",children:e.jsx(k.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"w-full max-w-4xl",style:{maxHeight:"90vh",overflowY:"auto"},onClick:c=>c.stopPropagation(),children:e.jsxs(E,{className:"p-6",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, ${l} 12%, transparent) 0%, transparent 60%),
                radial-gradient(circle at 70% 80%, color-mix(in srgb, ${l} 8%, transparent) 0%, transparent 50%),
                linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.10)),
                rgba(11, 14, 23, 0.95)
              `,borderColor:`color-mix(in srgb, ${l} 30%, transparent)`,boxShadow:`
                0 25px 80px rgba(0, 0, 0, 0.6),
                0 0 60px color-mix(in srgb, ${l} 30%, transparent),
                inset 0 3px 0 rgba(255, 255, 255, 0.3),
                inset 0 -3px 0 rgba(0, 0, 0, 0.2)
              `,backdropFilter:"blur(32px) saturate(180%)",WebkitBackdropFilter:"blur(32px) saturate(180%)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[t.imageUrl&&e.jsx("div",{className:"w-24 h-24 rounded-2xl overflow-hidden flex-shrink-0",style:{border:`3px solid color-mix(in srgb, ${l} 60%, transparent)`,boxShadow:`0 0 30px color-mix(in srgb, ${l} 50%, transparent)`},children:e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{id:"recipe-detail-title",className:"text-2xl font-bold text-white mb-2",children:t.title}),t.description&&e.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:t.description})]})]}),e.jsx("button",{onClick:r,className:"p-2 rounded-full transition-all duration-200 flex-shrink-0",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},"aria-label":"Fermer le détail",children:e.jsx(p,{Icon:d.X,size:18,className:"text-white/80"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${l} 20%, transparent)`},children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-2",children:e.jsx(p,{Icon:d.Clock,size:16,style:{color:"#3B82F6"}})}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.prepTimeMin||0}),e.jsx("div",{className:"text-white/70 text-sm",children:"Préparation (min)"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${l} 20%, transparent)`},children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-2",children:e.jsx(p,{Icon:d.Flame,size:16,style:{color:"#F59E0B"}})}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.cookTimeMin||0}),e.jsx("div",{className:"text-white/70 text-sm",children:"Cuisson (min)"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${l} 20%, transparent)`},children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-2",children:e.jsx(p,{Icon:d.Users,size:16,style:{color:"#8B5CF6"}})}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.servings||1}),e.jsx("div",{className:"text-white/70 text-sm",children:"Portions"})]})]}),t.ingredients&&t.ingredients.length>0&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${l} 15%, transparent)`},children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2 text-lg",children:[e.jsx(p,{Icon:d.ShoppingCart,size:18,style:{color:l}}),"Ingrédients"]}),e.jsx("div",{className:"space-y-2",children:t.ingredients.map((c,x)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-1 font-bold",children:"•"}),e.jsxs("span",{className:"text-white/80 text-sm",children:[c?.quantity&&`${c.quantity} `,c?.unit&&`${c.unit} `,c?.name]})]},x))})]}),t.instructions&&t.instructions.length>0&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${l} 15%, transparent)`},children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2 text-lg",children:[e.jsx(p,{Icon:d.FileText,size:18,style:{color:l}}),"Instructions"]}),e.jsx("div",{className:"space-y-4",children:t.instructions.map((c,x)=>{const g=typeof c=="string",m=g?x+1:c?.step||x+1,u=g?c:c?.instruction,b=g?null:c?.timeMin;return e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${l} 20%, transparent)`,border:`2px solid color-mix(in srgb, ${l} 40%, transparent)`},children:e.jsx("span",{className:"text-emerald-400 font-bold text-sm",children:m})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:u}),b&&e.jsxs("p",{className:"text-white/50 text-xs mt-1",children:["⏱️ ",b," min"]})]})]},g?x:c?.step||x)})})]}),t.nutritionalInfo&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${l} 15%, transparent)`},children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2 text-lg",children:[e.jsx(p,{Icon:d.Activity,size:18,style:{color:l}}),"Informations Nutritionnelles"]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.nutritionalInfo.calories||t.nutritionalInfo.kcal||0}),e.jsx("div",{className:"text-white/70 text-xs",children:"Calories (kcal)"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.nutritionalInfo.protein||0}),e.jsx("div",{className:"text-white/70 text-xs",children:"Protéines (g)"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.nutritionalInfo.carbs||0}),e.jsx("div",{className:"text-white/70 text-xs",children:"Glucides (g)"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.nutritionalInfo.fat||0}),e.jsx("div",{className:"text-white/70 text-xs",children:"Lipides (g)"})]})]})]}),t.dietaryTags&&t.dietaryTags.length>0&&e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:t.dietaryTags.map((c,x)=>e.jsx("span",{className:"px-3 py-1 text-xs rounded-full font-medium",style:{background:`color-mix(in srgb, ${l} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${l} 30%, transparent)`,color:"#A7F3D0"},children:c},x))})}),e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(p,{Icon:d.Info,size:14,className:"text-white/70"}),"Informations Techniques"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"ID :"}),e.jsxs("div",{className:"text-white/80 font-mono text-xs mt-1",children:[t.id.substring(0,8),"..."]})]}),t.createdAt&&e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"Créée le :"}),e.jsx("div",{className:"text-white/80 text-xs mt-1",children:Ge(new Date(t.createdAt),"dd/MM/yyyy HH:mm")})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[s&&e.jsx("button",{onClick:o,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:a?`linear-gradient(135deg,
                          color-mix(in srgb, #EF4444 80%, transparent),
                          color-mix(in srgb, #F59E0B 60%, transparent)
                        )`:`linear-gradient(135deg,
                          color-mix(in srgb, ${l} 80%, transparent),
                          color-mix(in srgb, #22C55E 60%, transparent)
                        )`,border:a?"2px solid color-mix(in srgb, #EF4444 60%, transparent)":`2px solid color-mix(in srgb, ${l} 60%, transparent)`,boxShadow:a?`
                          0 12px 40px color-mix(in srgb, #EF4444 40%, transparent),
                          0 0 60px color-mix(in srgb, #EF4444 30%, transparent),
                          inset 0 3px 0 rgba(255,255,255,0.4)
                        `:`
                          0 12px 40px color-mix(in srgb, ${l} 40%, transparent),
                          0 0 60px color-mix(in srgb, ${l} 30%, transparent),
                          inset 0 3px 0 rgba(255,255,255,0.4)
                        `,backdropFilter:"blur(20px) saturate(160%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(p,{Icon:a?d.Trash2:d.Bookmark,size:16,className:"text-white"}),e.jsx("span",{children:a?"Retirer de la bibliothèque":"Sauvegarder"})]})}),e.jsx("button",{onClick:r,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:`linear-gradient(135deg,
                    color-mix(in srgb, #6B7280 80%, transparent),
                    color-mix(in srgb, #9CA3AF 60%, transparent)
                  )`,border:"2px solid color-mix(in srgb, #6B7280 60%, transparent)",boxShadow:`
                    0 8px 32px color-mix(in srgb, #6B7280 30%, transparent),
                    inset 0 2px 0 rgba(255,255,255,0.3)
                  `,backdropFilter:"blur(16px) saturate(140%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(p,{Icon:d.X,size:16,className:"text-white"}),e.jsx("span",{children:"Fermer"})]})})]})]})})})}),document.body)},zr=({recipe:t,index:r,isSaved:s,isNewlyGenerated:a=!1,isLoading:n=!1,onToggleSaveStatus:i,onView:o})=>{const{click:l}=K(),{isPerformanceMode:c}=q(),x=c?"div":k.div;if(n)return e.jsx(x,{...!c&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1}},className:"h-full",children:e.jsxs(E,{className:"p-6 h-full flex flex-col",children:[e.jsx("div",{className:"relative mb-4 h-48 rounded-lg overflow-hidden",children:e.jsx("div",{className:"w-full h-full skeleton-glass"})}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("div",{className:"h-6 skeleton-glass rounded w-4/5"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 skeleton-glass rounded w-full"}),e.jsx("div",{className:"h-4 skeleton-glass rounded w-3/4"}),e.jsx("div",{className:"h-4 skeleton-glass rounded w-1/2"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"h-4 w-12 skeleton-glass rounded"}),e.jsx("div",{className:"h-4 w-16 skeleton-glass rounded"}),e.jsx("div",{className:"h-4 w-8 skeleton-glass rounded"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("div",{className:"h-6 w-16 skeleton-glass rounded-full"}),e.jsx("div",{className:"h-6 w-20 skeleton-glass rounded-full"}),e.jsx("div",{className:"h-6 w-14 skeleton-glass rounded-full"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("div",{className:"h-3 w-32 skeleton-glass rounded"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-3 skeleton-glass rounded w-full"}),e.jsx("div",{className:"h-3 skeleton-glass rounded w-4/5"})]})]})]})});const g=u=>{u.stopPropagation(),l(),i()},m=()=>{o&&(l(),o(t))};return e.jsx(x,{...!c&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1}},className:"relative",children:e.jsxs(E,{className:`p-6 ${c?"":"transition-all duration-300"} cursor-pointer ${a?"ring-1 ring-yellow-400":s?"ring-1 ring-green-400/50":c?"":"hover:bg-white/5"}`,style:c?a?{background:"linear-gradient(145deg, color-mix(in srgb, #eab308 20%, #1e293b), color-mix(in srgb, #eab308 10%, #0f172a))"}:s?{background:"linear-gradient(145deg, color-mix(in srgb, #22c55e 15%, #1e293b), color-mix(in srgb, #22c55e 8%, #0f172a))"}:{background:"linear-gradient(145deg, #1e293b, #0f172a)"}:a?{background:"rgba(234, 179, 8, 0.1)"}:s?{background:"rgba(34, 197, 94, 0.05)"}:{},onClick:m,children:[a&&e.jsx(x,{...!c&&{initial:{scale:0},animate:{scale:1}},className:"absolute top-4 left-4 z-10",children:e.jsx("div",{className:"px-3 py-1 text-xs font-bold rounded-full border",style:c?{background:"color-mix(in srgb, #eab308 30%, #1e293b)",borderColor:"color-mix(in srgb, #eab308 60%, transparent)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",color:"#fbbf24"}:{background:"color-mix(in srgb, #eab308 20%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #eab308 40%, transparent)",boxShadow:"0 4px 12px rgba(234, 179, 8, 0.3), inset 0 1px 0 rgba(255,255,255,0.2)",backdropFilter:"blur(12px)",color:"#fbbf24"},children:"NOUVEAU"})}),e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsx(x,{onClick:g,className:`w-14 h-14 rounded-full flex items-center justify-center cursor-pointer border ${c?"":"transition-all duration-300 hover:scale-110"}`,style:c?{background:s?"color-mix(in srgb, #ef4444 30%, #1e293b)":"color-mix(in srgb, #22c55e 30%, #1e293b)",borderColor:s?"color-mix(in srgb, #ef4444 60%, transparent)":"color-mix(in srgb, #22c55e 60%, transparent)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"}:{background:s?"color-mix(in srgb, #ef4444 20%, rgba(255,255,255,0.1))":"color-mix(in srgb, #22c55e 20%, rgba(255,255,255,0.1))",borderColor:s?"color-mix(in srgb, #ef4444 40%, transparent)":"color-mix(in srgb, #22c55e 40%, transparent)",backdropFilter:"blur(12px)"},...!c&&{whileHover:{scale:1.1},whileTap:{scale:.95}},children:e.jsx(p,{Icon:s?d.Trash2:d.Plus,size:18,className:s?"text-red-300":"text-green-300"})})}),e.jsx("div",{className:"relative mb-4 h-48 rounded-lg overflow-hidden bg-gradient-to-br from-green-500/20 to-emerald-500/20",children:n||t.isGeneratingImage?e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-sm border border-white/10 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"space-y-3 text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-white/10 rounded-full animate-pulse"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-white/20 rounded animate-pulse"}),e.jsx("div",{className:"h-2 bg-white/15 rounded animate-pulse w-3/4 mx-auto"})]})]})}):t.imageGenerationError?e.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-red-500/10 to-red-600/5 backdrop-blur-sm border border-red-400/20 rounded-lg flex flex-col items-center justify-center text-center p-4",children:[e.jsx(p,{Icon:d.Image,size:32,className:"text-red-400 mb-2"}),e.jsx("p",{className:"text-xs text-red-300",children:"Image indisponible"})]}):t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover",loading:"lazy"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-sm border border-white/10 rounded-lg flex items-center justify-center",children:e.jsx(p,{Icon:d.ChefHat,size:48,className:"text-white/40"})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xl font-bold text-white line-clamp-2",children:t.title}),t.description&&e.jsx("p",{className:"text-white/80 text-sm line-clamp-3",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 flex-wrap",children:[t.prepTimeMin&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #3b82f6 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #3b82f6 30%, transparent)",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.2)"},children:[e.jsx(p,{Icon:d.Clock,size:12,className:"text-blue-300"}),e.jsxs("span",{className:"text-blue-200 font-medium",children:[t.prepTimeMin,"min"]})]}),t.cookTimeMin&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #f59e0b 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #f59e0b 30%, transparent)",boxShadow:"0 2px 8px rgba(245, 158, 11, 0.2)"},children:[e.jsx(p,{Icon:d.Flame,size:12,className:"text-amber-300"}),e.jsxs("span",{className:"text-amber-200 font-medium",children:[t.cookTimeMin,"min"]})]}),t.servings&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #8b5cf6 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #8b5cf6 30%, transparent)",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.2)"},children:[e.jsx(p,{Icon:d.Users,size:12,className:"text-violet-300"}),e.jsx("span",{className:"text-violet-200 font-medium",children:t.servings})]}),t.nutritionalInfo?.calories&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #ef4444 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #ef4444 30%, transparent)",boxShadow:"0 2px 8px rgba(239, 68, 68, 0.2)"},children:[e.jsx(p,{Icon:d.Flame,size:12,className:"text-red-300"}),e.jsxs("span",{className:"text-red-200 font-medium",children:[t.nutritionalInfo.calories," kcal"]})]})]}),t.dietaryTags&&t.dietaryTags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[t.dietaryTags.slice(0,3).map((u,b)=>e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-white/10 text-white/80",children:u},b)),t.dietaryTags.length>3&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded-full bg-white/10 text-white/60",children:["+",t.dietaryTags.length-3]})]}),t.reasons&&t.reasons.length>0&&e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx("p",{className:"text-xs text-white/60 font-medium",children:"Pourquoi cette recette :"}),e.jsx("ul",{className:"text-xs text-white/70 space-y-1",children:t.reasons.slice(0,2).map((u,b)=>e.jsxs("li",{className:"flex items-start gap-1",children:[e.jsx("span",{className:"text-green-400 mt-0.5",children:"•"}),e.jsx("span",{children:u})]},b))})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:s?d.BookOpen:d.Book,size:14,className:s?"text-green-400":"text-white/50"}),e.jsx("span",{className:`text-xs ${s?"text-green-400":"text-white/50"}`,children:s?"Dans votre bibliothèque":"Non sauvegardée"})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s?"bg-green-500/20 text-green-400":"bg-white/10 text-white/60"}`,children:s?"Sauvegardée":"Temporaire"})]})]})})},$r=ce.memo(zr),Se=8,Lr=120,oe=40,ot=6,Ae=({value:t,options:r,onChange:s,placeholder:a="Sélectionner...",className:n="","aria-label":i,buttonClassName:o=""})=>{const[l,c]=j.useState(!1),[x,g]=j.useState(!1),[m,u]=j.useState({top:0,left:0,width:0,maxHeight:240}),b=j.useRef(null),w=j.useRef(null),v=j.useRef(null),F=j.useMemo(()=>Math.max(0,r.findIndex(C=>C.value===t)),[r,t]),I=()=>{const C=w.current;if(!C)return;const M=C.getBoundingClientRect(),U=window.innerWidth,L=window.innerHeight,z=M.width,X=Math.min(Math.max(M.left,Se),Math.max(Se,U-z-Se)),ee=L-M.bottom-Se,te=M.top-Se,ie=ee<160&&te>ee;g(ie);const G=Math.max(Lr,Math.floor(ie?te:ee)),ke=ie?M.top-G:M.bottom;u({top:ke,left:X,width:z,maxHeight:G})},P=()=>c(C=>!C);j.useEffect(()=>{const C=M=>{const U=M.target;!b.current?.contains(U)&&!v.current?.contains(U)&&c(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),j.useLayoutEffect(()=>{if(!l)return;I();const C=()=>I(),M=()=>I(),U=new ResizeObserver(()=>I());return w.current&&U.observe(w.current),window.addEventListener("scroll",C,!0),window.addEventListener("resize",M),requestAnimationFrame(()=>{if(!v.current)return;const L=m.maxHeight,z=Math.max(0,F*oe-Math.max(0,L/2-oe/2));v.current.scrollTop=z}),()=>{U.disconnect(),window.removeEventListener("scroll",C,!0),window.removeEventListener("resize",M)}},[l]);const[D,h]=j.useState(0);j.useEffect(()=>{if(!l)return;const C=v.current;if(!C)return;const M=()=>h(C.scrollTop);return C.addEventListener("scroll",M,{passive:!0}),()=>C.removeEventListener("scroll",M)},[l]);const S=r.length*oe,R=Math.ceil(m.maxHeight/oe)+ot*2,y=Math.max(0,Math.floor(D/oe)-ot),A=Math.min(r.length,y+R),Y=y*oe,J=r.slice(y,A);j.useEffect(()=>{if(!l)return;let C=Math.max(0,F);const M=L=>{const z=v.current;if(!z)return;const X=L*oe,ee=X+oe;X<z.scrollTop?z.scrollTop=X:ee>z.scrollTop+z.clientHeight&&(z.scrollTop=ee-z.clientHeight)},U=L=>{if(l){if(L.key==="Escape")L.preventDefault(),c(!1),w.current?.focus();else if(L.key==="ArrowDown")L.preventDefault(),C=Math.min(r.length-1,C+1),M(C),v.current?.querySelector(`[data-index='${C}']`)?.focus();else if(L.key==="ArrowUp")L.preventDefault(),C=Math.max(0,C-1),M(C),v.current?.querySelector(`[data-index='${C}']`)?.focus();else if(L.key==="Enter"){const z=document.activeElement;z?.dataset?.value&&(s(z.dataset.value),c(!1))}}};return document.addEventListener("keydown",U),()=>document.removeEventListener("keydown",U)},[l,s,r.length,F]);const Z=C=>{s(C),c(!1),w.current?.focus()},B=r.find(C=>C.value===t),ge=e.jsx(de,{children:l&&e.jsx(k.div,{initial:{opacity:0,y:x?6:-6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:x?6:-6,scale:.98},transition:{duration:.14,ease:"easeOut"},style:{position:"fixed",top:m.top,left:m.left,width:m.width,zIndex:1e5},children:e.jsx(E,{className:"py-1 px-1 overflow-y-auto rounded-2xl",style:{maxHeight:m.maxHeight,background:"linear-gradient(135deg, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0.12) 60%, rgba(255,255,255,0.08) 100%)",backdropFilter:"blur(16px) saturate(160%)",border:CSS.supports("color","color-mix(in srgb, white 28%, transparent)")?"1px solid color-mix(in srgb, white 28%, transparent)":"1px solid rgba(255,255,255,0.28)",boxShadow:"0 12px 32px rgba(0,0,0,0.45), 0 2px 8px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.2)"},ref:v,role:"listbox","aria-label":i,"aria-activedescendant":t||void 0,children:e.jsx("div",{style:{height:S,position:"relative"},children:e.jsx("div",{style:{position:"absolute",insetInlineStart:0,top:Y,right:0,left:0},children:e.jsx("div",{className:"space-y-1",children:J.map((C,M)=>{const U=y+M,L=t===C.value;return e.jsx("button",{id:C.value,"data-index":U,"data-value":C.value,type:"button",role:"option","aria-selected":L,onClick:()=>Z(C.value),className:`w-full h-10 px-3 text-left text-sm transition-colors outline-none rounded-xl
                                    focus:ring-2 focus:ring-white/30
                                    ${L?"bg-cyan-400/20 text-cyan-300":"text-white/85 hover:bg-white/10"}`,style:{lineHeight:`${oe}px`},children:C.label},C.value)})})})})})})});return e.jsxs("div",{ref:b,className:`relative ${n}`,children:[e.jsxs("button",{ref:w,type:"button",onClick:P,className:`btn-glass w-full justify-between text-left ${o}`,"aria-expanded":l,"aria-haspopup":"listbox","aria-label":i,children:[e.jsx("span",{className:"truncate",children:B?B.label:a}),e.jsx(p,{Icon:d.ChevronDown,size:16,className:`transition-transform duration-200 ${l?"rotate-180":""}`})]}),ct.createPortal(ge,document.body)]})},qr=({availableInventories:t,selectedInventoryId:r,onSelectInventory:s,onGenerateRecipes:a,isGenerating:n})=>{const{click:i}=K(),{isPerformanceMode:o}=q(),l=o?"div":k.div,c=t.find(b=>b.id===r),x=c&&c.inventory_final.length>0,g=t.map(b=>({value:b.id,label:`Inventaire du ${new Date(b.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})} (${b.inventory_final.length} ingrédients)`,subtitle:new Date(b.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})})),m=()=>{i(),a()},u=b=>{i(),s(b)};return e.jsxs(l,{...!o&&{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5}},children:[e.jsxs(E,{className:"p-5",style:o?{background:"linear-gradient(145deg, color-mix(in srgb, #10B981 20%, #1e293b), color-mix(in srgb, #10B981 10%, #0f172a))",borderColor:"color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.4)"}:{background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%)",borderColor:"rgba(16, 185, 129, 0.2)",boxShadow:"0 8px 32px rgba(16, 185, 129, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-5",children:e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center breathing-icon flex-shrink-0",style:o?{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 35%, #1e293b), color-mix(in srgb, #10B981 25%, #0f172a))",border:"2px solid color-mix(in srgb, #10B981 50%, transparent)",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.4)"}:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 35%, transparent), color-mix(in srgb, #10B981 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #10B981 40%, transparent)"},children:e.jsx(p,{Icon:d.ChefHat,size:40,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Générateur de Recettes"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Créez des recettes personnalisées à partir de votre inventaire"})]})]})}),e.jsx("div",{className:"w-full mt-5",children:e.jsx(Ae,{options:g,value:r||"",onChange:u,placeholder:"Sélectionner un inventaire",className:"w-full",disabled:n})}),t.length===0&&e.jsx(l,{...!o&&{initial:{opacity:0},animate:{opacity:1}},className:"pt-4 border-t border-white/10 mt-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-amber-400",children:[e.jsx(p,{Icon:d.AlertTriangle,size:16}),e.jsx("span",{children:"Aucun inventaire disponible. Scannez votre frigo pour commencer !"})]})})]}),e.jsx(l,{className:"w-full mt-4",...!o&&{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1}},children:e.jsx("button",{onClick:m,disabled:!x||n,className:`btn-glass btn-glass--primary w-full px-8 py-4 text-lg font-bold transition-all duration-200 flex items-center justify-center gap-2 ${!x||n?"opacity-50 cursor-not-allowed":""}`,style:x&&!n?o?{background:"linear-gradient(145deg, color-mix(in srgb, #10B981 80%, #1e293b), color-mix(in srgb, #22C55E 70%, #0f172a))",border:"2.5px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:"0 8px 32px rgba(16, 185, 129, 0.8), 0 4px 20px rgba(16, 185, 129, 0.6), 0 0 50px rgba(16, 185, 129, 0.4)",color:"white"}:{background:`
              linear-gradient(135deg,
                color-mix(in srgb, #10B981 80%, transparent),
                color-mix(in srgb, #22C55E 70%, transparent)
              )
            `,border:"2px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:`
              0 12px 40px rgba(16, 185, 129, 0.5),
              0 8px 32px rgba(16, 185, 129, 0.4),
              0 0 60px rgba(16, 185, 129, 0.3),
              inset 0 2px 0 rgba(255, 255, 255, 0.4),
              inset 0 -2px 0 rgba(0, 0, 0, 0.2)
            `,backdropFilter:"blur(20px) saturate(160%)",WebkitBackdropFilter:"blur(20px) saturate(160%)",color:"white"}:void 0,children:n?e.jsxs(e.Fragment,{children:[e.jsx(p,{Icon:d.Loader2,size:16,className:"animate-spin",style:{color:"white"}}),"Génération..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{Icon:d.Sparkles,size:16,style:{color:"white"}}),"Générer les Recettes"]})})})]})},Gr=({searchFilter:t,setSearchFilter:r,selectedFilters:s,setSelectedFilters:a,recipesCount:n,totalRecipesCount:i,isGenerating:o,maxPrepTime:l,setMaxPrepTime:c,maxCookTime:x,setMaxCookTime:g,minServings:m,setMinServings:u})=>{const[b,w]=j.useState(!1),{isPerformanceMode:v}=q(),F=v?"div":k.div,I=v?"button":k.button,P=["végétarien","vegan","sans gluten","rapide","économique","protéiné","léger","réconfortant"],D=y=>{s.includes(y)?a(s.filter(A=>A!==y)):a([...s,y])},h=()=>{r(""),a([]),c?.(void 0),g?.(void 0),u?.(void 0)},S=t.length>0||s.length>0||l!==void 0||x!==void 0||m!==void 0,R=()=>{w(!b)};return e.jsxs(E,{className:"p-4 space-y-6",style:v?{background:"linear-gradient(145deg, color-mix(in srgb, #10B981 20%, #1e293b), color-mix(in srgb, #10B981 10%, #0f172a))",borderColor:"color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.4)"}:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #34D399 8%, transparent) 0%, transparent 50%),
          rgba(255, 255, 255, 0.05)
        `,borderColor:"color-mix(in srgb, #10B981 25%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #10B981 15%, transparent),
          0 0 60px color-mix(in srgb, #34D399 10%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center breathing-icon",style:v?{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 35%, #1e293b), color-mix(in srgb, #10B981 25%, #0f172a))",border:"2px solid color-mix(in srgb, #10B981 50%, transparent)",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.4)"}:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #10B981 35%, transparent), color-mix(in srgb, #10B981 25%, transparent))
              `,border:"2px solid color-mix(in srgb, #10B981 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #10B981 40%, transparent)"},children:e.jsx(p,{Icon:d.Filter,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Filtrer les Recettes"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Affiner votre recherche"})]})]}),e.jsxs("button",{onClick:R,disabled:o,className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:"color-mix(in srgb, #10B981 15%, transparent)",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)",color:"color-mix(in srgb, #10B981 80%, white)"},children:[e.jsx(p,{Icon:d.Settings,size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Filtres avancés"}),e.jsx(p,{Icon:b?d.ChevronUp:d.ChevronDown,size:16})]})]}),e.jsx(de,{children:b&&e.jsxs(F,{...!v&&{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3}},className:"space-y-4 overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"search-filter",className:"block text-sm font-medium text-white/80 mb-2",children:"Recherche rapide"}),e.jsx("input",{id:"search-filter",type:"text",placeholder:"Rechercher une recette...",value:t,onChange:y=>r(y.target.value),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:o})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white/80",children:"Temps de préparation max (min)"}),e.jsx("input",{type:"number",placeholder:"Ex: 30",value:l||"",onChange:y=>c?.(y.target.value?parseInt(y.target.value):void 0),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:o,min:"1",max:"180"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white/80",children:"Temps de cuisson max (min)"}),e.jsx("input",{type:"number",placeholder:"Ex: 45",value:x||"",onChange:y=>g?.(y.target.value?parseInt(y.target.value):void 0),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:o,min:"1",max:"300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white/80",children:"Portions minimum"}),e.jsx("input",{type:"number",placeholder:"Ex: 2",value:m||"",onChange:y=>u?.(y.target.value?parseInt(y.target.value):void 0),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:o,min:"1",max:"12"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-white/80",children:"Tags diététiques"}),S&&e.jsx("button",{onClick:h,className:"text-xs text-green-400 hover:text-green-300 transition-colors",disabled:o,children:"Effacer tout"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(y=>{const A=s.includes(y);return e.jsx(I,{onClick:()=>D(y),disabled:o,className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${A?"bg-green-500 text-white shadow-lg":"bg-white/10 text-white/70 hover:bg-white/20"} disabled:opacity-50 disabled:cursor-not-allowed`,...!v&&{whileHover:o?{}:{scale:1.05},whileTap:o?{}:{scale:.95}},children:y},y)})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-white/60 mt-6 pt-2 border-t border-white/10",children:[e.jsx("span",{children:o?"Génération en cours...":`${n} recette${n>1?"s":""} ${n!==i?`sur ${i}`:""}`}),S&&!o&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Filter,size:14,className:"text-green-400"}),e.jsx("span",{className:"text-green-400",children:"Filtres actifs"})]})]})]})},Or=()=>{const{isPerformanceMode:t}=q(),r=t?"div":k.div;return e.jsxs(r,{...!t&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5}},className:"mb-6",children:[e.jsx(E,{className:"p-8 text-center relative overflow-hidden",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #34D399 8%, transparent) 0%, transparent 50%),
            linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.05)),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
            0 20px 60px rgba(0, 0, 0, 0.3),
            0 0 40px color-mix(in srgb, #10B981 20%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(24px) saturate(150%)",WebkitBackdropFilter:"blur(24px) saturate(150%)"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"rounded-full flex items-center justify-center",style:{width:"96px",height:"96px",background:`
                  radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.25) 0%, transparent 60%),
                  linear-gradient(135deg,
                    color-mix(in srgb, #10B981 40%, transparent),
                    color-mix(in srgb, #34D399 35%, transparent)
                  )
                `,border:"3px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:t?"none":`
                  0 0 30px color-mix(in srgb, #10B981 50%, transparent),
                  0 0 60px color-mix(in srgb, #34D399 30%, transparent),
                  inset 0 2px 0 rgba(255, 255, 255, 0.3)
                `},children:e.jsx(p,{Icon:d.ChefHat,size:56,color:"#fff",variant:"pure"})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-3xl font-bold text-white",style:{textShadow:t?"none":"0 0 25px color-mix(in srgb, #10B981 60%, transparent)"},children:"Génération de Recettes en Cours"}),e.jsx("p",{className:"text-white/90 text-lg",children:"La Forge Spatiale compose vos recettes personnalisées"})]}),e.jsx("div",{className:"flex justify-center gap-3",children:[0,1,2].map(s=>e.jsx(r,{className:"rounded-full",style:{width:"12px",height:"12px",background:"linear-gradient(135deg, #10B981, #34D399)",boxShadow:t?"none":"0 0 12px color-mix(in srgb, #10B981 60%, transparent)"},...!t&&{animate:{scale:[1,1.4,1],opacity:[.6,1,.6]},transition:{duration:1.2,repeat:1/0,delay:s*.15,ease:"easeInOut"}}},s))}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm",style:{color:"#D1FAE5"},children:[e.jsx(p,{Icon:d.Sparkles,size:16,color:"#10B981",variant:"pure"}),e.jsx("span",{children:"Analyse des ingrédients et génération des instructions..."})]}),e.jsx("div",{className:"w-full max-w-md mx-auto h-3 rounded-full relative overflow-hidden",style:{background:"rgba(16, 185, 129, 0.15)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.2)"},children:e.jsx(r,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #10B981, #34D399, #6EE7B7)",boxShadow:t?"none":"0 0 15px color-mix(in srgb, #10B981 60%, transparent)"},...!t&&{animate:{width:["30%","70%","30%"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"}}})})]}),!t&&e.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[...Array(6)].map((s,a)=>e.jsx("div",{className:"absolute w-1 h-1 rounded-full recipe-gen-particle",style:{background:"#10B981",left:`${20+a*12}%`,top:`${30+a%3*20}%`,animationDelay:`${a*.3}s`,boxShadow:"0 0 8px color-mix(in srgb, #10B981 80%, transparent)"}},a))})]})}),e.jsx("style",{children:`
        @keyframes recipe-gen-particle {
          0%, 100% {
            transform: translateY(0) scale(1);
            opacity: 0.4;
          }
          25% {
            transform: translateY(-10px) scale(1.3);
            opacity: 0.8;
          }
          50% {
            transform: translateY(-5px) scale(0.9);
            opacity: 0.6;
          }
          75% {
            transform: translateY(-15px) scale(1.2);
            opacity: 0.9;
          }
        }

        .recipe-gen-particle {
          animation: recipe-gen-particle 3s ease-in-out infinite;
        }

        @media (prefers-reduced-motion: reduce) {
          .recipe-gen-particle {
            animation: none !important;
          }
        }
      `})]})},Ur=({selectedInventoryId:t,availableInventories:r,hasSelectedInventory:s,onGenerateRecipes:a})=>{const n=ne(),{startScan:i}=ye(),o=()=>{i(),n("/fridge/scan")},l=s?"Générer vos premières recettes":"Votre bibliothèque de recettes est vide",c=s?"Vous avez un inventaire sélectionné. Générez des recettes personnalisées basées sur vos ingrédients disponibles.":"Commencez par scanner votre frigo pour générer des recettes personnalisées",x=s?"Générer mes recettes":"Scanner mon frigo pour générer des recettes",g=s?a:o;return e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 py-1",children:e.jsx(E,{className:"p-8",style:{background:`radial-gradient(ellipse at center,
            rgba(16, 185, 129, 0.15) 0%,
            rgba(52, 211, 153, 0.08) 50%,
            rgba(0, 0, 0, 0.4) 100%)`,borderColor:"rgba(16, 185, 129, 0.3)",boxShadow:`
            0 0 30px rgba(16, 185, 129, 0.2),
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1)
          `,backdropFilter:"blur(20px) saturate(1.2)"},children:e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                rgba(16, 185, 129, 0.3) 0%,
                rgba(52, 211, 153, 0.15) 70%,
                transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                0 0 25px rgba(16, 185, 129, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(p,{Icon:s?d.Sparkles:d.ChefHat,size:48,className:"text-green-400",style:{filter:`drop-shadow(0 0 12px rgba(16, 185, 129, 0.8))
                         drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3))`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:l}),e.jsx("p",{className:"text-white/70 text-lg",children:c})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(16, 185, 129, 0.3) 0%,
                    rgba(52, 211, 153, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                    0 0 20px rgba(16, 185, 129, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(p,{Icon:s?d.Sparkles:d.Camera,size:24,className:"text-green-400",style:{filter:`drop-shadow(0 0 8px rgba(16, 185, 129, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:s?"Génération par la Forge":"Scanner intelligent"}),e.jsx("p",{className:"text-white/60 text-sm",children:s?"Recettes créées par la Forge basées sur vos ingrédients":"Analysez automatiquement vos ingrédients disponibles"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(16, 185, 129, 0.3) 0%,
                    rgba(52, 211, 153, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                    0 0 20px rgba(16, 185, 129, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(p,{Icon:d.Sparkles,size:24,className:"text-green-400",style:{filter:`drop-shadow(0 0 8px rgba(16, 185, 129, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Forge personnalisée"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Recettes adaptées à vos goûts et contraintes alimentaires"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(16, 185, 129, 0.3) 0%,
                    rgba(52, 211, 153, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                    0 0 20px rgba(16, 185, 129, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(p,{Icon:d.Clock,size:24,className:"text-green-400",style:{filter:`drop-shadow(0 0 8px rgba(16, 185, 129, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Zéro gaspillage"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Utilisez tous vos ingrédients avant qu'ils ne périment"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:g,className:"group relative px-8 py-4 text-white font-semibold rounded-2xl transform hover:scale-105 transition-all duration-300",style:{background:`linear-gradient(135deg,
                  rgba(16, 185, 129, 0.8) 0%,
                  rgba(52, 211, 153, 0.9) 100%)`,border:"2px solid rgba(16, 185, 129, 0.6)",boxShadow:`
                  0 0 30px rgba(16, 185, 129, 0.4),
                  0 8px 25px rgba(0, 0, 0, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(10px) saturate(1.2)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{Icon:s?d.Sparkles:d.Camera,size:24,className:"group-hover:rotate-12 transition-transform duration-300",style:{color:"white",filter:`drop-shadow(0 0 10px rgba(16, 185, 129, 0.8))
                             drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3))`}}),e.jsx("span",{className:"text-lg",children:x})]}),e.jsx("div",{className:"absolute inset-0 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300 -z-10",style:{background:`linear-gradient(135deg,
                    rgba(16, 185, 129, 0.6) 0%,
                    rgba(52, 211, 153, 0.6) 100%)`}})]})}),e.jsx("div",{className:"text-white/50 text-sm p-3 rounded-xl",style:{background:`radial-gradient(ellipse at center,
                rgba(16, 185, 129, 0.1) 0%,
                transparent 70%)`,border:"1px solid rgba(16, 185, 129, 0.2)",boxShadow:"0 0 15px rgba(16, 185, 129, 0.1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(p,{Icon:d.Lightbulb,size:16,className:"text-green-400",style:{filter:"drop-shadow(0 0 6px rgba(16, 185, 129, 0.6))"}}),e.jsx("span",{children:s?"Astuce : Vos recettes seront sauvegardées dans votre bibliothèque personnelle !":"Astuce : Plus votre frigo est rempli, plus vous aurez de recettes créatives !"})]})})]})})})},Hr=({newlyGeneratedRecipes:t,onSaveAllNewRecipes:r,onDiscardNewRecipes:s,isGenerating:a})=>{const[n,i]=j.useState(!1),{click:o}=K(),{isPerformanceMode:l}=q(),c=l?"div":k.div,x=j.useMemo(()=>{if(t.length===0)return 0;const u=t.reduce((b,w)=>{const v=w.prepTimeMin||0,F=w.cookTimeMin||0;return b+v+F},0);return Math.round(u/t.length)},[t]),g=async()=>{i(!0),o();try{await r()}finally{i(!1)}},m=()=>{o(),s()};return a?e.jsx(c,{...!l&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0}},className:"mb-6",children:e.jsx(E,{className:"p-6 border-2 border-pink-400/30",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-6 w-48 bg-white/20 rounded animate-pulse"})]}),e.jsx("div",{className:"w-16 h-6 bg-white/20 rounded animate-pulse"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:[1,2,3].map(u=>e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"h-8 w-12 bg-white/20 rounded mx-auto animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-white/20 rounded mx-auto animate-pulse"})]},u))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 h-12 bg-white/20 rounded-xl animate-pulse"}),e.jsx("div",{className:"w-full sm:w-auto h-12 bg-white/20 rounded-xl animate-pulse"})]}),e.jsxs("div",{className:"bg-pink-500/10 rounded-lg p-4 space-y-2",children:[e.jsx("div",{className:"h-4 w-3/4 bg-white/20 rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-1/2 bg-white/20 rounded animate-pulse"})]})]})})}):t.length===0?null:e.jsx(c,{...!l&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0}},className:"mb-6",children:e.jsx(E,{className:"p-6 border-2 border-pink-400/30",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{Icon:d.ChefHat,size:32,className:"text-pink-400"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white",children:[t.length," Nouvelles Recettes Générées !"]}),e.jsx("p",{className:"text-sm text-white/70",children:"Vos recettes personnalisées sont prêtes"})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm text-pink-400 font-medium",children:"Prêt !"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t.length}),e.jsx("div",{className:"text-sm text-white/70",children:"Recettes"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:x}),e.jsx("div",{className:"text-sm text-white/70",children:"Min moy."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:Math.round(t.reduce((u,b)=>u+(b.servings||1),0)/t.length)}),e.jsx("div",{className:"text-sm text-white/70",children:"Portions"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:g,disabled:n,className:"flex-1 bg-gradient-to-r from-green-500/20 to-green-600/20 hover:from-green-500/30 hover:to-green-600/30 border-2 border-green-400/30 rounded-xl px-6 py-3 text-white font-semibold transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Sauvegarde..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{Icon:d.Save,size:20}),e.jsx("span",{children:"Sauvegarder Toutes"})]})}),e.jsxs("button",{onClick:m,disabled:n,className:"bg-red-500/20 hover:bg-red-500/30 border border-red-400/30 rounded-xl px-4 py-3 text-white font-medium transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(p,{Icon:d.Trash2,size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Supprimer"})]})]}),e.jsx("div",{className:"bg-pink-500/10 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-white/80",children:[e.jsx("p",{className:"font-medium mb-1",children:"💡 Conseil :"}),e.jsx("p",{children:"Sauvegardez vos recettes préférées pour les retrouver facilement et créer vos listes de courses personnalisées."})]})})]})})})},Vr=({onExportAllRecipes:t,onDeleteAllRecipes:r,recipesCount:s})=>{const{click:a}=K();return s===0?null:e.jsxs(k.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex items-center justify-end gap-3 mb-6",children:[e.jsxs(k.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{a(),t()},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
            0 4px 16px color-mix(in srgb, #10B981 15%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(180%)",color:"#10B981"},title:"Exporter toutes les recettes",children:[e.jsx(p,{Icon:d.Download,size:18,className:"text-green-400"}),e.jsx("span",{className:"text-sm",children:"Exporter"}),e.jsxs("span",{className:"text-xs opacity-70",children:["(",s,")"]})]}),e.jsxs(k.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{a(),r()},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200",style:{background:"linear-gradient(135deg, color-mix(in srgb, #EF4444 20%, transparent), color-mix(in srgb, #EF4444 10%, transparent))",border:"1px solid color-mix(in srgb, #EF4444 30%, transparent)",boxShadow:`
            0 4px 16px color-mix(in srgb, #EF4444 15%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(180%)",color:"#EF4444"},title:"Supprimer toutes les recettes",children:[e.jsx(p,{Icon:d.Trash2,size:18,className:"text-red-400"}),e.jsx("span",{className:"text-sm",children:"Supprimer"}),e.jsxs("span",{className:"text-xs opacity-70",children:["(",s,")"]})]})]})},Wr=({userId:t,profile:r,userEditedInventory:s,recipeCandidates:a,clearRecipeCandidates:n,showToast:i,click:o,success:l})=>{const[c,x]=j.useState([]),[g,m]=j.useState(!0),u=j.useMemo(()=>a.filter(h=>!c.some(S=>S.id===h.id)),[a,c]),b=j.useMemo(()=>{const h=new Set(c.map(R=>R.id));return[...a.filter(R=>!h.has(R.id)),...c]},[c,a]),w=async()=>{if(t)try{m(!0),N.info("GENERATED_RECIPES_TAB","Fetching persisted recipes from database",{userId:t,timestamp:new Date().toISOString()});const{data:h,error:S}=await W.from("recipes").select(`
          id,
          session_id,
          title,
          description,
          ingredients,
          instructions,
          prep_time_min,
          cook_time_min,
          servings,
          dietary_tags,
          nutritional_info,
          image_url,
          image_signature,
          reasons,
          created_at,
          updated_at,
          recipe_sessions!inner(user_id)
        `).eq("recipe_sessions.user_id",t).order("created_at",{ascending:!1});if(S)throw new Error(`Failed to fetch recipes: ${S.message}`);const R=(h||[]).map(y=>({id:y.id,sessionId:y.session_id,title:y.title,description:y.description,ingredients:y.ingredients||[],instructions:y.instructions||[],prepTimeMin:y.prep_time_min||0,cookTimeMin:y.cook_time_min||0,servings:y.servings||2,dietaryTags:y.dietary_tags||[],nutritionalInfo:y.nutritional_info||{},imageUrl:y.image_url,imageSignature:y.image_signature,reasons:y.reasons||[],createdAt:y.created_at,updatedAt:y.updated_at,status:"ready"}));x(R),N.info("GENERATED_RECIPES_TAB","Successfully fetched persisted recipes",{userId:t,recipesCount:R.length,timestamp:new Date().toISOString()})}catch(h){N.error("GENERATED_RECIPES_TAB","Failed to fetch persisted recipes",{userId:t,error:h instanceof Error?h.message:"Unknown error",timestamp:new Date().toISOString()}),i({type:"error",title:"Erreur de chargement",message:"Impossible de charger vos recettes sauvegardées.",duration:4e3})}finally{m(!1)}},v=async h=>{if(!t){i({type:"error",title:"Erreur d'authentification",message:"Vous devez être connecté pour sauvegarder des recettes.",duration:4e3});return}try{N.info("GENERATED_RECIPES_TAB","Saving recipe to database",{userId:t,recipeId:h.id,recipeTitle:h.title,timestamp:new Date().toISOString()});let S=h.sessionId;S||(S=crypto.randomUUID());const R={nutrition:r?.nutrition||{},householdDetails:r?.householdDetails||{},mealPrepPreferences:r?.mealPrepPreferences||{},kitchenEquipment:r?.kitchenEquipment||{},foodPreferences:r?.foodPreferences||{},sensoryPreferences:r?.sensoryPreferences||{},macroTargets:r?.macroTargets||{},shoppingPreferences:r?.shoppingPreferences||{}},{error:y}=await W.from("recipe_sessions").upsert({id:S,user_id:t,inventory_final:s||[],selected_recipe_ids:[h.id],preferences_snapshot:R,filters_snapshot:{},status:"completed",created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(y)throw new Error(`Failed to create session: ${y.message}`);const{error:A}=await W.from("recipes").upsert({id:h.id,session_id:S,title:h.title,description:h.description,ingredients:h.ingredients,instructions:h.instructions,prep_time_min:h.prepTimeMin,cook_time_min:h.cookTimeMin,servings:h.servings,dietary_tags:h.dietaryTags,nutritional_info:h.nutritionalInfo,...h.imageUrl&&{image_url:h.imageUrl},image_signature:h.imageSignature,reasons:h.reasons,created_at:h.createdAt||new Date().toISOString(),updated_at:new Date().toISOString()});if(A)throw new Error(`Failed to save recipe: ${A.message}`);const Y={...h,sessionId:S};x(J=>J.find(B=>B.id===h.id)?J.map(B=>B.id===h.id?Y:B):[Y,...J]),i({type:"success",title:"Recette sauvegardée",message:`"${h.title}" a été ajoutée à votre bibliothèque.`,duration:3e3}),N.info("GENERATED_RECIPES_TAB","Recipe saved successfully",{userId:t,recipeId:h.id,sessionId:S,timestamp:new Date().toISOString()})}catch(S){N.error("GENERATED_RECIPES_TAB","Failed to save recipe",{userId:t,recipeId:h.id,error:S instanceof Error?S.message:"Unknown error",timestamp:new Date().toISOString()}),i({type:"error",title:"Erreur de sauvegarde",message:"Impossible de sauvegarder la recette. Veuillez réessayer.",duration:4e3})}},F=async h=>{if(t)try{N.info("GENERATED_RECIPES_TAB","Deleting recipe from database",{userId:t,recipeId:h,timestamp:new Date().toISOString()});const{error:S}=await W.from("recipes").delete().eq("id",h);if(S)throw new Error(`Failed to delete recipe: ${S.message}`);x(y=>y.filter(A=>A.id!==h));const R=c.find(y=>y.id===h);i({type:"success",title:"Recette supprimée",message:`"${R?.title||"La recette"}" a été supprimée de votre bibliothèque.`,duration:3e3}),N.info("GENERATED_RECIPES_TAB","Recipe deleted successfully",{userId:t,recipeId:h,timestamp:new Date().toISOString()})}catch(S){N.error("GENERATED_RECIPES_TAB","Failed to delete recipe",{userId:t,recipeId:h,error:S instanceof Error?S.message:"Unknown error",timestamp:new Date().toISOString()}),i({type:"error",title:"Erreur de suppression",message:"Impossible de supprimer la recette. Veuillez réessayer.",duration:4e3})}},I=async h=>{o(),c.some(R=>R.id===h.id)?(await F(h.id),N.debug("GENERATED_RECIPES_TAB","Recipe removed from library",{recipeId:h.id,recipeTitle:h.title,timestamp:new Date().toISOString()})):(await v(h),N.debug("GENERATED_RECIPES_TAB","Recipe added to library",{recipeId:h.id,recipeTitle:h.title,timestamp:new Date().toISOString()}))},P=async()=>{try{for(const h of u)await v(h);l(),i({type:"success",title:"Recettes sauvegardées !",message:`${u.length} recettes ont été ajoutées à votre collection`,duration:4e3})}catch{i({type:"error",title:"Erreur de sauvegarde",message:"Impossible de sauvegarder toutes les recettes",duration:4e3})}},D=()=>{n(),i({type:"info",title:"Recettes supprimées",message:`${u.length} nouvelles recettes ont été supprimées`,duration:3e3})};return j.useEffect(()=>{t&&w()},[t]),{persistedRecipes:c,loadingPersistedRecipes:g,newlyGeneratedRecipes:u,allRecipes:b,fetchPersistedRecipes:w,saveRecipeToDb:v,deleteRecipeFromDb:F,handleToggleSaveStatus:I,handleSaveAllNewRecipes:P,handleDiscardNewRecipes:D}},Yr=({allRecipes:t})=>{const[r,s]=j.useState(""),[a,n]=j.useState([]),[i,o]=j.useState(void 0),[l,c]=j.useState(void 0),[x,g]=j.useState(void 0),[m,u]=j.useState(8),[b,w]=j.useState(8);j.useEffect(()=>{const h=()=>{const R=window.innerWidth<=768?8:9;w(R),u(R)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]);const v=j.useMemo(()=>t.filter(h=>{const S=h.title.toLowerCase().includes(r.toLowerCase())||h.description?.toLowerCase().includes(r.toLowerCase()),R=a.length===0||a.some(J=>h.dietaryTags?.includes(J)||h.reasons?.includes(J)),y=i===void 0||h.prepTimeMin&&h.prepTimeMin<=i,A=l===void 0||h.cookTimeMin&&h.cookTimeMin<=l,Y=x===void 0||h.servings&&h.servings>=x;return S&&R&&y&&A&&Y}),[t,r,a,i,l,x]),F=j.useMemo(()=>v.slice(0,m),[v,m]),I=v.length>m;return{searchFilter:r,setSearchFilter:s,selectedFilters:a,setSelectedFilters:n,maxPrepTime:i,setMaxPrepTime:o,maxCookTime:l,setMaxCookTime:c,minServings:x,setMinServings:g,itemsPerPage:m,initialItemsPerPage:b,filteredRecipes:v,displayedRecipes:F,hasMoreRecipes:I,handleLoadMore:()=>{u(h=>h+b)},clearAllFilters:()=>{s(""),n([]),o(void 0),c(void 0),g(void 0),u(b)}}},Jr=({allRecipes:t,userId:r,showToast:s,click:a})=>{const n=o=>{let l=`# ${o.title}

`;return o.description&&(l+=`${o.description}

`),l+=`**Temps de préparation:** ${o.prepTimeMin||0} min
`,l+=`**Temps de cuisson:** ${o.cookTimeMin||0} min
`,l+=`**Portions:** ${o.servings||2}

`,o.ingredients&&o.ingredients.length>0&&(l+=`## Ingrédients
`,o.ingredients.forEach(c=>{l+=`- ${c}
`}),l+=`
`),o.instructions&&o.instructions.length>0&&(l+=`## Instructions
`,o.instructions.forEach((c,x)=>{l+=`${x+1}. ${c}
`}),l+=`
`),o.dietaryTags&&o.dietaryTags.length>0&&(l+=`**Tags:** ${o.dietaryTags.join(", ")}

`),l+=`---

`,l};return{handleExportAllRecipes:async()=>{try{if(a(),t.length===0){s({type:"warning",title:"Aucune recette à exporter",message:"Générez d'abord des recettes pour pouvoir les exporter.",duration:3e3});return}N.info("GENERATED_RECIPES_TAB","Exporting all recipes",{userId:r,recipesCount:t.length,timestamp:new Date().toISOString()});let o=`# Mes Recettes Générées

`;o+=`Exporté le ${new Date().toLocaleDateString("fr-FR")} à ${new Date().toLocaleTimeString("fr-FR")}

`,o+=`Total: ${t.length} recette${t.length>1?"s":""}

`,o+="=".repeat(50)+`

`,t.forEach((l,c)=>{o+=n(l)}),await navigator.clipboard.writeText(o),s({type:"success",title:"Recettes exportées !",message:`${t.length} recette${t.length>1?"s ont été copiées":" a été copiée"} dans le presse-papiers.`,duration:4e3}),N.info("GENERATED_RECIPES_TAB","Recipes exported successfully",{userId:r,recipesCount:t.length,timestamp:new Date().toISOString()})}catch(o){N.error("GENERATED_RECIPES_TAB","Failed to export recipes",{userId:r,error:o instanceof Error?o.message:"Unknown error",timestamp:new Date().toISOString()}),s({type:"error",title:"Erreur d'exportation",message:"Impossible d'exporter les recettes. Veuillez réessayer.",duration:4e3})}},formatRecipeForExport:n}},Qr=({allRecipes:t,persistedRecipes:r,newlyGeneratedRecipes:s,userId:a,showToast:n,click:i,clearRecipeCandidates:o,deleteRecipeFromDb:l})=>({handleDeleteAllRecipes:async()=>{try{if(i(),t.length===0){n({type:"warning",title:"Aucune recette à supprimer",message:"Il n'y a aucune recette à supprimer.",duration:3e3});return}N.info("GENERATED_RECIPES_TAB","Deleting all recipes",{userId:a,totalRecipes:t.length,persistedRecipes:r.length,newRecipes:s.length,timestamp:new Date().toISOString()}),o();const x=r.map(g=>l(g.id));await Promise.all(x),n({type:"success",title:"Recettes supprimées !",message:`${t.length} recette${t.length>1?"s ont été supprimées":" a été supprimée"} de votre collection.`,duration:4e3}),N.info("GENERATED_RECIPES_TAB","All recipes deleted successfully",{userId:a,deletedCount:t.length,timestamp:new Date().toISOString()})}catch(x){N.error("GENERATED_RECIPES_TAB","Failed to delete all recipes",{userId:a,error:x instanceof Error?x.message:"Unknown error",timestamp:new Date().toISOString()}),n({type:"error",title:"Erreur de suppression",message:"Impossible de supprimer toutes les recettes. Veuillez réessayer.",duration:4e3})}}}),$s=()=>{ne();const[t,r]=j.useState(!1),[s,a]=j.useState(null),{click:n,success:i}=K(),{showToast:o}=_e(),{recipeCandidates:l,loadingState:c,userEditedInventory:x,generateRecipes:g,clearRecipeCandidates:m,startScan:u}=ye(),{session:b,profile:w}=ve(),v=b?.user?.id,{availableInventories:F,selectedInventoryId:I,selectInventory:P,loadAvailableInventories:D}=Ce(),{persistedRecipes:h,loadingPersistedRecipes:S,newlyGeneratedRecipes:R,allRecipes:y,handleToggleSaveStatus:A,handleSaveAllNewRecipes:Y,handleDiscardNewRecipes:J,deleteRecipeFromDb:Z}=Wr({userId:v,profile:w,userEditedInventory:x,recipeCandidates:l,clearRecipeCandidates:m,showToast:o,click:n,success:i}),{searchFilter:B,setSearchFilter:ge,selectedFilters:C,setSelectedFilters:M,maxPrepTime:U,setMaxPrepTime:L,maxCookTime:z,setMaxCookTime:X,minServings:ee,setMinServings:te,filteredRecipes:ie,displayedRecipes:G,hasMoreRecipes:ke,handleLoadMore:He}=Yr({allRecipes:y}),{handleExportAllRecipes:Ve}=Jr({allRecipes:y,userId:v,showToast:o,click:n}),{handleDeleteAllRecipes:We}=Qr({allRecipes:y,persistedRecipes:h,newlyGeneratedRecipes:R,userId:v,showToast:o,click:n,clearRecipeCandidates:m,deleteRecipeFromDb:Z});ce.useEffect(()=>{v&&D()},[v,D]);const Ye=ce.useMemo(()=>{if(!I)return!1;const _=F.find(O=>O.id===I);return _&&_.inventory_final&&_.inventory_final.length>0},[I,F]),Je=_=>{if(n(),!_){o({type:"error",title:"Erreur",message:"Les données de la recette sont manquantes",duration:3e3});return}if(!_.title){o({type:"error",title:"Recette incomplète",message:"Cette recette ne contient pas assez d'informations pour être affichée",duration:3e3});return}a(_),r(!0)},Qe=()=>{r(!1),a(null)},f=c==="generating"||c==="streaming",V=y.length>0,H=S||f;return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[V&&!H&&e.jsx(qr,{availableInventories:F,selectedInventoryId:I,onSelectInventory:P,onGenerateRecipes:()=>{const _=F.find(O=>O.id===I);_&&_.inventory_final.length>0?g():o({type:"warning",title:"Aucun inventaire sélectionné",message:"Veuillez sélectionner un inventaire avec des ingrédients pour générer des recettes.",duration:3e3})},isGenerating:f}),f&&!S&&e.jsx(Or,{}),R.length>0&&e.jsx(Hr,{newlyGeneratedRecipes:R,onSaveAllNewRecipes:Y,onDiscardNewRecipes:J,isGenerating:f}),!f&&V&&!H&&e.jsxs(e.Fragment,{children:[e.jsx(Gr,{searchFilter:B,setSearchFilter:ge,selectedFilters:C,setSelectedFilters:M,recipesCount:ie.length,totalRecipesCount:y.length,isGenerating:f,maxPrepTime:U,setMaxPrepTime:L,maxCookTime:z,setMaxCookTime:X,minServings:ee,setMinServings:te}),e.jsx(Vr,{onExportAllRecipes:Ve,onDeleteAllRecipes:We,recipesCount:y.length})]}),!V&&!H?e.jsx(Ur,{selectedInventoryId:I,availableInventories:F,hasSelectedInventory:Ye,onGenerateRecipes:()=>{const _=F.find(O=>O.id===I);_&&_.inventory_final.length>0?g():o({type:"warning",title:"Aucun inventaire sélectionné",message:"Veuillez sélectionner un inventaire avec des ingrédients pour générer des recettes.",duration:3e3})}}):e.jsxs("div",{className:"space-y-4",children:[S&&e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-8",children:e.jsx(E,{className:"p-8",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto",children:e.jsx(p,{Icon:d.Loader2,size:64,className:"animate-spin text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Chargement de votre bibliothèque..."}),e.jsx("p",{className:"text-white/70",children:"Récupération de vos recettes sauvegardées"})]})]})})}),!S&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(de,{children:G.map((_,O)=>{const Ke=h.some(Le=>Le.id===_.id),yt=l.some(Le=>Le.id===_.id)&&!Ke;return e.jsx($r,{recipe:_,index:O,isSaved:Ke,isNewlyGenerated:yt,isLoading:_.status==="loading"||_.isGeneratingImage,onToggleSaveStatus:()=>A(_),onView:Je},_.id)})})}),ke&&e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex justify-center",children:e.jsxs("button",{onClick:He,className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl text-white font-medium transition-all duration-200 hover:scale-105",children:["Charger plus de recettes (",ie.length-G.length," restantes)"]})})]}),V&&ie.length===0&&!H&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:e.jsx(E,{className:"p-8",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(p,{Icon:d.Search,size:48,className:"mx-auto text-white/50"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Aucune recette trouvée"}),e.jsx("p",{className:"text-white/70",children:"Essayez de modifier vos filtres ou votre recherche"})]})]})})})]}),t&&s&&e.jsx(vt,{recipe:s,onClose:Qe,onToggleSave:A,isSaved:h.some(_=>_.id===s.id)})]})},Pe=(t,r)=>{if(!t)return null;const s=t.mealName||t.title||"Recette non trouvée";let a=`  ${r}: ${s}`;if(t.detailedRecipe){if(t.detailedRecipe.ingredients&&t.detailedRecipe.ingredients.length>0&&(a+=`
    Ingrédients:`,t.detailedRecipe.ingredients.forEach(n=>{const i=typeof n=="string"?n:`${n.quantity||""} ${n.unit||""} ${n.name||n.ingredient||""}`.trim();a+=`
      • ${i}`})),t.detailedRecipe.instructions&&t.detailedRecipe.instructions.length>0&&(a+=`
    Instructions:`,t.detailedRecipe.instructions.forEach((n,i)=>{const o=typeof n=="string"?n:n.step||n.instruction||"";a+=`
      ${i+1}. ${o}`})),t.detailedRecipe.nutritional_info){const n=t.detailedRecipe.nutritional_info;a+=`
    Informations nutritionnelles:`,n.calories&&(a+=`
      • Calories: ${n.calories}`),n.protein&&(a+=`
      • Protéines: ${n.protein}g`),n.carbs&&(a+=`
      • Glucides: ${n.carbs}g`),n.fat&&(a+=`
      • Lipides: ${n.fat}g`)}}else a+=`
    (Détails de la recette non disponibles - générez d'abord la recette détaillée)`;return a},Kr=()=>{const{session:t,profile:r}=ve(),{currentPlan:s,currentWeek:a,availableInventories:n,selectedInventoryId:i,isGenerating:o,generationProgress:l,loadingMessage:c,currentLoadingTitle:x,currentLoadingSubtitle:g,recipes:m,availableWeeks:u,maxAvailableWeek:b,isWeekAvailable:w,isCurrentWeekActive:v,canGenerateNextWeek:F,getWeekDateRange:I,loadAvailableInventories:P,selectInventory:D,generateMealPlan:h,regenerateWeek:S,generateNextWeek:R,generateSpecificWeek:y,clearPlan:A,setCurrentWeek:Y}=Ce(),{click:J,success:Z}=K(),{showToast:B}=_e(),ge=Fe(r),C=ft(r,"planning"),[M,U]=j.useState(!1),[L,z]=j.useState(!1),[X,ee]=j.useState(null),te=t?.user?.id,ie=i&&n.length>0,G=n.find(f=>f.id===i),ke=j.useMemo(()=>{const f=I(a);return{formatted:f.formatted,startDate:f.startDate,endDate:f.endDate}},[a,I]);return j.useEffect(()=>{te&&P()},[te,P]),{currentPlan:s,currentWeek:a,availableInventories:n,selectedInventoryId:i,isGenerating:o,generationProgress:l,loadingMessage:c,currentLoadingTitle:x,currentLoadingSubtitle:g,recipes:m,availableWeeks:u,maxAvailableWeek:b,canGenerateNextWeek:F,profileCompletion:ge,featureGuidance:C,nudgeDismissed:M,showRecipeDetailModal:L,selectedRecipeForDetail:X,userId:te,hasInventory:ie,selectedInventory:G,weekDateRange:ke,getWeekDateRange:I,loadAvailableInventories:P,selectInventory:D,generateMealPlan:h,regenerateWeek:S,generateNextWeek:R,generateSpecificWeek:y,clearPlan:A,setCurrentWeek:Y,setNudgeDismissed:U,setShowRecipeDetailModal:z,setSelectedRecipeForDetail:ee,isWeekAvailable:f=>u.includes(f),handleGenerateMealPlan:async()=>{if(!i||!G){B({type:"warning",title:"Inventaire requis",message:"Sélectionnez un inventaire pour générer un plan de repas",duration:3e3});return}if(!r){B({type:"warning",title:"Profil incomplet",message:"Complétez votre profil nutritionnel pour un plan optimal",duration:3e3});return}try{N.info("PLAN_TAB","Starting meal plan generation",{userId:te,selectedInventoryId:i,inventoryItemsCount:G.inventory_final?.length||0,currentWeek:a,timestamp:new Date().toISOString()}),await h(a,G.inventory_final),Z(),B({type:"success",title:"Plan généré !",message:`Plan de repas créé pour la semaine ${a}`,duration:4e3})}catch(f){N.error("PLAN_TAB","Meal plan generation failed",{error:f instanceof Error?f.message:"Unknown error",userId:te,selectedInventoryId:i,currentWeek:a,timestamp:new Date().toISOString()}),B({type:"error",title:"Erreur de génération",message:"Impossible de générer le plan de repas",duration:4e3})}},handleRegenerateWeek:async()=>{if(console.log("handleRegenerateWeek called",{selectedInventoryId:i,selectedInventory:!!G,currentWeek:a,isGenerating:o,userId:te}),!(!i||!G)){if(o){console.warn("Cannot regenerate: generation already in progress"),B({type:"warning",title:"Génération en cours",message:"Attendez la fin de la génération actuelle",duration:3e3});return}if(!G.inventory_final||G.inventory_final.length===0){console.warn("Cannot regenerate: no inventory items",{inventoryFinal:G.inventory_final}),B({type:"warning",title:"Inventaire vide",message:"L'inventaire sélectionné ne contient aucun ingrédient",duration:3e3});return}try{console.log("Starting week regeneration",{currentWeek:a,inventoryItemsCount:G.inventory_final.length}),await S(G.inventory_final,a),console.log("Week regeneration successful"),Z(),B({type:"success",title:"Semaine régénérée !",message:`Nouveau plan créé pour la semaine ${a}`,duration:3e3})}catch(f){console.error("Week regeneration failed",{error:f instanceof Error?f.message:"Unknown error",currentWeek:a,selectedInventoryId:i}),B({type:"error",title:"Erreur de régénération",message:"Impossible de régénérer la semaine",duration:4e3})}}},handleGenerateNextWeek:async()=>{if(!(!i||!G))try{await R(G.inventory_final),Z(),B({type:"success",title:"Semaine suivante générée !",message:`Plan créé pour la semaine ${a+1}`,duration:3e3})}catch{B({type:"error",title:"Erreur de génération",message:"Impossible de générer la semaine suivante",duration:4e3})}},handleExportPlan:async()=>{if(s)try{J();const f=s.days.map(H=>{const _=[];if(H.meals.breakfast){const O=Pe(H.meals.breakfast,"Petit-déjeuner");O&&_.push(O)}if(H.meals.lunch){const O=Pe(H.meals.lunch,"Déjeuner");O&&_.push(O)}if(H.meals.dinner){const O=Pe(H.meals.dinner,"Dîner");O&&_.push(O)}if(H.meals.snack){const O=Pe(H.meals.snack,"Collation");O&&_.push(O)}return`${H.dayName}
${_.join(`
`)}`}).join(`

`),V=`Plan de Repas TwinForge - Semaine ${a}

${f}`;await navigator.clipboard.writeText(V),Z(),B({type:"success",title:"Plan exporté !",message:"Le plan de repas a été copié dans le presse-papiers",duration:3e3})}catch{B({type:"error",title:"Erreur d'export",message:"Impossible de copier le plan dans le presse-papiers",duration:3e3})}},handleViewRecipe:f=>{if(!f){B({type:"error",title:"Erreur",message:"Les données de la recette sont manquantes",duration:3e3});return}let V=null;if(f.detailedRecipe?V={...f.detailedRecipe,id:f.detailedRecipe.id||f.recipeId||crypto.randomUUID(),title:f.detailedRecipe.title||f.mealName||f.title||"Recette sans nom",description:f.detailedRecipe.description||f.descriptionSummary||f.description||"",imageUrl:f.imageUrl||f.detailedRecipe.imageUrl,instructions:f.detailedRecipe.instructions||[],ingredients:f.detailedRecipe.ingredients||[],nutritionalInfo:f.detailedRecipe.nutritionalInfo?{calories:f.detailedRecipe.nutritionalInfo.kcal||f.detailedRecipe.nutritionalInfo.calories||0,kcal:f.detailedRecipe.nutritionalInfo.kcal||f.detailedRecipe.nutritionalInfo.calories||0,protein:f.detailedRecipe.nutritionalInfo.protein||0,carbs:f.detailedRecipe.nutritionalInfo.carbs||0,fat:f.detailedRecipe.nutritionalInfo.fat||0,fiber:f.detailedRecipe.nutritionalInfo.fiber||0}:{calories:f.calories_est||f.estimatedCalories||0,kcal:f.calories_est||f.estimatedCalories||0,protein:0,carbs:0,fat:0,fiber:0},prepTimeMin:f.detailedRecipe.prepTimeMin||f.estimatedPrepTime||f.prep_time_min||0,cookTimeMin:f.detailedRecipe.cookTimeMin||f.estimatedCookTime||f.cook_time_min||0,servings:f.detailedRecipe.servings||f.servings||2,dietaryTags:f.detailedRecipe.dietaryTags||f.dietaryTags||[],difficulty:f.detailedRecipe.difficulty||"moyen",tips:f.detailedRecipe.tips||[],variations:f.detailedRecipe.variations||[],createdAt:f.updatedAt||new Date().toISOString()}:V={id:f.recipeId||crypto.randomUUID(),title:f.mealName||f.title||"Recette sans nom",description:f.descriptionSummary||f.description||"",ingredients:(f.mainIngredients||f.ingredients||[]).map(H=>typeof H=="string"?{name:H,quantity:"",unit:""}:H),instructions:f.instructions||[],prepTimeMin:f.estimatedPrepTime||f.prep_time_min||0,cookTimeMin:f.estimatedCookTime||f.cook_time_min||0,servings:f.servings||2,nutritionalInfo:{calories:f.calories_est||f.estimatedCalories||0,kcal:f.calories_est||f.estimatedCalories||0,protein:0,carbs:0,fat:0,fiber:0},dietaryTags:f.dietaryTags||[],imageUrl:f.imageUrl,createdAt:f.updatedAt||new Date().toISOString()},!V.title&&!V.ingredients&&!V.instructions){B({type:"error",title:"Recette incomplète",message:"Cette recette ne contient pas assez d'informations pour être affichée",duration:3e3});return}ee(V),z(!0)},handleGenerateAllRecipes:async()=>{if(s)try{for(let f=0;f<s.days.length;f++){const V=s.days[f];V&&V.date&&await Ze(f)}Z(),B({type:"success",title:"Toutes les recettes générées !",message:"Les recettes détaillées sont maintenant disponibles",duration:4e3})}catch{B({type:"error",title:"Erreur de génération",message:"Impossible de générer toutes les recettes",duration:4e3})}},generateDetailedRecipeForMeal:kt,generateAllDetailedRecipesForDay:Ze}},Zr=({nutritionalSummary:t,estimatedWeeklyCost:r})=>{const{isPerformanceMode:s}=q();return t?e.jsxs(E,{className:"p-6",style:s?{background:"linear-gradient(145deg, #1e3a2f, #0f1f1a)",borderColor:"color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.4)"}:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:s?{background:"color-mix(in srgb, #10B981 25%, #1e293b)",border:"2px solid color-mix(in srgb, #10B981 50%, transparent)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"}:{background:"color-mix(in srgb, #10B981 15%, transparent)",border:"2px solid color-mix(in srgb, #10B981 25%, transparent)"},children:e.jsx(p,{Icon:d.BarChart3,size:16,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-green-300 font-semibold text-lg",children:"Résumé Nutritionnel"}),e.jsx("p",{className:"text-green-200 text-sm",children:"Moyennes quotidiennes calculées"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl border",style:s?{background:"color-mix(in srgb, #f97316 20%, #1e293b)",borderColor:"color-mix(in srgb, #f97316 40%, transparent)"}:{background:"rgba(249, 115, 22, 0.1)",borderColor:"rgba(251, 146, 60, 0.2)"},children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:t.avgCaloriesPerDay}),e.jsx("div",{className:"text-orange-300 text-sm font-medium",children:"kcal/jour"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl border",style:s?{background:"color-mix(in srgb, #ef4444 20%, #1e293b)",borderColor:"color-mix(in srgb, #ef4444 40%, transparent)"}:{background:"rgba(239, 68, 68, 0.1)",borderColor:"rgba(248, 113, 113, 0.2)"},children:[e.jsxs("div",{className:"text-2xl font-bold text-red-400 mb-1",children:[t.avgProteinPerDay,"g"]}),e.jsx("div",{className:"text-red-300 text-sm font-medium",children:"Protéines"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl border",style:s?{background:"color-mix(in srgb, #3b82f6 20%, #1e293b)",borderColor:"color-mix(in srgb, #3b82f6 40%, transparent)"}:{background:"rgba(59, 130, 246, 0.1)",borderColor:"rgba(96, 165, 250, 0.2)"},children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:[t.avgCarbsPerDay,"g"]}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Glucides"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl border",style:s?{background:"color-mix(in srgb, #a855f7 20%, #1e293b)",borderColor:"color-mix(in srgb, #a855f7 40%, transparent)"}:{background:"rgba(168, 85, 247, 0.1)",borderColor:"rgba(192, 132, 252, 0.2)"},children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:[t.avgFatPerDay,"g"]}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Lipides"})]})]}),r&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl border text-center",style:s?{background:"color-mix(in srgb, #10B981 20%, #1e293b)",borderColor:"color-mix(in srgb, #10B981 40%, transparent)"}:{background:"rgba(16, 185, 129, 0.1)",borderColor:"rgba(52, 211, 153, 0.2)"},children:[e.jsxs("div",{className:"text-xl font-bold text-green-400 mb-1",children:[r.toFixed(2),"€"]}),e.jsx("div",{className:"text-green-300 text-sm",children:"Coût estimé par semaine"})]})]}):null},Xr=({currentPlan:t,selectedInventoryId:r,availableInventories:s,selectInventory:a,isGenerating:n,currentWeek:i,availableWeeks:o,maxAvailableWeek:l,canGenerateNextWeek:c,setCurrentWeek:x,getWeekDateRange:g,handleGenerateMealPlan:m,isWeekAvailable:u,weekDateRange:b})=>{const{click:w}=K(),{isPerformanceMode:v}=q(),F=i>1,I=i<l||c,P=o.map(h=>({value:h.toString(),label:`Semaine ${h} - ${g(h).formatted}`})),D=t&&t.weekNumber===i;return e.jsxs(e.Fragment,{children:[t?.nutritionalSummary&&e.jsx(Zr,{nutritionalSummary:t.nutritionalSummary,estimatedWeeklyCost:t.estimatedWeeklyCost}),e.jsxs(E,{className:"fridge-glass-plans p-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:`fridge-icon-plans ${v?"":"fridge-ai-focus"} w-16 h-16`,style:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:"2px solid rgba(139, 92, 246, 0.5)"},children:e.jsx(p,{Icon:d.Calendar,size:32,color:"rgba(255, 255, 255, 0.95)",variant:"pure"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-white",children:"Générateur de Plan Repas"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Organisez vos repas de la semaine avec votre inventaire"})]})]})}),e.jsx(Ae,{value:r||"",options:s.map(h=>({value:h.id,label:`Inventaire du ${new Date(h.created_at).toLocaleDateString("fr-FR")} (${h.inventory_final?.length||0} ingrédients)`})),onChange:a,placeholder:"Sélectionner un inventaire...",className:"w-full","aria-label":"Sélectionner l'inventaire pour le plan de repas",disabled:n}),P.length>0&&e.jsx("div",{className:"space-y-4 mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{w(),x(i-1)},disabled:!F||n,className:"fridge-btn-plans-subtle w-8 h-8 rounded-full flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",title:F?"Semaine précédente":"Aucune semaine précédente disponible",children:e.jsx(p,{Icon:d.ChevronLeft,size:14,color:"var(--fridge-plans-light)",variant:"pure"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx(Ae,{options:P,value:i.toString(),onChange:h=>{w(),x(parseInt(h))},placeholder:"Sélectionner une semaine",disabled:n,className:"w-full"})}),e.jsx("button",{onClick:()=>{w(),x(i+1)},disabled:!I||n,className:"fridge-btn-plans-subtle w-8 h-8 rounded-full flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",title:I?"Semaine suivante":"Semaine suivante non disponible",children:e.jsx(p,{Icon:d.ChevronRight,size:14,color:"var(--fridge-plans-light)",variant:"pure"})})]})}),t?.nutritionalSummary&&e.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-white/10 text-sm",children:[e.jsxs("span",{className:"text-purple-300 font-medium",children:["~",Math.round(t.nutritionalSummary.avgCaloriesPerDay)," kcal/jour"]}),e.jsxs("span",{className:"text-cyan-300 font-medium",children:[Math.round(t.nutritionalSummary.avgProteinPerDay),"g protéines/jour"]})]})]}),t&&e.jsx("div",{className:"mt-4",children:!D&&r&&u(i)&&e.jsx(de,{children:e.jsx(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:e.jsx("button",{onClick:()=>{w(),m()},disabled:n,className:"fridge-btn-plans-primary w-full px-6 py-3 font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n?e.jsx(p,{Icon:d.Loader2,size:20,className:"animate-spin",color:"white",variant:"pure"}):e.jsx(p,{Icon:d.Calendar,size:20,color:"white",variant:"pure"}),e.jsx("span",{children:n?"Génération...":`Générer Semaine ${i}`})]})})})})})]})},es=({progress:t,loadingMessage:r,currentLoadingTitle:s,currentLoadingSubtitle:a})=>{const{isPerformanceMode:n}=q(),i=n?"div":k.div;return e.jsx(i,{...!n&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5}},children:e.jsx(E,{className:"p-8 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 15%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #A855F7 12%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #8B5CF6 30%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #8B5CF6 20%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(i,{className:`w-20 h-20 mx-auto rounded-full ${n?"animate-pulse":""}`,style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #8B5CF6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
              `,border:"2px solid color-mix(in srgb, #8B5CF6 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #8B5CF6 40%, transparent)",display:"flex",alignItems:"center",justifyContent:"center"},...!n&&{animate:{scale:[1,1.05,1],opacity:[.8,1,.8]},transition:{duration:2,repeat:1/0}},children:e.jsx(p,{Icon:d.Calendar,size:40,style:{color:"#8B5CF6"}})}),e.jsxs("div",{children:[e.jsx(i,{className:"text-3xl font-bold text-white mb-3",...!n&&{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4}},style:{textShadow:"0 0 20px color-mix(in srgb, #8B5CF6 60%, transparent)"},children:s||"Génération du Plan Nutritionnel"},s),e.jsx(i,{className:"text-white/90 text-xl mb-2",...!n&&{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1}},children:a||"Préparation de votre plan personnalisé"},a),r&&e.jsx(i,{className:"text-white/70 text-sm",...!n&&{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2}},children:r},r)]}),e.jsxs("div",{className:"max-w-md mx-auto space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm text-white/70",children:[e.jsx("span",{children:"Progression"}),e.jsxs("span",{children:[Math.round(t),"%"]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-3 overflow-hidden",children:e.jsx(i,{className:"h-3 rounded-full relative overflow-hidden",style:{background:`linear-gradient(90deg,
                    #8B5CF6,
                    #A855F7,
                    #C084FC
                  )`,boxShadow:`
                    0 0 16px color-mix(in srgb, #8B5CF6 70%, transparent),
                    inset 0 1px 0 rgba(255,255,255,0.4)
                  `,width:`${t}%`},...!n&&{initial:{width:0},animate:{width:`${t}%`},transition:{duration:.3,ease:"easeOut"}},children:e.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`linear-gradient(90deg,
                      transparent 0%,
                      rgba(255,255,255,0.6) 50%,
                      transparent 100%
                    )`,animation:"progressShimmer 2s ease-in-out infinite"}})})})]}),e.jsx("div",{className:"text-sm text-white/60",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(p,{Icon:d.Zap,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{children:"Analyse de la Forge • Optimisation nutritionnelle • Planification de la Forge"})]})})]})})})},ts=({currentPlan:t,onGenerateAllRecipes:r,onRegenerateWeek:s,onExportPlan:a,clearPlan:n,isGenerating:i})=>{const[o,l]=j.useState(!1),[c,x]=j.useState(!1),{click:g}=K(),{isPerformanceMode:m}=q(),u=m?"div":k.div,b=j.useMemo(()=>{if(!t?.days)return{totalMeals:0,generatedRecipes:0,totalUniqueIngredients:0,totalUniqueRecipes:0};let P=0,D=0;const h=new Set,S=new Set;return t.days.forEach(R=>{R.meals&&Object.values(R.meals).forEach(y=>{y&&typeof y=="object"&&(P++,y.detailedRecipe?.id?(S.add(y.detailedRecipe.id),D++):y.recipeId&&S.add(y.recipeId),y.detailedRecipe?.ingredients?y.detailedRecipe.ingredients.forEach(A=>{A.name&&h.add(A.name.toLowerCase())}):y.mainIngredients&&y.mainIngredients.forEach(A=>{h.add(A.toLowerCase())}))})}),{totalMeals:P,generatedRecipes:D,totalUniqueIngredients:h.size,totalUniqueRecipes:S.size}},[t]),w=async()=>{l(!0),g();try{await r()}finally{l(!1)}},v=async()=>{x(!0),g();try{await s()}finally{x(!1)}},F=()=>{g(),a()},I=()=>{g(),n()};return i?null:e.jsx(u,{...!m&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0}},className:"mb-6",children:e.jsx(E,{className:"p-6 border-2 border-purple-400/30",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(p,{Icon:d.CheckCircle,size:20,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Plan de repas généré avec succès !"})]}),e.jsxs("div",{className:"text-sm text-purple-300 font-medium",children:["Semaine ",t?.weekNumber||1]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-white/70",children:"Progression des recettes"}),e.jsxs("span",{className:"text-white font-medium",children:[b.generatedRecipes,"/",b.totalMeals]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:b.totalMeals>0?`${b.generatedRecipes/b.totalMeals*100}%`:"0%"}})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t?.days?.length||0}),e.jsx("div",{className:"text-sm text-white/70",children:"Jours"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:b.totalUniqueRecipes}),e.jsx("div",{className:"text-sm text-white/70",children:"Recettes uniques"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:b.totalUniqueIngredients}),e.jsx("div",{className:"text-sm text-white/70",children:"Ingrédients uniques"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t?.batchCookingDays?.length>0?t.batchCookingDays.length:b.totalMeals}),e.jsx("div",{className:"text-sm text-white/70",children:t?.batchCookingDays?.length>0?"Jours de batch cooking":"Repas planifiés"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"w-full",children:e.jsx("button",{onClick:w,disabled:o,className:"w-full text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",style:o?void 0:m?{background:"linear-gradient(145deg, color-mix(in srgb, #A855F7 90%, #1e293b), color-mix(in srgb, #9333EA 85%, #0f172a))",border:"2px solid color-mix(in srgb, #A855F7 60%, transparent)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.5)"}:{background:"linear-gradient(135deg, rgba(168, 85, 247, 0.9) 0%, rgba(147, 51, 234, 0.85) 100%)",backdropFilter:"blur(20px) saturate(160%)",border:"2px solid color-mix(in srgb, #A855F7 60%, transparent)",boxShadow:`
                    0 12px 40px color-mix(in srgb, #A855F7 40%, transparent),
                    0 0 60px color-mix(in srgb, #A855F7 30%, transparent),
                    inset 0 3px 0 rgba(255, 255, 255, 0.4),
                    inset 0 -3px 0 rgba(0, 0, 0, 0.2),
                    inset 2px 0 0 rgba(255, 255, 255, 0.1),
                    inset -2px 0 0 rgba(0, 0, 0, 0.1)
                  `,transform:"translateZ(0)",WebkitBackdropFilter:"blur(20px) saturate(160%)"},children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Génération en cours..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{Icon:d.Zap,size:20}),e.jsx("span",{children:"Valider & Générer toutes les recettes"})]})})}),e.jsxs("div",{className:"w-full flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:F,disabled:o||i,className:"sm:w-auto sm:flex-1 h-10 px-4 flex items-center justify-center bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Exporter le plan",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Download,size:16}),e.jsx("span",{children:"Exporter"})]})}),e.jsx("button",{onClick:I,disabled:o||i,className:"sm:w-auto sm:flex-1 h-10 px-4 flex items-center justify-center bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Supprimer le plan",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Trash2,size:16}),e.jsx("span",{children:"Supprimer"})]})}),e.jsx("button",{onClick:v,disabled:c||i,className:"sm:w-auto sm:flex-1 h-10 px-4 flex items-center justify-center bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-all duration-200",title:"Régénérer la semaine",children:c?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Régénérer"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.RotateCcw,size:16}),e.jsx("span",{children:"Régénérer"})]})})]})]}),e.jsx("div",{className:"bg-purple-500/10 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-white/80",children:[e.jsx("p",{className:"font-medium mb-1",children:"💡 Conseil :"}),e.jsx("p",{children:"Générez toutes les recettes pour obtenir des instructions détaillées et une liste de courses complète."})]})})]})})})},rs=({dayName:t,date:r,index:s})=>{const{isPerformanceMode:a}=q(),n=a?"div":k.div;return e.jsx(n,{...!a&&{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,delay:s*.05}},children:e.jsxs(E,{className:"p-5",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #6B7280 8%, transparent) 0%, transparent 60%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #6B7280 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #6B7280 15%, transparent)",border:"2px solid color-mix(in srgb, #6B7280 25%, transparent)"},children:e.jsx(p,{Icon:d.CalendarDays,size:16,style:{color:"#6B7280"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-lg",children:t}),e.jsx("div",{className:"text-white/60 text-xs",children:new Date(r).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Loader2,size:16,className:"animate-spin text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-xs",children:"Génération..."})]})]}),e.jsx("div",{className:"space-y-3",children:["Petit-déjeuner","Déjeuner","Dîner"].map((i,o)=>e.jsxs("div",{className:"p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-4 h-4 bg-white/20 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-white/20 rounded w-24 animate-pulse"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-white/15 rounded w-full animate-pulse"}),e.jsx("div",{className:"h-3 bg-white/15 rounded w-2/3 animate-pulse"})]})]},o))})]})})},ss=()=>e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-3/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-white/5 rounded w-full"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-5/6"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-4/5"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-3 bg-white/5 rounded w-16"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-12"})]})]}),Re=({mealType:t,meal:r,onViewRecipe:s,dayIndex:a,onGenerateDetailedRecipe:n})=>{const i=g=>g==="snack"?"snacks":g,o=g=>({breakfast:"#F59E0B",lunch:"#10B981",dinner:"#8B5CF6",snacks:"#EC4899"})[i(g)]||"#6B7280",l=g=>({breakfast:"Coffee",lunch:"Utensils",dinner:"Utensils",snacks:"Coffee"})[i(g)]||"Utensils",c=g=>({breakfast:"Petit-déjeuner",lunch:"Déjeuner",dinner:"Dîner",snacks:"Collations"})[i(g)]||g,x=o(t);return r?.status==="loading"?e.jsx(ss,{}):e.jsxs("div",{className:"p-4 rounded-xl border transition-all duration-200",style:{background:r?`color-mix(in srgb, ${x} 8%, transparent)`:"rgba(255, 255, 255, 0.05)",borderColor:r?`color-mix(in srgb, ${x} 25%, transparent)`:"rgba(255, 255, 255, 0.15)"},children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d[l(t)],size:16,style:{color:x}}),e.jsx("span",{className:"text-white/80 text-sm font-medium",children:c(t)})]})}),r?e.jsxs("div",{className:"space-y-3",children:[r.imageUrl?e.jsxs("div",{className:"mb-3 relative h-32 overflow-hidden rounded-lg",children:[e.jsx("img",{src:r.imageUrl,alt:r.mealName||r.title,className:"w-full h-full object-cover",onError:g=>{g.currentTarget.style.display="none"}}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.status==="loading"?e.jsxs("button",{disabled:!0,className:"btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 cursor-not-allowed",style:{background:"color-mix(in srgb, #6B7280 15%, transparent)",border:"1px solid color-mix(in srgb, #6B7280 25%, transparent)",color:"#9CA3AF"},children:[e.jsx(p,{Icon:d.Loader2,size:12,className:"animate-spin"}),"Génération..."]}):r.isDetailedRecipeGenerated?e.jsxs("button",{onClick:()=>s&&s(r),className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${x} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 30%, transparent)`,color:x},children:[e.jsx(p,{Icon:d.Eye,size:12}),"Voir"]}):e.jsxs("button",{onClick:()=>{console.log("🍽️ INDIVIDUAL MEAL BUTTON CLICKED: Générer la recette",{dayIndex:a,mealType:t,mealTitle:r.mealName||r.title,hasFunction:!!n}),n(a,t)},className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${x} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 30%, transparent)`,color:x},children:[e.jsx(p,{Icon:d.Sparkles,size:12}),"Générer"]})})]}):r.isDetailedRecipeGenerated&&!r.imageGenerationError?e.jsxs("div",{className:"mb-3 relative h-32 bg-gradient-to-br from-blue-900/20 to-purple-900/20 rounded-lg flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-400/30 border-t-blue-400 rounded-full"}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsxs("button",{onClick:()=>s&&s(r),className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                           hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${x} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 30%, transparent)`,color:x},children:[e.jsx(p,{Icon:d.Eye,size:12}),"Voir"]})})]}):null,r.imageGenerationError&&e.jsxs("div",{className:"mb-3 relative h-32 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg flex items-center justify-center",children:[e.jsx(p,{Icon:d.AlertTriangle,size:24,className:"text-orange-400"}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.isDetailedRecipeGenerated?e.jsxs("button",{onClick:()=>s&&s(r),className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${x} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 30%, transparent)`,color:x},children:[e.jsx(p,{Icon:d.Eye,size:12}),"Voir"]}):e.jsxs("button",{onClick:()=>{console.log("🍽️ INDIVIDUAL MEAL BUTTON CLICKED: Générer la recette",{dayIndex:a,mealType:t,mealTitle:r.mealName||r.title,hasFunction:!!n}),n(a,t)},className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${x} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 30%, transparent)`,color:x},children:[e.jsx(p,{Icon:d.Sparkles,size:12}),"Générer"]})})]}),e.jsx("h5",{className:"text-white font-semibold text-sm mb-2 leading-tight",children:r.mealName||r.title}),(r.descriptionSummary||r.description)&&e.jsx("p",{className:"text-white/60 text-xs mb-2 line-clamp-2",children:r.descriptionSummary||r.description}),e.jsxs("div",{className:"flex items-center gap-3 mb-2 text-xs text-white/70",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"⏱️"}),e.jsxs("span",{children:[r.estimatedPrepTime||r.prep_time_min||0,"min (prép)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"/"}),e.jsxs("span",{children:[r.estimatedCookTime||r.cook_time_min||0,"min (cuis)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"🔥"}),e.jsxs("span",{children:[r.estimatedCalories||r.calories_est||0," kcal"]})]})]}),r.mealComponents&&r.mealComponents.length>0&&e.jsx("div",{className:"space-y-1 mb-2",children:r.mealComponents.slice(0,2).map((g,m)=>e.jsxs("div",{className:"text-xs text-white/70 flex items-center gap-1",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-white/40"}),e.jsx("span",{children:g})]},m))}),r.dietaryTags&&r.dietaryTags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:r.dietaryTags.slice(0,2).map(g=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs",style:{background:`color-mix(in srgb, ${x} 15%, transparent)`,color:x},children:g},g))})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(p,{Icon:d.Plus,size:20,className:"text-white/40 mx-auto mb-2"}),e.jsx("span",{className:"text-white/50 text-sm",children:"Aucun repas planifié"})]})]})},as=({day:t,index:r,isEditable:s=!1,onViewRecipe:a,onGenerateDetailedRecipe:n,onGenerateAllDetailedRecipesForDay:i})=>{const{isPerformanceMode:o}=q(),l=o?"div":k.div;if(t.status==="loading")return e.jsx(rs,{dayName:t.dayName,date:t.date,index:r});const c=t.date===new Date().toISOString().split("T")[0],x=t.isBatchCookingDay,g=()=>{console.log("🔥 BUTTON CLICKED: Générer les Recettes du Jour",{dayIndex:r,dayName:t.dayName,date:t.date,hasFunction:!!i}),i?(console.log("🚀 CALLING onGenerateAllDetailedRecipesForDay with dayIndex:",r),i(r)):console.error("❌ onGenerateAllDetailedRecipesForDay function is not available")};return e.jsx(l,{...!o&&{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,delay:r*.05}},className:"relative group",children:e.jsxs(E,{className:"p-5",style:{background:c?`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 12%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `:x?`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:c?"color-mix(in srgb, #22C55E 30%, transparent)":x?"color-mix(in srgb, #8B5CF6 25%, transparent)":"color-mix(in srgb, #06B6D4 20%, transparent)",boxShadow:c?`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #22C55E 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `:`
              0 8px 32px rgba(0, 0, 0, 0.2),
              0 0 20px color-mix(in srgb, #06B6D4 12%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.12)
            `},children:[e.jsxs("div",{className:"absolute top-4 right-4 flex flex-col gap-2 z-10",children:[c&&e.jsx("div",{className:`px-2 py-1 bg-gradient-to-r from-orange-500/80 to-red-500/80 
                          border border-orange-400/60 rounded-lg text-white text-xs font-medium
                          shadow-lg backdrop-blur-sm`,children:"Aujourd'hui"}),x&&e.jsx("div",{className:`px-2 py-1 bg-gradient-to-r from-green-500/80 to-emerald-500/80 
                          border border-green-400/60 rounded-lg text-white text-xs font-medium
                          shadow-lg backdrop-blur-sm`,children:"Planifié"})]}),e.jsx("div",{className:"relative flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:c?"color-mix(in srgb, #22C55E 20%, transparent)":x?"color-mix(in srgb, #8B5CF6 15%, transparent)":"color-mix(in srgb, #06B6D4 15%, transparent)",border:c?"2px solid color-mix(in srgb, #22C55E 40%, transparent)":x?"2px solid color-mix(in srgb, #8B5CF6 30%, transparent)":"2px solid color-mix(in srgb, #06B6D4 25%, transparent)"},children:e.jsx(p,{Icon:c?d.Calendar:x?d.Clock:d.CalendarDays,size:16,style:{color:c?"#22C55E":x?"#8B5CF6":"#06B6D4"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-lg",children:t.dayName}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-white/60",children:[e.jsx("span",{children:new Date(t.date).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}),x&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"text-purple-300 font-medium",children:"Batch Cooking"})]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"p-4 rounded-xl border",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, ${c?"#22C55E":x?"#8B5CF6":"#06B6D4"} 12%, transparent) 0%, transparent 60%),
                rgba(255, 255, 255, 0.08)
              `,borderColor:`color-mix(in srgb, ${c?"#22C55E":x?"#8B5CF6":"#06B6D4"} 30%, transparent)`,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(p,{Icon:d.Clock,size:18,style:{color:c?"#22C55E":x?"#8B5CF6":"#06B6D4"}}),e.jsx("span",{className:"text-white font-bold text-xl",children:t.prepTime+t.cookTime}),e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"min"})]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Temps total"})]}),e.jsx("div",{className:"w-px h-8 bg-white/20"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(p,{Icon:d.Flame,size:18,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-white font-bold text-xl",children:t.totalCalories}),e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"kcal"})]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Calories totales"})]})]})})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Re,{mealType:"breakfast",meal:t.meals?.breakfast,onViewRecipe:a,dayIndex:r,onGenerateDetailedRecipe:n}),e.jsx(Re,{mealType:"lunch",meal:t.meals?.lunch,onViewRecipe:a,dayIndex:r,onGenerateDetailedRecipe:n}),e.jsx(Re,{mealType:"dinner",meal:t.meals?.dinner,onViewRecipe:a,dayIndex:r,onGenerateDetailedRecipe:n}),t.meals?.snack&&e.jsx(Re,{mealType:"snack",meal:t.meals.snack,onViewRecipe:a,dayIndex:r,onGenerateDetailedRecipe:n})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/10",children:e.jsx("button",{onClick:g,className:"w-full btn-glass--primary py-3 px-4 text-sm font-semibold",style:{background:`
                linear-gradient(135deg, 
                  color-mix(in srgb, ${c?"#22C55E":x?"#8B5CF6":"#06B6D4"} 80%, transparent), 
                  color-mix(in srgb, ${c?"#10B981":x?"#A855F7":"#0891B2"} 60%, transparent)
                )
              `,border:`2px solid color-mix(in srgb, ${c?"#22C55E":x?"#8B5CF6":"#06B6D4"} 60%, transparent)`,boxShadow:`
                0 8px 32px color-mix(in srgb, ${c?"#22C55E":x?"#8B5CF6":"#06B6D4"} 40%, transparent),
                0 0 40px color-mix(in srgb, ${c?"#22C55E":x?"#8B5CF6":"#06B6D4"} 30%, transparent),
                inset 0 2px 0 rgba(255,255,255,0.4)
              `,backdropFilter:"blur(16px) saturate(150%)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(p,{Icon:d.Sparkles,size:18,className:"text-white",variant:"pure"}),e.jsx("span",{className:"text-white",children:"Générer les Recettes du Jour"}),e.jsx(p,{Icon:d.ArrowRight,size:16,className:"text-white/80",variant:"pure"})]})})})]})})},ns=({weekNumber:t})=>e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:e.jsxs(E,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #10B981 20%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center breathing-icon animate-pulse",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #10B981 40%, transparent), color-mix(in srgb, #22C55E 30%, transparent))
              `,border:"3px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:`
                0 0 40px color-mix(in srgb, #10B981 50%, transparent),
                0 0 80px color-mix(in srgb, #22C55E 30%, transparent),
                inset 0 3px 0 rgba(255,255,255,0.4)
              `},children:e.jsx(p,{Icon:d.Lightbulb,size:32,style:{color:"#10B981",filter:`
                  drop-shadow(0 0 16px color-mix(in srgb, #10B981 90%, transparent))
                  drop-shadow(0 0 32px color-mix(in srgb, #10B981 70%, transparent))
                `},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Votre Guide Nutritionnel de la Forge"}),e.jsxs("p",{className:"text-green-200 text-lg",children:["Analyse personnalisée de votre plan - Semaine ",t]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-green-300/20 rounded-xl w-3/4"}),e.jsx("div",{className:"h-16 bg-white/5 rounded-xl border border-green-400/20 p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-full"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-5/6"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-4/5"})]})})]}),e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-green-300/20 rounded-xl w-2/3"}),e.jsx("div",{className:"h-16 bg-white/5 rounded-xl border border-green-400/20 p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-full"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-5/6"})]})})]}),e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-green-300/20 rounded-xl w-1/2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("div",{className:"h-12 bg-white/5 rounded-xl border border-green-400/20"}),e.jsx("div",{className:"h-12 bg-white/5 rounded-xl border border-green-400/20"})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-green-400/20",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Sparkles,size:12}),e.jsx("span",{children:"Génération en cours..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Clock,size:12}),e.jsx("span",{className:"animate-pulse",children:"Analyse en temps réel"})]})]})})]})}),is=({aiExplanation:t,weekNumber:r,isLoading:s=!1})=>s||!t?e.jsx(ns,{weekNumber:r}):e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:e.jsxs(E,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #10B981 20%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #10B981 40%, transparent), color-mix(in srgb, #22C55E 30%, transparent))
              `,border:"3px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:`
                0 0 40px color-mix(in srgb, #10B981 50%, transparent),
                0 0 80px color-mix(in srgb, #22C55E 30%, transparent),
                inset 0 3px 0 rgba(255,255,255,0.4)
              `},children:e.jsx(p,{Icon:d.Lightbulb,size:32,style:{color:"#10B981",filter:`
                  drop-shadow(0 0 16px color-mix(in srgb, #10B981 90%, transparent))
                  drop-shadow(0 0 32px color-mix(in srgb, #10B981 70%, transparent))
                `},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Votre Guide Nutritionnel de la Forge"}),e.jsxs("p",{className:"text-green-200 text-lg",children:["Analyse personnalisée de votre plan - Semaine ",r]})]})]}),e.jsxs("div",{className:"space-y-6",children:[t.personalizedReasoning&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(p,{Icon:d.User,size:18}),"Pourquoi ce plan vous convient"]}),e.jsx("p",{className:"text-green-100 text-sm leading-relaxed bg-white/5 p-4 rounded-xl border border-green-400/20",children:t.personalizedReasoning})]}),t.nutritionalStrategy&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(p,{Icon:d.Target,size:18}),"Stratégie nutritionnelle"]}),e.jsx("p",{className:"text-green-100 text-sm leading-relaxed bg-white/5 p-4 rounded-xl border border-green-400/20",children:t.nutritionalStrategy})]}),t.adaptationHighlights&&t.adaptationHighlights.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(p,{Icon:d.Check,size:18}),"Adaptations spécifiques"]}),e.jsx("div",{className:"space-y-2",children:t.adaptationHighlights.map((a,n)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-white/5 border border-green-400/20",children:[e.jsx(p,{Icon:d.ArrowRight,size:14,className:"text-green-400 mt-0.5"}),e.jsx("span",{className:"text-green-100 text-sm leading-relaxed",children:a})]},n))})]}),t.weeklyGoals&&t.weeklyGoals.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(p,{Icon:d.Flag,size:18}),"Objectifs de la semaine"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.weeklyGoals.map((a,n)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white/5 border border-green-400/20",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsx("span",{className:"text-green-100 text-sm",children:a})]},n))})]}),t.complianceNotes&&t.complianceNotes.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(p,{Icon:d.Shield,size:18}),"Respect de vos contraintes"]}),e.jsx("div",{className:"space-y-2",children:t.complianceNotes.map((a,n)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-white/5 border border-green-400/20",children:[e.jsx(p,{Icon:d.CheckCircle,size:14,className:"text-green-400 mt-0.5"}),e.jsx("span",{className:"text-green-100 text-sm leading-relaxed",children:a})]},n))})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-green-400/20",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Sparkles,size:12}),e.jsx("span",{children:"Généré par votre Forge Nutritionnelle"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{Icon:d.Clock,size:12}),e.jsx("span",{children:"Mis à jour en temps réel"})]})]})})]})}),os=({hasContext:t,onGenerate:r,isGenerating:s,profileCompletion:a,featureGuidance:n,onDismissNudge:i,nudgeDismissed:o,currentWeek:l,isWeekAvailable:c,weekDateRange:x,setCurrentWeek:g})=>{const m=()=>c?t?`Générer Semaine ${l}`:"Scannez votre frigo pour commencer":`Semaine ${l} Non Disponible`,u=()=>c?t?"Votre plan de repas sera généré automatiquement en organisant vos recettes sur 7 jours avec optimisation nutritionnelle.":"Commencez par scanner votre frigo ou sélectionner un inventaire existant pour générer votre plan de repas personnalisé.":"Cette semaine ne peut pas encore être générée. Attendez que la semaine précédente soit terminée pour débloquer la planification.";return e.jsxs("div",{className:"space-y-6",children:[e.jsx(E,{className:"p-8 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsxs("div",{className:"space-y-6 w-full text-center",children:[e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #8B5CF6 35%, transparent), color-mix(in srgb, #A855F7 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #8B5CF6 50%, transparent)",boxShadow:`
                  0 0 30px color-mix(in srgb, #8B5CF6 40%, transparent),
                  0 0 60px color-mix(in srgb, #8B5CF6 30%, transparent),
                  inset 0 2px 0 rgba(255, 255, 255, 0.2)
                `,backdropFilter:"blur(16px) saturate(150%)"},children:e.jsx(p,{Icon:t?d.Calendar:d.Scan,size:48,style:{color:"#8B5CF6",filter:`
                    drop-shadow(0 0 12px color-mix(in srgb, #8B5CF6 80%, transparent))
                    drop-shadow(0 0 24px color-mix(in srgb, #8B5CF6 60%, transparent))
                  `},variant:"pure"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:m()}),e.jsx("div",{className:"text-purple-300 text-sm font-medium mb-3",children:x.formatted}),e.jsx("p",{className:"text-white/70 text-lg leading-relaxed",children:u()})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #A855F7 15%, transparent))
                  `,border:"1px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:`
                    0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx(p,{Icon:d.Sparkles,size:32,style:{color:"#8B5CF6",filter:"drop-shadow(0 0 8px #8B5CF6)"}})}),e.jsx("h4",{className:"text-white font-semibold",children:"Génération par la Forge"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Créez des plans uniques basés sur votre inventaire"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #A855F7 15%, transparent))
                  `,border:"1px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:`
                    0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx(p,{Icon:d.Save,size:32,style:{color:"#8B5CF6",filter:"drop-shadow(0 0 8px #8B5CF6)"}})}),e.jsx("h4",{className:"text-white font-semibold",children:"Sauvegarde"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Gardez vos plans favoris dans votre bibliothèque"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #A855F7 15%, transparent))
                  `,border:"1px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:`
                    0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx(p,{Icon:d.Search,size:32,style:{color:"#8B5CF6",filter:"drop-shadow(0 0 8px #8B5CF6)"}})}),e.jsx("h4",{className:"text-white font-semibold",children:"Organisation"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Filtrez et recherchez facilement dans vos plans"})]})]}),e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("button",{onClick:r,disabled:s||!t||!c,className:"group relative overflow-hidden px-8 py-4 text-lg font-bold transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",style:{background:`
                  linear-gradient(135deg, 
                    color-mix(in srgb, #8B5CF6 90%, transparent) 0%,
                    color-mix(in srgb, #A855F7 80%, transparent) 50%,
                    color-mix(in srgb, #7C3AED 85%, transparent) 100%
                  )
                `,border:"2px solid color-mix(in srgb, #8B5CF6 70%, transparent)",borderRadius:"16px",boxShadow:`
                  0 8px 32px color-mix(in srgb, #8B5CF6 50%, transparent),
                  0 0 40px color-mix(in srgb, #8B5CF6 40%, transparent),
                  inset 0 2px 0 rgba(255, 255, 255, 0.4),
                  inset 0 -2px 0 rgba(0, 0, 0, 0.3),
                  inset 2px 0 0 rgba(255, 255, 255, 0.2),
                  inset -2px 0 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(20px) saturate(160%)",WebkitBackdropFilter:"blur(20px) saturate(160%)",color:"white",textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)",transform:"translateZ(0)",willChange:"transform, box-shadow"},children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:`
                    linear-gradient(135deg, 
                      color-mix(in srgb, #8B5CF6 95%, transparent) 0%,
                      color-mix(in srgb, #A855F7 90%, transparent) 50%,
                      color-mix(in srgb, #7C3AED 95%, transparent) 100%
                    )
                  `,borderRadius:"14px"}}),e.jsxs("div",{className:"relative flex items-center gap-3 z-10",children:[s?e.jsx(p,{Icon:d.Loader2,size:24,className:"animate-spin",style:{color:"white",filter:"drop-shadow(0 0 8px rgba(255, 255, 255, 0.5))"}}):e.jsx(p,{Icon:t?d.Calendar:d.Scan,size:24,style:{color:"white",filter:"drop-shadow(0 0 8px rgba(255, 255, 255, 0.5))"}}),e.jsx("span",{className:"relative",children:s?"Génération en cours...":t?"Générer mon plan de repas":"Scanner mon frigo"})]}),e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500",style:{background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.2) 50%, transparent 70%)",transform:"translateX(-100%)",animation:"shine 2s infinite",borderRadius:"14px"}})]})}),l>1&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs("button",{onClick:()=>g(l-1),className:"group relative overflow-hidden px-6 py-3 text-base font-semibold transition-all duration-300 hover:scale-105",style:{background:`
                    linear-gradient(135deg, 
                      color-mix(in srgb, #6B7280 60%, transparent) 0%,
                      color-mix(in srgb, #9CA3AF 50%, transparent) 50%,
                      color-mix(in srgb, #6B7280 55%, transparent) 100%
                    )
                  `,border:"2px solid color-mix(in srgb, #6B7280 50%, transparent)",borderRadius:"12px",boxShadow:`
                    0 4px 16px color-mix(in srgb, #6B7280 30%, transparent),
                    0 0 20px color-mix(in srgb, #6B7280 20%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                  `,backdropFilter:"blur(16px) saturate(140%)",WebkitBackdropFilter:"blur(16px) saturate(140%)",color:"white",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"},children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:`
                      linear-gradient(135deg, 
                        color-mix(in srgb, #6B7280 70%, transparent) 0%,
                        color-mix(in srgb, #9CA3AF 60%, transparent) 50%,
                        color-mix(in srgb, #6B7280 65%, transparent) 100%
                      )
                    `,borderRadius:"10px"}}),e.jsxs("div",{className:"relative flex items-center gap-2 z-10",children:[e.jsx(p,{Icon:d.ArrowLeft,size:20,style:{color:"white",filter:"drop-shadow(0 0 6px rgba(255, 255, 255, 0.3))"}}),e.jsx("span",{className:"relative",children:"Retour à la semaine précédente"})]})]})}),e.jsx("div",{className:"mt-8 p-4 rounded-lg",style:{background:"color-mix(in srgb, #8B5CF6 8%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(p,{Icon:d.Lightbulb,size:20,className:"text-purple-400 mt-0.5",style:{filter:"drop-shadow(0 0 6px #8B5CF6)"}}),e.jsxs("div",{className:"text-left",children:[e.jsx("h5",{className:"text-purple-300 font-semibold text-sm mb-1",children:"Astuce"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Les plans générés sont dynamiques. Vous pouvez les modifier et les sauvegarder pour les retrouver plus tard."})]})]})})]})}),e.jsx("style",{children:`
        @keyframes shine {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }

        .breathing-icon {
          animation: breathe 3s ease-in-out infinite;
        }

        @keyframes breathe {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
      `})]})},ls=({hasInventory:t,isGenerating:r,generationProgress:s,loadingMessage:a,currentLoadingTitle:n,currentLoadingSubtitle:i,currentPlan:o,selectedInventory:l,handleGenerateAllRecipes:c,handleRegenerateWeek:x,handleExportPlan:g,clearPlan:m,handleViewRecipe:u,generateDetailedRecipeForMeal:b,generateAllDetailedRecipesForDay:w,profileCompletion:v,featureGuidance:F,nudgeDismissed:I,setNudgeDismissed:P,currentWeek:D,weekDateRange:h,handleGenerateMealPlan:S,isWeekAvailable:R,setCurrentWeek:y})=>e.jsxs(e.Fragment,{children:[r&&e.jsx(es,{progress:s,loadingMessage:a,currentLoadingTitle:n,currentLoadingSubtitle:i}),!r&&o&&e.jsxs(e.Fragment,{children:[e.jsx(ts,{currentPlan:o,onRegenerateWeek:x,onGenerateAllRecipes:c,onExportPlan:g,clearPlan:m,isGenerating:r}),e.jsx(k.div,{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:o.days.filter(A=>A&&A.date).map((A,Y)=>e.jsx(as,{day:A,index:Y,isEditable:!1,onViewRecipe:u,onGenerateDetailedRecipe:b,onGenerateAllDetailedRecipesForDay:w},A.date))})]}),(r||o?.aiExplanation)&&e.jsx(is,{aiExplanation:o?.aiExplanation,weekNumber:D,isLoading:r}),!r&&!o&&e.jsx(os,{hasContext:t,onGenerate:S,isGenerating:r,profileCompletion:v,featureGuidance:F,onDismissNudge:()=>P(!0),nudgeDismissed:I,currentWeek:D,isWeekAvailable:R(D),weekDateRange:h,setCurrentWeek:y})]}),cs=({isGenerating:t,currentPlan:r,selectedInventory:s,currentWeek:a})=>e.jsxs(e.Fragment,{children:[!t&&r&&s&&e.jsx(E,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #06B6D4 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{Icon:d.Info,size:16,className:"text-cyan-400"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-cyan-300 font-medium",children:"Plan basé sur : "}),e.jsxs("span",{className:"text-white/80",children:["Inventaire du ",new Date(s.created_at).toLocaleDateString(),"(",s.inventory_final?.length||0," ingrédients) + Profil nutritionnel"]}),e.jsxs("span",{className:"text-white/60 ml-2",children:["• Semaine ",a]})]})]})}),!t&&r&&e.jsxs(E,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #10B981 15%, transparent)",border:"2px solid color-mix(in srgb, #10B981 25%, transparent)"},children:e.jsx(p,{Icon:d.Lightbulb,size:14,style:{color:"#10B981"}})}),e.jsx("h4",{className:"text-green-300 font-semibold",children:"Conseils de votre Nutritionniste IA"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-green-200",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Personnalisation :"})," Ce plan est adapté à vos objectifs fitness et préférences alimentaires"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Optimisation :"})," Utilise au maximum les ingrédients de votre inventaire sélectionné"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Évolution :"})," Générez une nouvelle semaine pour une progression continue"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Flexibilité :"})," Cliquez sur une recette pour voir les détails complets et instructions"]})]})]})]}),Ls=()=>{const{currentPlan:t,currentWeek:r,availableInventories:s,selectedInventoryId:a,isGenerating:n,generationProgress:i,loadingMessage:o,currentLoadingTitle:l,currentLoadingSubtitle:c,availableWeeks:x,maxAvailableWeek:g,isWeekAvailable:m,profileCompletion:u,featureGuidance:b,nudgeDismissed:w,showRecipeDetailModal:v,selectedRecipeForDetail:F,hasInventory:I,selectedInventory:P,weekDateRange:D,canGenerateNextWeek:h,getWeekDateRange:S,selectInventory:R,clearPlan:y,setCurrentWeek:A,setNudgeDismissed:Y,setShowRecipeDetailModal:J,setSelectedRecipeForDetail:Z,handleGenerateMealPlan:B,handleRegenerateWeek:ge,handleExportPlan:C,handleViewRecipe:M,handleGenerateAllRecipes:U,handleSavePlanAsIs:L,generateDetailedRecipeForMeal:z,generateAllDetailedRecipesForDay:X}=Kr();return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[(t||n)&&e.jsx(Xr,{currentPlan:t,handleExportPlan:C,clearPlan:y,selectedInventoryId:a,availableInventories:s,selectInventory:R,isGenerating:n,currentWeek:r,availableWeeks:x,maxAvailableWeek:g,canGenerateNextWeek:h,setCurrentWeek:A,getWeekDateRange:S,handleGenerateMealPlan:B,isWeekAvailable:m,weekDateRange:D}),e.jsx(ls,{hasInventory:I,isGenerating:n,generationProgress:i,loadingMessage:o,currentLoadingTitle:l,currentLoadingSubtitle:c,currentPlan:t,selectedInventory:P,handleGenerateAllRecipes:U,handleRegenerateWeek:ge,handleExportPlan:C,clearPlan:y,handleViewRecipe:M,generateDetailedRecipeForMeal:z,setCurrentWeek:A,generateAllDetailedRecipesForDay:X,profileCompletion:u,featureGuidance:b,nudgeDismissed:w,setNudgeDismissed:Y,currentWeek:r,weekDateRange:D,handleGenerateMealPlan:B,isWeekAvailable:m,handleSavePlanAsIs:L}),e.jsx(cs,{isGenerating:n,currentPlan:t,selectedInventory:P,currentWeek:r}),v&&F&&e.jsx(vt,{recipe:F,onClose:()=>{J(!1),Z(null)}})]})},ds=({onGenerate:t,hasAvailableMealPlans:r,onGenerateFromPlan:s,onScanFridge:a})=>{ne();const[n,i]=j.useState(!1),{profile:o}=ve(),l=Fe(o),c=r?{text:"Générer une liste depuis un plan de repas",icon:d.ShoppingCart,action:s?()=>{N.info("User initiated shopping list generation from meal plan"),s()}:()=>{}}:{text:"Scanner mon frigo pour générer une liste",icon:d.Scan,action:a?()=>{N.info("User initiated fridge scan for shopping list"),a()}:()=>{}},x=r?{title:"Générez votre Liste de Courses",description:"Créez une liste de courses optimisée à partir de vos plans de repas existants ou scannez votre frigo pour une approche personnalisée."}:{title:"Votre Atelier de Courses",description:"Commencez par scanner votre frigo pour générer des listes de courses intelligentes basées sur vos ingrédients actuels."};return e.jsx(E,{className:"w-full",style:{background:"radial-gradient(circle at 20% 50%, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 50%, rgba(234, 88, 12, 0.05) 100%)",borderColor:"rgba(251, 146, 60, 0.2)",boxShadow:"0 8px 32px rgba(251, 146, 60, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.2) 0%, rgba(249, 115, 22, 0.15) 100%)",border:"2px solid rgba(251, 146, 60, 0.3)",boxShadow:"0 8px 24px rgba(251, 146, 60, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:e.jsx(p,{Icon:d.ShoppingCart,size:48,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:x.title}),e.jsx("p",{className:"text-white/80 text-lg mb-8 max-w-2xl mx-auto",children:x.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 100%)",border:"1px solid rgba(251, 146, 60, 0.2)",boxShadow:"0 4px 16px rgba(251, 146, 60, 0.15)"},children:e.jsx(p,{Icon:d.Zap,size:32,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Génération Intelligente"}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Génération par la Forge"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Mécanismes de la Forge pour des listes optimisées selon vos besoins nutritionnels."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 100%)",border:"1px solid rgba(251, 146, 60, 0.2)",boxShadow:"0 4px 16px rgba(251, 146, 60, 0.15)"},children:e.jsx(p,{Icon:d.Package,size:32,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Optimisation Budget"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Suggestions d'alternatives économiques sans compromettre la qualité nutritionnelle."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 100%)",border:"1px solid rgba(251, 146, 60, 0.2)",boxShadow:"0 4px 16px rgba(251, 146, 60, 0.15)"},children:e.jsx(p,{Icon:d.Lightbulb,size:32,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Conseils Personnalisés"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Recommandations adaptées à vos préférences alimentaires et contraintes."})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx("button",{onClick:c.action,className:"group relative px-8 py-4 rounded-2xl font-semibold text-lg transition-all duration-300 hover:scale-105 overflow-hidden",style:{background:"linear-gradient(135deg, rgba(251, 146, 60, 0.4) 0%, rgba(249, 115, 22, 0.35) 50%, rgba(234, 88, 12, 0.3) 100%)",border:"2px solid rgba(251, 146, 60, 0.4)",boxShadow:"0 12px 40px rgba(251, 146, 60, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15), inset 0 -1px 0 rgba(0, 0, 0, 0.1)",color:"#FFFFFF",textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)"},children:e.jsxs("div",{className:"relative flex items-center justify-center gap-3",children:[e.jsx(p,{Icon:c.icon,size:24,style:{color:"#FFFFFF",filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))"}}),e.jsx("span",{children:c.text})]})})}),l&&!l.isSufficient&&!n&&e.jsx("div",{className:"mb-8",children:e.jsx(It,{completion:l,variant:"banner",onDismiss:()=>i(!0),showDismiss:!0})}),e.jsx("div",{className:"mt-8 p-4 rounded-lg",style:{background:"rgba(251, 146, 60, 0.08)",border:"1px solid rgba(251, 146, 60, 0.15)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(p,{Icon:d.Lightbulb,size:20,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"},className:"flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h4",{className:"text-white font-medium mb-1",children:"Astuce TwinForge"}),e.jsx("p",{className:"text-white/70 text-sm",children:r?"Utilisez vos plans de repas existants pour générer des listes de courses optimisées, ou scannez votre frigo pour une approche basée sur vos ingrédients actuels.":"Commencez par scanner votre frigo pour identifier vos ingrédients disponibles et générer des listes de courses personnalisées."})]})]})})]})})},Q=(t,r,s)=>CSS.supports(t,r)?r:s,xs=({currentLoadingTitle:t,currentLoadingSubtitle:r,simulatedProgressPercentage:s})=>{const{isPerformanceMode:a}=q(),n=a?"div":k.div;return e.jsx(E,{className:"border-orange-500/30",style:{background:`
          linear-gradient(135deg, rgba(251, 146, 60, 0.20) 0%, rgba(249, 115, 22, 0.12) 50%, rgba(234, 88, 12, 0.08) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${Q("color","color-mix(in srgb, #fb923c 40%, transparent)","rgba(251, 146, 60, 0.4)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(251, 146, 60, 0.3),
          0 2px 8px rgba(251, 146, 60, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsxs("div",{className:"p-2 text-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 w-24 h-24 mx-auto rounded-full bg-gradient-to-br from-orange-400/50 to-orange-600/30 blur-xl"}),e.jsxs(n,{...!a&&{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"}},className:`relative w-16 h-16 mx-auto rounded-full flex items-center justify-center shadow-2xl ${a?"animate-spin":""}`,style:{background:`
                radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.6) 0%, rgba(249, 115, 22, 0.4) 40%, rgba(234, 88, 12, 0.2) 100%)
              `,border:`1px solid ${Q("color","color-mix(in srgb, #fb923c 60%, transparent)","rgba(251, 146, 60, 0.6)")}`,boxShadow:`
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 4px 16px rgba(251, 146, 60, 0.4),
                0 2px 8px rgba(251, 146, 60, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2)
              `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/30 to-transparent blur-sm"}),e.jsx(p,{Icon:d.ShoppingCart,size:32,className:"relative text-orange-100 drop-shadow-2xl"})]}),!a&&e.jsx(n,{animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 w-20 h-20 mx-auto rounded-full border-2 border-orange-500/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-orange-200 to-orange-100 bg-clip-text text-transparent drop-shadow-sm",children:t||"TwinForge génère votre liste..."}),e.jsx("p",{className:"text-white/70 text-sm",children:r||"Intelligence artificielle en action pour vos courses parfaites"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(n,{className:"h-full bg-gradient-to-r from-orange-400 to-orange-500 rounded-full shadow-lg",...!a&&{initial:{width:0},animate:{width:`${s}%`},transition:{duration:.5,ease:"easeOut"}},style:a?{width:`${s}%`}:void 0})}),e.jsxs("span",{className:"text-orange-200 text-sm font-semibold",children:[Math.round(s),"%"]})]})]})})},qe=[{step:1,title:"Analyse nutritionnelle",progress:15,icon:"User"},{step:2,title:"Vérification inventaire",progress:30,icon:"Package"},{step:3,title:"Extraction des recettes",progress:45,icon:"Utensils"},{step:4,title:"Génération intelligente",progress:70,icon:"ShoppingCart"},{step:5,title:"Optimisation IA",progress:85,icon:"Zap"},{step:6,title:"Finalisation",progress:100,icon:"Check"}],ps=({simulatedProgressPercentage:t})=>e.jsx(E,{className:"border-white/20",style:{background:`
          linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 50%, rgba(255, 255, 255, 0.03) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${Q("color","color-mix(in srgb, white 25%, transparent)","rgba(255, 255, 255, 0.25)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(255, 255, 255, 0.15),
          0 2px 8px rgba(255, 255, 255, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-white/10 blur-sm"}),e.jsxs("div",{className:"relative p-2 rounded-full",style:{background:"rgba(255, 255, 255, 0.15)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:`
                  0 2px 8px rgba(0, 0, 0, 0.2),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-transparent blur-sm"}),e.jsx(p,{Icon:d.Clock,className:"relative w-5 h-5 text-white/70 drop-shadow-lg"})]})]}),e.jsx("span",{className:"text-white/80 text-sm font-medium",children:"Étapes de génération TwinForge"})]}),e.jsx("div",{className:"space-y-3",children:qe.map((r,s)=>{r.step/qe.length*100;const a=Math.floor(t/100*qe.length),n=s===a,i=s<a;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[n&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/40 to-orange-600/20 blur-md"}),e.jsxs("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center text-xs font-medium transition-all duration-500",style:i?{background:`
                              radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.5) 0%, rgba(249, 115, 22, 0.3) 40%, rgba(234, 88, 12, 0.15) 100%)
                            `,border:`1px solid ${Q("color","color-mix(in srgb, #fb923c 60%, transparent)","rgba(251, 146, 60, 0.6)")}`,color:"rgba(251, 146, 60, 0.9)",boxShadow:`
                              0 2px 8px rgba(0, 0, 0, 0.3),
                              0 1px 4px rgba(251, 146, 60, 0.4),
                              inset 0 1px 0 rgba(255, 255, 255, 0.15)
                            `}:n?{background:`
                              radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.3) 0%, rgba(249, 115, 22, 0.2) 40%, rgba(234, 88, 12, 0.1) 100%)
                            `,border:`1px solid ${Q("color","color-mix(in srgb, #fb923c 40%, transparent)","rgba(251, 146, 60, 0.4)")}`,color:"rgba(251, 146, 60, 0.8)",boxShadow:`
                              0 2px 8px rgba(0, 0, 0, 0.2),
                              inset 0 1px 0 rgba(255, 255, 255, 0.1)
                            `}:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"rgba(255, 255, 255, 0.5)"},children:[n&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/20 to-transparent blur-sm"}),i?e.jsx(p,{Icon:d.Check,size:20,className:"relative drop-shadow-lg"}):e.jsx(p,{Icon:d[r.icon],size:20,className:"relative drop-shadow-lg"})]})]}),e.jsx("span",{className:`text-base ${n?"text-white font-medium":"text-white/50"}`,children:r.title})]},r.step)})})]})}),ms=()=>{const{isGenerating:t,simulatedProgressPercentage:r,currentLoadingTitle:s,currentLoadingSubtitle:a,startSimulatedProgress:n,stopSimulatedProgress:i}=Be();return ce.useEffect(()=>(t&&n(),()=>{t||i()}),[t,n,i]),j.useEffect(()=>(n(),()=>{i()}),[n,i]),e.jsxs("div",{className:"space-y-6",children:[e.jsx(xs,{currentLoadingTitle:s,currentLoadingSubtitle:a,simulatedProgressPercentage:r}),e.jsx(ps,{simulatedProgressPercentage:r})]})},gs=({shoppingList:t,completedCount:r,totalCount:s,progressPercentage:a,onReset:n})=>{const{isPerformanceMode:i}=q(),o=i?"div":k.div;return e.jsx(E,{className:"border-cyan-500/30 p-1",style:i?{background:"linear-gradient(145deg, color-mix(in srgb, #06b6d4 20%, #1e293b), color-mix(in srgb, #06b6d4 10%, #0f172a))",border:"1px solid color-mix(in srgb, #06b6d4 40%, transparent)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.4)"}:{background:`
          radial-gradient(circle at 30% 20%, rgba(6, 182, 212, 0.15) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, rgba(8, 145, 178, 0.10) 0%, transparent 50%),
          linear-gradient(135deg, rgba(6, 182, 212, 0.12) 0%, rgba(8, 145, 178, 0.08) 50%, rgba(14, 116, 144, 0.06) 100%)
        `,backdropFilter:"blur(24px) saturate(180%)",border:`1px solid ${Q("color","color-mix(in srgb, #06b6d4 35%, transparent)","rgba(6, 182, 212, 0.35)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.4),
          0 6px 20px rgba(6, 182, 212, 0.20),
          0 2px 8px rgba(6, 182, 212, 0.25),
          inset 0 2px 0 rgba(255, 255, 255, 0.15),
          inset 0 -1px 0 rgba(0, 0, 0, 0.2)
        `},children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-cyan-400/40 to-cyan-600/25 blur-2xl"}),e.jsxs("div",{className:"relative w-16 h-16 rounded-full flex items-center justify-center shadow-2xl breathing-icon",style:i?{background:"linear-gradient(135deg, color-mix(in srgb, #06b6d4 35%, #1e293b), color-mix(in srgb, #06b6d4 25%, #0f172a))",border:"2px solid color-mix(in srgb, #06b6d4 50%, transparent)",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.4)"}:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                    radial-gradient(circle at 70% 70%, rgba(6, 182, 212, 0.4) 0%, rgba(8, 145, 178, 0.3) 50%, rgba(14, 116, 144, 0.2) 100%)
                  `,border:`2px solid ${Q("color","color-mix(in srgb, #06b6d4 50%, transparent)","rgba(6, 182, 212, 0.5)")}`,boxShadow:`
                    0 8px 32px rgba(0, 0, 0, 0.3),
                    0 4px 16px rgba(6, 182, 212, 0.3),
                    0 2px 8px rgba(6, 182, 212, 0.4),
                    0 0 40px rgba(6, 182, 212, 0.25),
                    inset 0 2px 0 rgba(255, 255, 255, 0.25),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                  `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-cyan-300/20 to-transparent blur-sm"}),e.jsx(p,{Icon:d.ShoppingCart,size:32,className:"relative text-cyan-100 drop-shadow-2xl"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-cyan-200 to-cyan-100 bg-clip-text text-transparent drop-shadow-sm",children:t.name}),e.jsx("p",{className:"text-white/70 text-sm",children:t.generationMode==="user_and_family"?"Liste familiale":"Liste personnelle"})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-cyan-200/70 font-medium",children:"Progression des courses"}),e.jsxs("span",{className:"text-cyan-200 font-semibold",children:[r,"/",s," articles"]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(o,{className:"h-full rounded-full shadow-lg",style:{background:"linear-gradient(90deg, rgba(16, 185, 129, 0.9) 0%, rgba(5, 150, 105, 0.95) 100%)",width:i?`${a}%`:void 0},...!i&&{initial:{width:0},animate:{width:`${a}%`},transition:{duration:.5}}})})]}),e.jsx("button",{onClick:n,className:"w-full mt-4 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300 btn-glass",style:i?{background:"linear-gradient(145deg, color-mix(in srgb, #06b6d4 80%, #1e293b), color-mix(in srgb, #0891b2 75%, #0f172a))",border:"2px solid color-mix(in srgb, #06b6d4 60%, transparent)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.5)",color:"white"}:{background:`
              linear-gradient(135deg,
                color-mix(in srgb, #06b6d4 80%, transparent),
                color-mix(in srgb, #0891b2 75%, transparent)
              )
            `,border:`2px solid ${Q("color","color-mix(in srgb, #06b6d4 60%, transparent)","rgba(6, 182, 212, 0.6)")}`,boxShadow:`
              0 8px 32px color-mix(in srgb, #06b6d4 35%, transparent),
              0 0 40px color-mix(in srgb, #06b6d4 25%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.3),
              inset 0 -2px 0 rgba(0, 0, 0, 0.2)
            `,backdropFilter:"blur(20px) saturate(160%)",color:"white"},children:"Nouvelle liste"})]})})},us=({budgetEstimation:t})=>!t||!t.estimated_cost||t.estimated_cost==="Non estimé"?null:e.jsx(E,{className:"border-slate-400/30 p-1 mb-4",style:{background:`
          linear-gradient(135deg, 
            rgba(148, 163, 184, 0.15) 0%, 
            rgba(100, 116, 139, 0.12) 25%,
            rgba(71, 85, 105, 0.08) 50%,
            rgba(51, 65, 85, 0.06) 75%,
            rgba(30, 41, 59, 0.04) 100%
          )
        `,backdropFilter:"blur(24px) saturate(200%)",border:`1px solid ${Q("color","color-mix(in srgb, #94a3b8 30%, transparent)","rgba(148, 163, 184, 0.3)")}`,boxShadow:`
          0 16px 48px rgba(0, 0, 0, 0.4),
          0 8px 24px rgba(148, 163, 184, 0.15),
          0 4px 12px rgba(148, 163, 184, 0.2),
          0 2px 6px rgba(148, 163, 184, 0.25),
          inset 0 1px 0 rgba(255, 255, 255, 0.15),
          inset 0 -1px 0 rgba(0, 0, 0, 0.2),
          inset 1px 0 0 rgba(255, 255, 255, 0.08),
          inset -1px 0 0 rgba(0, 0, 0, 0.08)
        `},children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-slate-300/40 to-slate-500/20 blur-xl"}),e.jsxs("div",{className:"relative w-12 h-12 rounded-full flex items-center justify-center shadow-2xl",style:{background:`
                  radial-gradient(circle at 30% 30%, 
                    rgba(148, 163, 184, 0.4) 0%, 
                    rgba(100, 116, 139, 0.3) 40%, 
                    rgba(71, 85, 105, 0.2) 70%,
                    rgba(51, 65, 85, 0.1) 100%
                  )
                `,border:`1px solid ${Q("color","color-mix(in srgb, #94a3b8 50%, transparent)","rgba(148, 163, 184, 0.5)")}`,boxShadow:`
                  0 8px 32px rgba(0, 0, 0, 0.3),
                  0 4px 16px rgba(148, 163, 184, 0.2),
                  0 2px 8px rgba(148, 163, 184, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.25),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-slate-200/20 to-transparent blur-sm"}),e.jsx(p,{Icon:d.DollarSign,size:24,className:"relative text-slate-200 drop-shadow-lg"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold bg-gradient-to-r from-slate-200 to-slate-300 bg-clip-text text-transparent drop-shadow-sm",children:"Budget estimé"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-slate-100 drop-shadow-lg",children:t.estimated_cost}),t.confidence_level&&e.jsx("span",{className:"text-xs text-slate-300/80 font-medium",children:t.confidence_level})]})]})]}),t.notes&&t.notes.length>0&&e.jsx("div",{className:"mt-3 p-3 rounded-lg",style:{background:`
                linear-gradient(135deg, 
                  rgba(148, 163, 184, 0.08) 0%, 
                  rgba(100, 116, 139, 0.06) 50%,
                  rgba(71, 85, 105, 0.04) 100%
                )
              `,border:`1px solid ${Q("color","color-mix(in srgb, #94a3b8 20%, transparent)","rgba(148, 163, 184, 0.2)")}`,boxShadow:`
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1)
              `},children:e.jsx("div",{className:"space-y-1",children:t.notes.map((r,s)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-300/90",children:[e.jsx("div",{className:"w-1 h-1 rounded-full mt-1.5 flex-shrink-0",style:{background:"linear-gradient(45deg, rgba(148, 163, 184, 0.6), rgba(100, 116, 139, 0.4))",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.2)"}}),e.jsx("span",{children:r})]},s))})})]})}),bs=({suggestions:t})=>!t||t.length===0?null:e.jsxs(E,{className:"border-blue-500/30 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(p,{Icon:d.Lightbulb,size:20,className:"text-blue-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Suggestions Complémentaires"})]}),e.jsx("div",{className:"space-y-2",children:t.map((r,s)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-white/5",children:[e.jsx(p,{Icon:d.Plus,size:16,className:"text-blue-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:r.name}),r.reason&&e.jsx("p",{className:"text-white/70 text-sm",children:r.reason})]}),r.estimatedPrice&&e.jsxs("span",{className:"text-blue-400 font-medium",children:[r.estimatedPrice,"€"]})]},s))})]}),hs=({advice:t})=>!t||t.length===0?null:e.jsxs(E,{className:"border-green-500/30 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(p,{Icon:d.CheckCircle,size:20,className:"text-green-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Conseils Personnalisés"})]}),e.jsx("div",{className:"space-y-3",children:t.map((r,s)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-white/5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 flex-shrink-0 mt-2"}),e.jsx("p",{className:"text-white/90 text-sm leading-relaxed",children:r})]},s))})]}),fs=({item:t,itemKey:r,isChecked:s,onToggle:a,index:n})=>{const{isPerformanceMode:i}=q(),o=i?"div":k.div;return N.debug("ShoppingListItem rendering",{itemName:t.name,itemKey:r,isChecked:s,quantity:t.quantity}),e.jsxs(o,{...!i&&{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:n*.05},whileHover:{scale:1.01},whileTap:{scale:.99}},className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all duration-300 ${s?"bg-green-500/20 border border-green-500/40 shadow-lg":"bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20"}`,onClick:()=>a(r),children:[e.jsxs("div",{className:"relative",children:[s&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-green-400/40 to-green-600/20 blur-md"}),e.jsx("div",{className:"relative w-6 h-6 rounded border-2 flex items-center justify-center transition-all duration-300",style:s?{background:`
              linear-gradient(135deg, rgba(34, 197, 94, 0.8) 0%, rgba(22, 163, 74, 0.6) 50%, rgba(21, 128, 61, 0.4) 100%)
            `,border:`2px solid ${Q("color","color-mix(in srgb, #22c55e 80%, transparent)","rgba(34, 197, 94, 0.8)")}`,boxShadow:`
              0 4px 12px rgba(0, 0, 0, 0.3),
              0 2px 6px rgba(34, 197, 94, 0.5),
              inset 0 1px 0 rgba(255, 255, 255, 0.2),
              inset 0 -1px 0 rgba(0, 0, 0, 0.1)
            `}:{border:"2px solid rgba(255, 255, 255, 0.4)",background:"rgba(255, 255, 255, 0.08)",boxShadow:`
              0 2px 4px rgba(0, 0, 0, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.1)
            `},children:e.jsx(de,{children:s&&e.jsxs(k.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{duration:.2},children:[e.jsx("div",{className:"absolute inset-0 rounded bg-gradient-to-br from-green-300/20 to-transparent blur-sm"}),e.jsx(p,{Icon:d.Check,className:"relative w-4 h-4 text-white drop-shadow-lg"})]})})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:`font-medium text-base transition-all duration-300 ${s?"text-white/60 line-through":"text-white"}`,children:t.name})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-white/70 text-sm font-medium",children:t.quantity}),t.notes&&e.jsxs("span",{className:"text-white/50 text-xs",children:["• ",t.notes]})]})]})]})},vs=({category:t,checkedItems:r,onToggleItem:s,index:a})=>{const{isPerformanceMode:n}=q(),i=n?"div":k.div;return N.debug("ShoppingListCategory rendering",{categoryName:t.category,itemsCount:t.items?.length||0,checkedItemsCount:r.size}),!t.items||t.items.length===0?(N.warn("ShoppingListCategory received empty items array",{category:t.category}),null):e.jsxs(i,{...!n&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.1}},className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center drop-shadow-lg mb-3",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-400 rounded-full mr-3"}),t.category]}),e.jsxs("span",{className:"text-sm text-white/70 font-medium",children:[t.items.length," article",t.items.length>1?"s":""]})]}),e.jsx("div",{className:"space-y-2",children:t.items.map((o,l)=>{const c=`${t.category}-${o.name}`;return e.jsx(fs,{item:o,itemKey:c,isChecked:r.has(c),onToggle:s,index:l},c)})})]})},ys=({shoppingList:t})=>{const{isPerformanceMode:r}=q(),s=r?"button":k.button,a=()=>{N.info("PDF export requested",{shoppingListId:t.id});const i={name:t.name,totalItems:t.totalItems,categories:t.categories?.map(o=>({name:o.name,items:o.items.map(l=>`${l.name} - ${l.quantity}`)}))};N.debug("Formatted shopping list for PDF export",i),typeof window<"u"&&window.alert&&window.alert("Génération PDF en cours de développement. Cette fonctionnalité sera bientôt disponible !")},n=async()=>{N.info("Text export requested",{shoppingListId:t.id});let i=`${t.name}
`;i+=`${"=".repeat(t.name.length)}

`,t.categories?.forEach(o=>{i+=`${o.name}:
`,o.items.forEach(l=>{i+=`  • ${l.name} - ${l.quantity}`,l.notes&&(i+=` (${l.notes})`),i+=`
`}),i+=`
`}),i+=`Total: ${t.totalItems} articles
`;try{typeof navigator<"u"&&navigator.clipboard?(await navigator.clipboard.writeText(i),N.info("Shopping list copied to clipboard successfully"),typeof window<"u"&&window.alert&&window.alert("Liste de courses copiée dans le presse-papiers !")):(N.warn("Clipboard API not available, using fallback"),typeof window<"u"&&window.alert&&window.alert(`Votre navigateur ne supporte pas la copie automatique. Voici votre liste:

`+i))}catch(o){N.error("Failed to copy to clipboard",o),typeof window<"u"&&window.alert&&window.alert(`Erreur lors de la copie. Voici votre liste:

`+i)}};return e.jsx(E,{className:"border-white/20 p-1",style:{background:`
          linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 50%, rgba(255, 255, 255, 0.03) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${Q("color","color-mix(in srgb, white 25%, transparent)","rgba(255, 255, 255, 0.25)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(255, 255, 255, 0.15),
          0 2px 8px rgba(255, 255, 255, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-white/10 blur-sm"}),e.jsx("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center",style:{background:"rgba(255, 255, 255, 0.15)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:`
                    0 2px 8px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(p,{Icon:d.Download,size:20,className:"relative text-white/70 drop-shadow-lg"})})]}),e.jsx("span",{className:"text-white/80 text-base font-medium",children:"Exporter votre liste"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(s,{...!r&&{whileHover:{scale:1.05},whileTap:{scale:.95}},onClick:a,className:`px-2 py-1 bg-white/10 hover:bg-orange-500/20 rounded-lg text-white/70 hover:text-orange-200 ${r?"":"transition-all duration-300"} text-xs border border-white/20 hover:border-orange-400/30`,children:"PDF"}),e.jsx(s,{...!r&&{whileHover:{scale:1.05},whileTap:{scale:.95}},onClick:n,className:`px-2 py-1 bg-white/10 hover:bg-orange-500/20 rounded-lg text-white/70 hover:text-orange-200 ${r?"":"transition-all duration-300"} text-xs border border-white/20 hover:border-orange-400/30`,children:"Texte"})]})]})})})},js=()=>{const{shoppingList:t,suggestions:r,advice:s,budgetEstimation:a,reset:n}=Be(),[i,o]=j.useState(new Set);if(ce.useEffect(()=>{N.debug("SHOPPING_LIST_DISPLAY","Current state",{shoppingListCount:t?.categories?.length||0,suggestionsCount:r.length,adviceCount:s.length,hasBudget:!!a}),t&&(N.debug("SHOPPING_LIST_DISPLAY","Shopping list details",{id:t.id,name:t.name,totalItems:t.totalItems,categoriesCount:t.categories?.length||0,categories:t.categories?.map(m=>({id:m.id,name:m.name,itemsCount:m.items?.length||0,items:m.items?.map(u=>({id:u.id,name:u.name,quantity:u.quantity}))||[]}))||[]}),t.categories?.forEach((m,u)=>{N.debug("SHOPPING_LIST_DISPLAY",`Category ${u+1}: ${m.name}`,{categoryId:m.id,itemsCount:m.items?.length||0,items:m.items?.map(b=>`${b.name} (${b.quantity})`)||[]})}))},[t,r,s,a]),!t)return N.debug("SHOPPING_LIST_DISPLAY","No shopping list available"),null;const l=m=>{const u=new Set(i);u.has(m)?u.delete(m):u.add(m),o(u),new Set(i).size,N.debug("SHOPPING_LIST_DISPLAY","Item toggled",{itemId:m,isChecked:u.has(m),totalChecked:u.size})},c=t.totalItems||0,x=i.size,g=c>0?x/c*100:0;return N.debug("SHOPPING_LIST_DISPLAY","Rendering shopping list",{totalCount:c,completedCount:x,progressPercentage:g,categoriesCount:t.categories?.length||0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(gs,{shoppingList:t,totalCount:c,completedCount:x,progressPercentage:g,onReset:n}),e.jsx(us,{budgetEstimation:a}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.categories?.map((m,u)=>(N.debug("SHOPPING_LIST_DISPLAY",`Rendering category ${u+1}`,{categoryId:m.id,categoryName:m.name,itemsCount:m.items?.length||0}),e.jsx(vs,{category:m,checkedItems:i,onToggleItem:l,index:u},m.id)))}),e.jsx(bs,{suggestions:r}),e.jsx(hs,{advice:s}),e.jsx(ys,{shoppingList:t})]})},lt=()=>{const{generationMode:t,selectedMealPlanId:r,setGenerationMode:s,setSelectedMealPlanId:a,generateShoppingList:n}=Be(),{allMealPlans:i,loadAllMealPlans:o}=Ce(),[l,c]=j.useState(!1),{isPerformanceMode:x}=q();j.useEffect(()=>{o()},[o]);const g=(i||[]).map(u=>({value:u.id,label:`Plan du ${new Date(u.createdAt).toLocaleDateString()}`})),m=async()=>{if(!l){N.debug("SHOPPING_LIST_GENERATOR","Starting generation",{generationMode:t,selectedMealPlanId:r}),c(!0);try{await n({generationMode:t,selectedMealPlanId:r})}catch(u){N.error("SHOPPING_LIST_GENERATOR","Generation failed",{error:u})}finally{c(!1)}N.info("User initiated shopping list generation",{selectedMealPlanId:r,generationMode:t})}};return e.jsx(E,{className:"p-6",style:x?{background:"linear-gradient(145deg, color-mix(in srgb, #fb923c 20%, #1e293b), color-mix(in srgb, #fb923c 10%, #0f172a))",border:"1px solid color-mix(in srgb, #fb923c 40%, transparent)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.4)"}:{background:`
          radial-gradient(circle at 30% 20%, rgba(251, 146, 60, 0.25) 0%, transparent 50%),
          linear-gradient(135deg, rgba(251, 146, 60, 0.20) 0%, rgba(249, 115, 22, 0.12) 50%, rgba(234, 88, 12, 0.08) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 40%, transparent)")?"color-mix(in srgb, #fb923c 40%, transparent)":"rgba(251, 146, 60, 0.4)"}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(251, 146, 60, 0.3),
          0 2px 8px rgba(251, 146, 60, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/50 to-orange-600/30 blur-xl"}),e.jsxs("div",{className:"relative w-16 h-16 rounded-full flex items-center justify-center shadow-2xl",style:x?{background:"linear-gradient(135deg, color-mix(in srgb, #fb923c 60%, #1e293b), color-mix(in srgb, #fb923c 40%, #0f172a))",border:"1px solid color-mix(in srgb, #fb923c 60%, transparent)",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.4)"}:{background:`
                  radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.6) 0%, rgba(249, 115, 22, 0.4) 40%, rgba(234, 88, 12, 0.2) 100%)
                `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 60%, transparent)")?"color-mix(in srgb, #fb923c 60%, transparent)":"rgba(251, 146, 60, 0.6)"}`,boxShadow:`
                  0 8px 32px rgba(0, 0, 0, 0.4),
                  0 4px 16px rgba(251, 146, 60, 0.4),
                  0 2px 8px rgba(251, 146, 60, 0.6),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/30 to-transparent blur-sm"}),e.jsx(d.ShoppingCart,{size:32,className:"relative text-orange-100 drop-shadow-lg"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Générateur de Liste de Courses"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Créez des listes de courses optimisées pour vos repas"})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(Ae,{options:g,value:r||"",onChange:u=>a(u),placeholder:"Choisir un plan de repas",className:"w-full",disabled:l})}),e.jsx("div",{className:"border-t border-white/10 mt-4 pt-4"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>s("user_only"),className:`flex-1 p-4 rounded-xl border transition-all duration-500 ${t==="user_only"?"border-orange-400/50 bg-gradient-to-br from-orange-500/25 to-orange-600/15 text-orange-300 shadow-2xl":"border-white/20 bg-white/5 text-white/60 hover:border-orange-400/30 hover:bg-orange-500/10"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[t==="user_only"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/40 to-orange-600/20 blur-md"}),e.jsxs("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center",style:t==="user_only"?x?{background:"linear-gradient(135deg, color-mix(in srgb, #fb923c 50%, #1e293b), color-mix(in srgb, #fb923c 30%, #0f172a))",border:"1px solid color-mix(in srgb, #fb923c 50%, transparent)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"}:{background:`
                      radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.5) 0%, rgba(249, 115, 22, 0.3) 40%, rgba(234, 88, 12, 0.15) 100%)
                    `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 50%, transparent)")?"color-mix(in srgb, #fb923c 50%, transparent)":"rgba(251, 146, 60, 0.5)"}`,boxShadow:`
                      0 4px 16px rgba(0, 0, 0, 0.3),
                      0 2px 8px rgba(251, 146, 60, 0.3),
                      inset 0 1px 0 rgba(255, 255, 255, 0.15),
                      inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                    `}:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[t==="user_only"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/20 to-transparent blur-sm"}),e.jsx(d.User,{size:20,className:"relative drop-shadow-lg"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-base",children:"Courses Personnelles"}),e.jsx("div",{className:"text-sm opacity-75",children:"Liste personnelle"})]})]})}),e.jsx("button",{onClick:()=>s("user_and_family"),className:`flex-1 p-4 rounded-xl border transition-all duration-500 ${t==="user_and_family"?"border-orange-400/50 bg-gradient-to-br from-orange-500/25 to-orange-600/15 text-orange-300 shadow-2xl":"border-white/20 bg-white/5 text-white/60 hover:border-orange-400/30 hover:bg-orange-500/10"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[t==="user_and_family"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/40 to-orange-600/20 blur-md"}),e.jsxs("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center",style:t==="user_and_family"?x?{background:"linear-gradient(135deg, color-mix(in srgb, #fb923c 50%, #1e293b), color-mix(in srgb, #fb923c 30%, #0f172a))",border:"1px solid color-mix(in srgb, #fb923c 50%, transparent)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"}:{background:`
                      radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.5) 0%, rgba(249, 115, 22, 0.3) 40%, rgba(234, 88, 12, 0.15) 100%)
                    `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 50%, transparent)")?"color-mix(in srgb, #fb923c 50%, transparent)":"rgba(251, 146, 60, 0.5)"}`,boxShadow:`
                      0 4px 16px rgba(0, 0, 0, 0.3),
                      0 2px 8px rgba(251, 146, 60, 0.3),
                      inset 0 1px 0 rgba(255, 255, 255, 0.15),
                      inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                    `}:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[t==="user_and_family"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/20 to-transparent blur-sm"}),e.jsx(d.Users,{size:20,className:"relative drop-shadow-lg"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-base",children:"Courses Familiales"}),e.jsx("div",{className:"text-sm opacity-75",children:"Liste pour tous"})]})]})})]}),e.jsxs("button",{onClick:m,disabled:!r||l,className:"w-full px-8 py-4 text-lg font-bold text-white rounded-xl disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-500 flex items-center justify-center gap-3 transform hover:scale-[1.02] active:scale-[0.98]",style:{background:`
              linear-gradient(135deg, rgba(251, 146, 60, 0.9) 0%, rgba(249, 115, 22, 0.95) 50%, rgba(234, 88, 12, 1) 100%)
            `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 70%, transparent)")?"color-mix(in srgb, #fb923c 70%, transparent)":"rgba(251, 146, 60, 0.7)"}`,boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.4),
              0 6px 20px rgba(251, 146, 60, 0.4),
              0 3px 10px rgba(251, 146, 60, 0.6),
              inset 0 1px 0 rgba(255, 255, 255, 0.2),
              inset 0 -2px 0 rgba(0, 0, 0, 0.2)
            `},children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/40 to-white/20 blur-sm"}),e.jsxs("div",{className:"relative p-1 rounded-full",style:{background:"rgba(255, 255, 255, 0.25)",border:"1px solid rgba(255, 255, 255, 0.4)",boxShadow:`
                  0 2px 8px rgba(0, 0, 0, 0.2),
                  inset 0 1px 0 rgba(255, 255, 255, 0.3)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-transparent blur-sm"}),e.jsx(d.Sparkles,{className:"relative w-4 h-4 text-white drop-shadow-lg"})]})]}),e.jsx("span",{className:"drop-shadow-sm",children:"Générer ma liste de courses"})]})]})})},qs=()=>{ne();const{isGenerating:t,shoppingList:r,error:s,reset:a,generateShoppingList:n}=Be(),{allMealPlans:i,loadAllMealPlans:o}=Ce(),{startScan:l}=ye();ce.useEffect(()=>{o()},[o]),ce.useEffect(()=>(N.debug("SHOPPING_LIST_TAB","Component mounted",{isGenerating:t,hasShoppingList:!!r,hasError:!!s,allMealPlansCount:i.length}),()=>{N.debug("SHOPPING_LIST_TAB","Component unmounting")}),[t,r,s,i.length]);const c=i.length>0,x=r&&r.totalItems>0,g=()=>{N.info("SHOPPING_LIST_TAB","User initiated generation from meal plan")},m=()=>t?e.jsx(ms,{}):x?e.jsxs("div",{className:"space-y-6",children:[e.jsx(js,{}),e.jsx(lt,{})]}):c?e.jsx(lt,{}):e.jsx(ds,{hasAvailableMealPlans:c,onGenerateFromPlan:g});return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6 w-full",children:[e.jsx(de,{children:s&&e.jsx(k.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"w-full",children:e.jsx(E,{className:"border-red-500/20 bg-red-500/5",children:e.jsxs("div",{className:"flex items-center gap-3 p-4",children:[e.jsx(p,{name:"AlertTriangle",size:20,className:"text-red-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Erreur de génération"}),e.jsx("p",{className:"text-red-300/80 text-sm mt-1",children:s})]}),e.jsx("button",{onClick:a,className:"text-red-400 hover:text-red-300 transition-colors",children:e.jsx(p,{name:"X",size:16})})]})})})}),e.jsx(de,{mode:"wait",children:e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"w-full",children:m()},t?"generating":r?"display":"generator")})]})};export{zs as F,ae as H,Es as P,$s as R,Ms as S,Pt as _,q as a,Ds as b,Fe as c,Rs as d,Bs as e,Ts as f,vr as g,As as h,yr as i,fr as j,Ls as k,N as l,qs as m,jr as n,_s as o,Fs as p,Gt as q,W as s,Ps as t,K as u};
