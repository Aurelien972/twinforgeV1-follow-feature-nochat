import{l as s,s as f,a as S}from"./page-fridge-C1QVLxk9.js";import{s as w,g as I,f as d}from"./date-utils-BlBdbPk_.js";import{j as g}from"./vendor-ZbFMzY-i.js";import{m as v}from"./motion-HGAT--uT.js";async function A(e,t=new Date){const i=w(t).toISOString(),r=I(t).toISOString();s.info("ACTIVITIES_REPO","Fetching activities for date",{userId:e,date:d(t,"yyyy-MM-dd"),startDate:i,endDate:r,timestamp:new Date().toISOString()});try{const{data:a,error:o}=await f.from("activities").select("*").eq("user_id",e).gte("timestamp",i).lte("timestamp",r).order("timestamp",{ascending:!1});if(o)throw s.error("ACTIVITIES_REPO","Failed to fetch activities",{error:o.message,errorCode:o.code,userId:e,date:d(t,"yyyy-MM-dd"),timestamp:new Date().toISOString()}),o;return s.info("ACTIVITIES_REPO","Activities fetched successfully",{userId:e,date:d(t,"yyyy-MM-dd"),activitiesCount:a?.length||0,timestamp:new Date().toISOString()}),a||[]}catch(a){throw s.error("ACTIVITIES_REPO","Exception during activities fetch",{error:a instanceof Error?a.message:"Unknown error",userId:e,date:d(t,"yyyy-MM-dd"),timestamp:new Date().toISOString()}),a}}function b(e){if(e.length===0)return{totalCalories:0,activitiesCount:0,totalDuration:0,averageIntensity:void 0,mostFrequentType:void 0,lastActivityTime:void 0};const t=e.reduce((l,u)=>l+u.calories_est,0),i=e.reduce((l,u)=>l+u.duration_min,0),r={low:1,medium:2,high:3,very_high:4},a={1:"low",2:"medium",3:"high",4:"very_high"},o=e.reduce((l,u)=>l+r[u.intensity],0)/e.length,c=a[Math.round(o)],n={};e.forEach(l=>{n[l.type]=(n[l.type]||0)+1});const h=Object.entries(n).sort(([,l],[,u])=>u-l)[0]?.[0],m=e.length>0?new Date(e[0].timestamp):void 0;return{totalCalories:t,activitiesCount:e.length,totalDuration:i,averageIntensity:c,mostFrequentType:h,lastActivityTime:m}}async function P(e,t=10){s.info("ACTIVITIES_REPO","Fetching recent activities",{userId:e,limit:t,timestamp:new Date().toISOString()});try{const{data:i,error:r}=await f.from("activities").select("*").eq("user_id",e).order("timestamp",{ascending:!1}).limit(t);if(r)throw s.error("ACTIVITIES_REPO","Failed to fetch recent activities",{error:r.message,errorCode:r.code,userId:e,limit:t,timestamp:new Date().toISOString()}),r;return s.info("ACTIVITIES_REPO","Recent activities fetched successfully",{userId:e,activitiesCount:i?.length||0,limit:t,timestamp:new Date().toISOString()}),i||[]}catch(i){throw s.error("ACTIVITIES_REPO","Exception during recent activities fetch",{error:i instanceof Error?i.message:"Unknown error",userId:e,limit:t,timestamp:new Date().toISOString()}),i}}async function R(e,t){s.info("ACTIVITIES_REPO","Deleting activity",{activityId:e,userId:t,timestamp:new Date().toISOString()});try{const{error:i}=await f.from("activities").delete().eq("id",e).eq("user_id",t);if(i)throw s.error("ACTIVITIES_REPO","Failed to delete activity",{error:i.message,errorCode:i.code,activityId:e,userId:t,timestamp:new Date().toISOString()}),i;s.info("ACTIVITIES_REPO","Activity deleted successfully",{activityId:e,userId:t,timestamp:new Date().toISOString()})}catch(i){throw s.error("ACTIVITIES_REPO","Exception during activity deletion",{error:i instanceof Error?i.message:"Unknown error",activityId:e,userId:t,timestamp:new Date().toISOString()}),i}}async function V(e,t,i,r=100){const a=t.toISOString(),o=i.toISOString();s.info("ACTIVITIES_REPO","Fetching user activities for date range",{userId:e,startDate:a,endDate:o,limit:r,timestamp:new Date().toISOString()});try{const{data:c,error:n}=await f.from("activities").select("*").eq("user_id",e).gte("timestamp",a).lte("timestamp",o).order("timestamp",{ascending:!1}).limit(r);if(n)throw s.error("ACTIVITIES_REPO","Failed to fetch user activities",{error:n.message,errorCode:n.code,userId:e,startDate:a,endDate:o,limit:r,timestamp:new Date().toISOString()}),n;return s.info("ACTIVITIES_REPO","User activities fetched successfully",{userId:e,activitiesCount:c?.length||0,startDate:a,endDate:o,limit:r,timestamp:new Date().toISOString()}),c||[]}catch(c){throw s.error("ACTIVITIES_REPO","Exception during user activities fetch",{error:c instanceof Error?c.message:"Unknown error",userId:e,startDate:a,endDate:o,limit:r,timestamp:new Date().toISOString()}),c}}function M(e){const t=[];return(!e.type||e.type.trim().length===0)&&t.push("Le type d'activité est requis"),(!e.duration_min||e.duration_min<=0)&&t.push("La durée doit être supérieure à 0 minutes"),e.duration_min&&e.duration_min>600&&t.push("La durée ne peut pas dépasser 10 heures (600 minutes)"),(!e.intensity||!["low","medium","high","very_high"].includes(e.intensity))&&t.push("L'intensité doit être low, medium, high ou very_high"),t.push("Les calories estimées doivent être supérieures ou égales à 0"),{isValid:t.length===0,errors:t}}const D=e=>{switch(e){case"high-performance":return"high";case"battery-saver":return"low";case"balanced":default:return"medium"}},E=()=>{const{mode:e,isPerformanceMode:t}=S(),i=D(e);return{mode:i,enableAnimations:i!=="low",enableComplexEffects:i==="high",animationDelay:i==="high"?.01:i==="medium"?.02:0,calendarDays:i==="high"?180:i==="medium"?90:60,enableRings:i==="high",enableParticles:i==="high",enableGlows:i!=="low",enableShimmers:i!=="low",enablePulseEffects:i!=="low",enableRotations:i==="high",maxActivitiesDisplayed:i==="high"?30:i==="medium"?20:10,chartPointsLimit:i==="high"?90:i==="medium"?60:30,staggerDelay:i==="high"?.15:i==="medium"?.08:0,transitionDuration:i==="high"?.5:i==="medium"?.3:.15}},x=({children:e,fallback:t,forceStatic:i=!1,animationType:r="standard",initial:a,animate:o,exit:c,transition:n,...h})=>{const m=E();if(i||!m.enableAnimations||r==="complex"&&!m.enableComplexEffects||r==="ring"&&!m.enableRings||r==="particle"&&!m.enableParticles||r==="rotation"&&!m.enableRotations){const p=t||g.jsx("div",{...h,children:e});return g.jsx(g.Fragment,{children:p})}const u=n?{...n,duration:typeof n=="object"&&"duration"in n?Math.min(n.duration,m.transitionDuration*2):m.transitionDuration,delay:typeof n=="object"&&"delay"in n?Math.min(n.delay,m.staggerDelay*2):m.animationDelay}:{duration:m.transitionDuration,delay:m.animationDelay};return g.jsx(v.div,{initial:a,animate:o,exit:c,transition:u,...h,children:e})},y={course:{low:6,medium:8,high:10,very_high:12},marche:{low:2.5,medium:3.5,high:4.5,very_high:5},vélo:{low:4,medium:6,high:8,very_high:10},musculation:{low:3,medium:4,high:5,very_high:6},yoga:{low:2,medium:2.5,high:3,very_high:3.5},natation:{low:4,medium:6,high:8,very_high:10},football:{low:4,medium:6,high:8,very_high:10},tennis:{low:4,medium:5.5,high:7,very_high:8.5},danse:{low:3,medium:4.5,high:6,very_high:7.5},étirements:{low:2,medium:2.5,high:3,very_high:3.5},default:{low:3,medium:4,high:5,very_high:6}};function F(e,t,i,r){const a=e.toLowerCase();let o=y.default[t]||4;for(const[n,h]of Object.entries(y))if(a.includes(n)){o=h[t]||h.medium;break}const c=i/60;return Math.round(o*r*c)}function L(e){switch(e){case"low":return"#22C55E";case"medium":return"#F59E0B";case"high":return"#EF4444";case"very_high":return"#DC2626";default:return"#3B82F6"}}function j(e){const t=e.toLowerCase();return t.includes("course")||t.includes("running")||t.includes("marche")||t.includes("walk")||t.includes("vélo")||t.includes("bike")||t.includes("natation")||t.includes("swim")?"Activity":t.includes("musculation")?"Dumbbell":t.includes("yoga")?"Smile":t.includes("football")||t.includes("sport")||t.includes("tennis")?"Target":t.includes("danse")||t.includes("étirement")?"Smile":"Zap"}function k(e){switch(e){case"low":return"Faible";case"medium":return"Modérée";case"high":return"Intense";case"very_high":return"Très Intense";default:return"Modérée"}}export{x as C,P as a,L as b,b as c,R as d,j as e,A as f,V as g,k as h,F as i,E as u,M as v};
