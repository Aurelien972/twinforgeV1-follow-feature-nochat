const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-CiWuMMFg.js","assets/vendor-ZbFMzY-i.js","assets/utils-CUtLAp28.js","assets/supabase-8_3juhcZ.js","assets/page-fridge-C1QVLxk9.js","assets/stores-ZZM8MTtI.js","assets/ui-components-OHztaiDj.js","assets/motion-HGAT--uT.js","assets/page-fridge-scan-C_CisW7P.js","assets/page-fridge-scan-DAz6gEg3.css","assets/ui-components-DyoLTZgZ.css","assets/date-utils-BlBdbPk_.js","assets/Profile-CMifN9PE.js","assets/useScrollMemory-C-cdMoIK.js","assets/page-profile-C7_QN5um.js","assets/forms-CBZzt5O6.js","assets/ActivityPage-CaiOTAcc.js","assets/ActivityUtils-DMO4ntjB.js","assets/ActivityUtils-vW79nMDp.css","assets/debugFlags-CvPyqWqQ.js","assets/FastingPage-puzV9aqJ.js","assets/FastingTipsCard-bR9ecz7z.js","assets/MealsPage-fs9S7XA9.js","assets/ScanExitConfirmationModal-BZoIYo53.js","assets/signedUrlService-DzLcvpbH.js","assets/MealScanFlowPage-CikJF8sN.js","assets/MealScanFlowPage-D1lXSlqb.css","assets/FridgePage-2mQ4-Lf1.js","assets/TrainingPage-Dexnht3V.js","assets/UnderConstructionCard-BQRkWnue.js","assets/SettingsPage-BoYOvMx4.js","assets/mobileDetection-qVCXVKdX.js","assets/SettingsPage--eX8c2e1.css","assets/NotificationsPage-CJ1_o47Z.js","assets/BodyScanPage-BRFZ-ez0.js","assets/AvatarPage-D9I4j2Zs.js","assets/Avatar3DViewer-Br1Jt5km.js","assets/normalizeSkinTone---q_oCYc.js","assets/BodyScan-Kym80jXU.js","assets/useBodyScanPerformance-CZTD3PbH.js","assets/BodyScanProgressHeader-DadWtsli.js","assets/BodyScanProgressHeader-CAnPdp96.css","assets/BodyScanCelebrationWithHeader-p06eLcKp.js","assets/BodyScanReviewWithHeader-CgdfS4-T.js","assets/ActivityInputPage-C8ksJB44.js","assets/ActivityInputPage-BrlLrD1Y.css","assets/FastingInputPage-C55IFaFv.js","assets/FridgeScanPage-CjBENrmk.js","assets/VitalPage-CsYfC_EZ.js","assets/DevCachePage-D05lnEjv.js","assets/LogoGalleryPage-DMtFP24D.js"])))=>i.map(i=>d[i]);
var xe=Object.defineProperty;var fe=(a,t,i)=>t in a?xe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;var Q=(a,t,i)=>fe(a,typeof t!="symbol"?t+"":t,i);import{l,u as Y,f as be,b as ve,h as ye,t as we,d as Se,a as ie,s as U,e as je,P as Ee,_}from"./page-fridge-C1QVLxk9.js";import{R as C,r as o,j as e,u as q,h as J,cO as Ae,cP as _e,cQ as Ne,cR as Ce,cS as ke,cT as Ie,cU as Te,cV as Pe}from"./vendor-ZbFMzY-i.js";import{L as Oe,T as ae,S as P,I,B as De,M as Re,g as Le,c as Z,n as ze,d as Ue,e as Fe,u as ce,f as We,U as Be,h as Me,W as $e,F as He,i as Ve,D as Ye,j as qe,k as Ge,l as Ke,m as Qe,G as se}from"./ui-components-OHztaiDj.js";import{i as G,Z as Ze,a as V,d as Je,c as Xe,l as oe}from"./stores-ZZM8MTtI.js";import{a as et}from"./utils-CUtLAp28.js";import{m as O,u as tt,A as re}from"./motion-HGAT--uT.js";import{w as X}from"./page-fridge-scan-C_CisW7P.js";import{d as M}from"./page-profile-C7_QN5um.js";import"./date-utils-BlBdbPk_.js";import"./supabase-8_3juhcZ.js";import"./forms-CBZzt5O6.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const p of r.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();function at(){const[a,t]=C.useState(!1),[i,n]=C.useState(!1),[s,r]=C.useState(null),[p,f]=C.useState(null);return o.useEffect(()=>{if(!("serviceWorker"in navigator)){l.info("PWA_UPDATE","Service Worker not supported",{userAgent:navigator.userAgent.substring(0,100),timestamp:new Date().toISOString()});return}const m=u=>{const b=u.waiting;b&&(f(b),t(!0),r({version:"Nouvelle version",features:["Améliorations de performance","Nouvelles fonctionnalités","Corrections de bugs"],isRequired:!1}),l.info("PWA_UPDATE","Service Worker update detected",{swState:b.state,timestamp:new Date().toISOString()}))},d=()=>{l.info("PWA_UPDATE","Service Worker controller changed",{timestamp:new Date().toISOString()}),window.location.reload()};return navigator.serviceWorker.getRegistration().then(u=>{u&&(u.addEventListener("updatefound",()=>{const b=u.installing;b&&b.addEventListener("statechange",()=>{b.state==="installed"&&navigator.serviceWorker.controller&&m(u)})}),u.waiting&&m(u))}),navigator.serviceWorker.addEventListener("controllerchange",d),navigator.serviceWorker.addEventListener("message",u=>{try{const b=typeof u.data=="string"?JSON.parse(u.data):u.data;b&&b.type==="UPDATE_AVAILABLE"&&(t(!0),r(b.updateInfo||null),l.info("PWA_UPDATE","Update message received from Service Worker",{updateInfo:b.updateInfo,timestamp:new Date().toISOString()}))}catch(b){l.warn("PWA_UPDATE","Failed to parse service worker message",{error:b instanceof Error?b.message:"Unknown error",timestamp:new Date().toISOString()})}}),()=>{navigator.serviceWorker.removeEventListener("controllerchange",d)}},[]),{isUpdateAvailable:a,isUpdating:i,updateInfo:s,applyUpdate:async()=>{if(!p){l.warn("PWA_UPDATE","No waiting Service Worker available for update",{timestamp:new Date().toISOString()});return}n(!0);try{l.info("PWA_UPDATE","Applying Service Worker update",{swState:p.state,timestamp:new Date().toISOString()}),p.postMessage({type:"SKIP_WAITING"})}catch(m){l.error("PWA_UPDATE","Failed to apply update",{error:m instanceof Error?m.message:"Unknown error",timestamp:new Date().toISOString()}),n(!1)}},dismissUpdate:()=>{t(!1),r(null),f(null),l.info("PWA_UPDATE","Update notification dismissed",{timestamp:new Date().toISOString()})},checkForUpdates:()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(m=>{m&&(l.info("PWA_UPDATE","Manually checking for updates",{timestamp:new Date().toISOString()}),m.update())})}}}const rt=()=>{const{activeOverlayId:a,close:t}=G();o.useEffect(()=>{const i=n=>{if(n.key==="Escape"&&a!=="none"){l.debug("ESCAPE_KEY","Closing overlay",{overlayId:a}),t(),n.preventDefault(),n.stopPropagation();return}};return document.addEventListener("keydown",i,{capture:!0}),()=>{document.removeEventListener("keydown",i,{capture:!0})}},[a,t])},E=({title:a="Initialisation de TwinForge",subtitle:t="Préparation de votre espace de forge..."})=>e.jsx("div",{className:"flex items-center justify-center min-h-[400px] bg-transparent",children:e.jsx(Oe,{variant:"default",title:a,subtitle:t,showProgressBar:!1})}),it=()=>{const a=q(),{click:t,headerClick:i}=Y(),[n,s]=C.useState(!1),r=x=>{x.preventDefault(),l.trace("HEADER","Logo click triggered"),a("/",{replace:!0})},p=()=>{l.trace("HEADER","Logo pointer down"),i()},f=()=>{s(!0)},h=()=>{s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx("button",{onClick:r,onPointerDown:p,onMouseEnter:f,onMouseLeave:h,className:"focus-ring rounded-lg transition-colors cursor-pointer flex items-center justify-center h-full","aria-label":"Retour au tableau de bord",onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),r(x))},children:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(O.div,{className:"relative transition-all duration-300 ease-out",animate:n?{scale:1.05}:{scale:1},transition:{duration:.2,ease:[.25,.1,.25,1]},children:e.jsx(ae,{variant:"desktop",isHovered:n})})})})}),e.jsx("div",{className:"lg:hidden",children:e.jsx("button",{onClick:r,onPointerDown:p,onMouseEnter:f,onMouseLeave:h,className:"focus-ring rounded-lg transition-colors cursor-pointer flex items-center justify-center","aria-label":"Retour au tableau de bord",onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),r(x))},children:e.jsx(O.div,{className:"relative",animate:n?{scale:1.05}:{scale:1},transition:{duration:.2,ease:[.25,.1,.25,1]},children:e.jsx(ae,{variant:"mobile",isHovered:n})})})})]})},$=[{key:"navigation",title:"Navigation Principale",actions:[{id:"home",label:"Tableau de Bord",subtitle:"Vue d'ensemble TwinForge",icon:"Home",route:"/",color:"#F7931E",available:!0,description:"Retourner au tableau de bord principal"}]},{key:"alimentation",title:"Alimentation",actions:[{id:"scan-meal",label:"Scanner de Repas",subtitle:"Analysez vos repas",icon:"Camera",route:"/meals/scan",color:"#10B981",available:!0,description:"Analyser un repas avec précision"},{id:"generate-recipe",label:"Générateur de Recettes",subtitle:"Recettes personnalisées",icon:"ChefHat",route:"/fridge#recipes",color:"#EC4899",available:!0,description:"Générer des recettes personnalisées"},{id:"generate-meal-plan",label:"Générateur de Plans",subtitle:"Plan alimentaire hebdo",icon:"Calendar",route:"/fridge#plan",color:"#8B5CF6",available:!0,description:"Générer un plan de repas personnalisé"},{id:"generate-shopping-list",label:"Générateur de Courses",subtitle:"Liste optimisée",icon:"ShoppingCart",route:"/fridge#courses",color:"#F59E0B",available:!0,description:"Créer une liste de courses optimisée"},{id:"scan-fridge",label:"Scanner de Frigo",subtitle:"Inventaire intelligent",icon:"Scan",route:"/fridge/scan",color:"#06B6D4",available:!0,description:"Scanner votre frigo pour créer un inventaire"}]},{key:"activite",title:"Activité",actions:[{id:"coach-training",label:"Coach Training",subtitle:"Live Training",icon:"Dumbbell",route:"/training",color:"#18E3FF",available:!0,description:"Accéder à la pipeline de training avec coaching en direct"},{id:"track-activity",label:"Tracker d'Activité",subtitle:"Enregistrez vos séances",icon:"Activity",route:"/activity/input",color:"#3B82F6",available:!0,description:"Enregistrer une nouvelle séance d'activité"}]},{key:"sante",title:"Santé",actions:[{id:"start-fasting",label:"Tracker de Jeûne",subtitle:"Gérez vos sessions",icon:"Timer",route:"/fasting/input",color:"#F59E0B",available:!0,description:"Commencer une période de jeûne"},{id:"forge-vitale",label:"Forge Vitale",subtitle:"Bientôt disponible",icon:"HeartPulse",color:"#EF4444",available:!1,comingSoon:!0,description:"Suivi de santé complet (bientôt disponible)"}]},{key:"avatar-twin",title:"TwinForge Avatar",actions:[{id:"avatar-scan",label:"Mon Avatar en 3D",subtitle:"Créez votre jumeau numérique",icon:"Scan",route:"/body-scan",color:"#A855F7",available:!0,description:"Scanner et créer votre avatar 3D personnalisé"}]}];function nt(a){const t=a.replace("#",""),i=parseInt(t.length===3?t.split("").map(p=>p+p).join(""):t,16),n=i>>16&255,s=i>>8&255,r=i&255;return[n,s,r]}function H(a,t){return a.find(i=>i.key===t)||{title:"",actions:[]}}const de=({isOpen:a})=>{const t=q(),i=tt(),{click:n,success:s}=Y(),{close:r}=G(),p=H($,"alimentation"),f=H($,"activite"),h=H($,"sante"),x=H($,"navigation"),w=H($,"avatar-twin"),m=x.actions.find(c=>["home","dashboard","root"].includes(c.id)||/accueil|home|cœur|coeur|coeur de la forge|forge/i.test(c.label))||null,d=(c,N=!1,v)=>{if(!c?.available||c?.comingSoon){l.warn("CENTRAL_ACTIONS","Action not available",{actionId:c?.id,comingSoon:c?.comingSoon});return}l.info("CENTRAL_ACTIONS","Action clicked",{actionId:c.id,actionLabel:c.label,route:c.route,hasEvent:!!v}),c.id==="home"?ye():N?we(c.color):Se(c.color),r(),c.route?(l.info("CENTRAL_ACTIONS","Navigating to route",{actionId:c.id,actionLabel:c.label,route:c.route,timestamp:new Date().toISOString()}),setTimeout(()=>{l.info("CENTRAL_ACTIONS","Executing navigation",{route:c.route}),t(c.route)},100)):typeof c.onClick=="function"&&c.onClick()};C.useEffect(()=>{a?be():ve()},[a]),C.useEffect(()=>{if(!a)return;const c=y=>{if(y.target.closest('button[role="menuitem"]'))return;const D=document.querySelectorAll(".central-action-button, .user-panel-toggle"),R=document.querySelector(".central-actions-menu");let F=!1;D.forEach(L=>{L.contains(y.target)&&(F=!0)}),!F&&R&&!R.contains(y.target)&&r()},N=y=>{y.key==="Escape"&&r()},v=setTimeout(()=>{document.addEventListener("mousedown",c),document.addEventListener("keydown",N)},150);return()=>{clearTimeout(v),document.removeEventListener("mousedown",c),document.removeEventListener("keydown",N)}},[a,r]);const u=i?{duration:.2,ease:[.25,.1,.25,1]}:{type:"spring",stiffness:280,damping:22,mass:.9},b=({action:c,index:N})=>{const v=c.comingSoon||!c.available;return e.jsxs(O.button,{onClick:y=>d(c,!1,y),disabled:v,className:"glass-card rounded-xl px-2 py-1.5 flex items-center gap-1.5 w-full",style:{"--pill-circuit-color":c.color||"#18E3FF",opacity:v?.5:1,cursor:v?"not-allowed":"pointer",position:"relative",isolation:"isolate"},initial:{opacity:0,y:10},animate:{opacity:v?.5:1,y:0},transition:{...u,delay:i?0:N*.05},whileHover:i||v?{}:{},whileTap:i||v?{}:{},role:"menuitem","aria-label":c.description||c.label,"aria-disabled":v,children:[e.jsxs("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center flex-shrink-0",style:{position:"relative"},children:[e.jsx(P,{Icon:I[c.icon],size:13}),v&&e.jsx("div",{style:{position:"absolute",top:"-6px",right:"-6px",width:"16px",height:"16px",borderRadius:"50%",background:"linear-gradient(135deg, rgba(251, 146, 60, 0.95), rgba(251, 113, 133, 0.95))",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"7px",fontWeight:"bold",color:"white",boxShadow:"0 2px 8px rgba(251, 146, 60, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.3)",zIndex:20,pointerEvents:"none",border:"1.5px solid rgba(255, 255, 255, 0.4)"},children:"S"})]}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("div",{className:"text-[11px] font-semibold text-white leading-tight break-words",children:c.label}),c.subtitle&&e.jsx("div",{className:"text-[9px] text-white/65 leading-tight mt-0.5 break-words",children:c.subtitle})]})]},c.id)},A=window.innerWidth<768,k=window.innerWidth>=768&&window.innerWidth<1024,j={initial:{opacity:0,scale:.92,y:-20},animate:{opacity:1,scale:1,y:0,transition:{duration:.25,ease:[.25,.1,.25,1],opacity:{duration:.25},scale:{duration:.25},y:{duration:.25}}},exit:{opacity:0,scale:.94,y:-16,transition:{duration:.2,ease:[.25,.1,.25,1]}}};return e.jsx(re,{children:a&&e.jsx(O.div,{className:"central-actions-menu fixed",style:{zIndex:Ze.CENTRAL_MENU,transformOrigin:"top center",overflow:"visible",...A?{top:"80px",left:"8px",right:"8px",width:"auto",maxHeight:"calc(100vh - 96px - var(--new-bottom-bar-height) - var(--new-bottom-bar-bottom-offset))"}:k?{top:"80px",left:"16px",right:"16px",width:"auto",maxWidth:"calc(100vw - 32px)",maxHeight:"calc(100vh - 120px - var(--new-bottom-bar-height) - var(--new-bottom-bar-bottom-offset))"}:{top:"80px",right:"24px",left:"auto",width:"400px",maxHeight:"calc(100vh - 120px)"}},initial:j.initial,animate:j.animate,exit:j.exit,role:"dialog","aria-label":"Actions rapides","aria-modal":"true",children:e.jsx("div",{className:"rounded-3xl overflow-hidden relative central-actions-panel liquid-glass-premium max-h-[inherit]",style:{padding:12,isolation:"isolate",opacity:1,willChange:"transform, opacity"},children:e.jsxs("div",{className:"central-actions-scroll-container",style:{maxHeight:"inherit",overflowY:"auto",overflowX:"hidden"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-[3px] w-1 rounded-full",style:{background:"linear-gradient(180deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:"0 0 8px rgba(255, 255, 255, 0.5)"},"aria-hidden":!0}),e.jsx("span",{className:"text-white text-sm font-bold tracking-wider uppercase",children:"Outils du Forgeron"})]}),m&&e.jsxs("button",{onClick:c=>d(m,!1,c),className:"glass-card rounded-full px-2.5 py-1 flex items-center gap-1.5",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 60%),
                      radial-gradient(circle at 70% 70%, rgba(247, 147, 30, 0.15) 0%, transparent 65%),
                      var(--liquid-pill-bg)
                    `,border:"1px solid rgba(247, 147, 30, 0.35)",boxShadow:`
                      0 2px 8px rgba(247, 147, 30, 0.15),
                      0 0 16px rgba(247, 147, 30, 0.08),
                      inset 0 1px 0 rgba(255, 255, 255, 0.15)
                    `},children:[e.jsx(P,{Icon:I.Home,size:13,style:{color:"#FDC830",filter:"drop-shadow(0 0 4px rgba(253, 200, 48, 0.5))"}}),e.jsx("span",{className:"text-[10px] font-semibold",style:{color:"rgba(255, 255, 255, 0.95)",textShadow:"0 1px 2px rgba(0, 0, 0, 0.2)"},children:"Dashboard"})]})]}),p.actions.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"px-1.5 mb-1.5",children:e.jsx("h3",{className:"text-white/70 text-[11px] uppercase tracking-wider font-bold",children:"Alimentation"})}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:p.actions.map((c,N)=>e.jsx(b,{action:c,index:N},c.id))})]}),f.actions.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"px-1.5 mb-1.5",children:e.jsx("h3",{className:"text-white/70 text-[11px] uppercase tracking-wider font-bold",children:"Activité"})}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:f.actions.map((c,N)=>e.jsx(b,{action:c,index:N},c.id))})]}),h.actions.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"px-1.5 mb-1.5",children:e.jsx("h3",{className:"text-white/70 text-[11px] uppercase tracking-wider font-bold",children:"Santé"})}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:h.actions.map((c,N)=>e.jsx(b,{action:c,index:N},c.id))})]}),w.actions.length>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-white/10",children:w.actions.map((c,N)=>{const[v,y,g]=nt(c.color||"#D946EF");return e.jsxs(O.button,{onClick:D=>d(c,!0,D),className:"rounded-2xl px-4 py-3 flex items-center gap-3 w-full relative avatar-twin-button",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.12) 0%, transparent 60%),
                          radial-gradient(circle at 70% 70%, rgba(${v}, ${y}, ${g}, 0.15) 0%, transparent 65%),
                          rgba(255, 255, 255, 0.03)
                        `,backdropFilter:"blur(20px) saturate(150%)",WebkitBackdropFilter:"blur(20px) saturate(150%)",border:`1px solid rgba(${v}, ${y}, ${g}, 0.4)`,boxShadow:`
                          0 4px 16px rgba(${v}, ${y}, ${g}, 0.25),
                          0 0 24px rgba(${v}, ${y}, ${g}, 0.15),
                          inset 0 1px 0 rgba(255, 255, 255, 0.2)
                        `},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{...u,delay:i?0:.3},whileHover:i?{}:{y:-2,scale:1.02},whileTap:i?{}:{scale:.98},role:"menuitem","aria-label":c.description||c.label,children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, rgba(${v}, ${y}, ${g}, 0.4), rgba(${v}, ${y}, ${g}, 0.25))`,border:`1px solid rgba(${v}, ${y}, ${g}, 0.5)`,boxShadow:`0 0 12px rgba(${v}, ${y}, ${g}, 0.3)`},children:e.jsx(P,{Icon:I[c.icon],size:20,style:{color:c.color,filter:`drop-shadow(0 0 6px rgba(${v}, ${y}, ${g}, 0.6))`}})}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("div",{className:"text-[13px] font-bold text-white leading-tight",children:c.label}),e.jsx("div",{className:"text-[10px] text-white/75 leading-tight mt-0.5",children:c.subtitle})]}),e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`rgba(${v}, ${y}, ${g}, 0.2)`,border:`1px solid rgba(${v}, ${y}, ${g}, 0.4)`},children:e.jsx(P,{Icon:I.ChevronRight,size:12,style:{color:c.color}})})]},c.id)})})]})})})})},ue=C.memo(()=>{const{click:a}=Y(),{isOpen:t,toggle:i}=G(),n=t("centralMenu"),{isPerformanceMode:s}=ie();return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:`
          header-liquid-glass h-[64px] z-9997-important will-change-transform-important position-fixed-important transform-gpu-important isolation-isolate-important contain-layout-style-paint-important
          fixed top-2 left-4 right-4 z-[9999]
          rounded-glass-lg
          ${s?"":"backdrop-blur-xl"}
          transition-all duration-300
        `,style:{left:"24px",right:"24px",top:"8px",borderRadius:"20px",overflow:"hidden",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",WebkitTransformStyle:"preserve-3d",transformStyle:"preserve-3d",WebkitPerspective:"1000px",perspective:"1000px",background:s?"rgb(11, 14, 23)":void 0,backgroundColor:s?"rgb(11, 14, 23)":void 0,backgroundImage:s?"none":void 0,backdropFilter:s?"none":void 0,WebkitBackdropFilter:s?"none":void 0,border:s?"1px solid rgba(255, 255, 255, 0.15)":void 0},role:"banner","aria-label":"TwinForge Pont de Commandement",children:e.jsxs("div",{className:"w-full h-full flex items-center justify-between gap-2 px-4 md:px-6",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-3",children:[e.jsx(De,{}),e.jsx(it,{})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsxs(O.button,{type:"button",className:"user-panel-toggle relative central-action-button",style:{width:"48px",height:"48px",borderRadius:"50%",position:"relative",overflow:"visible",padding:0,alignItems:"center",justifyContent:"center",display:"flex",background:n?"radial-gradient(circle at 30% 30%, rgba(247, 147, 30, 0.45) 0%, transparent 60%), linear-gradient(135deg, rgba(247, 147, 30, 0.35), rgba(255, 107, 53, 0.3))":"radial-gradient(circle at 30% 30%, rgba(247, 147, 30, 0.25) 0%, transparent 60%), linear-gradient(135deg, rgba(247, 147, 30, 0.2), rgba(255, 107, 53, 0.15))",border:n?"2px solid rgba(247, 147, 30, 0.6)":"2px solid rgba(247, 147, 30, 0.35)",backdropFilter:"blur(16px) saturate(150%)",WebkitBackdropFilter:"blur(16px) saturate(150%)",boxShadow:n?"0 0 0 1px rgba(255, 255, 255, 0.15) inset, 0 4px 32px rgba(247, 147, 30, 0.5), 0 2px 16px rgba(0, 0, 0, 0.25)":"0 0 0 1px rgba(255, 255, 255, 0.08) inset, 0 4px 24px rgba(247, 147, 30, 0.25), 0 2px 12px rgba(0, 0, 0, 0.2)",transition:"transform 280ms cubic-bezier(0.25, 0.1, 0.25, 1), background 180ms cubic-bezier(0.16, 1, 0.3, 1), box-shadow 180ms cubic-bezier(0.16, 1, 0.3, 1), border-color 180ms cubic-bezier(0.16, 1, 0.3, 1)",transform:"translateZ(0)",willChange:"transform, filter",cursor:"pointer"},"aria-label":"Ouvrir les outils du forgeron","aria-expanded":n,"aria-haspopup":"menu",onPointerDown:()=>a(),onClick:()=>i("centralMenu"),onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),a(),i("centralMenu"))},whileHover:{scale:1.08},whileTap:{scale:.95},children:[[0,1,2,3].map(r=>e.jsx("div",{style:{position:"absolute",width:"6px",height:"6px",borderRadius:"1.5px",background:"linear-gradient(135deg, #F7931E, rgba(255, 255, 255, 0.9))",boxShadow:"0 0 16px #F7931E",top:r<2?"2px":"auto",bottom:r>=2?"2px":"auto",left:r%2===0?"2px":"auto",right:r%2===1?"2px":"auto",zIndex:2,transform:r%2===0?"rotate(45deg)":"rotate(-45deg)",opacity:n?.7:.5}},r)),e.jsx(P,{Icon:I.Zap,size:22,style:{color:n?"#F7931E":"#FF9F40",filter:n?"drop-shadow(0 0 14px rgba(247, 147, 30, 0.9))":"drop-shadow(0 0 10px rgba(255, 159, 64, 0.6))"},"aria-hidden":"true"}),e.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:"radial-gradient(circle at center, rgba(247, 147, 30, 0.25) 0%, transparent 70%)",filter:"blur(10px)",zIndex:-1,pointerEvents:"none",opacity:n?.7:.4},"aria-hidden":"true"})]}),e.jsx(O.button,{type:"button",className:"user-panel-toggle relative lg:hidden",style:{width:"48px",height:"48px",borderRadius:"50%",position:"relative",overflow:"visible",padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 50%),
                  rgba(255, 255, 255, 0.10)
                `,border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(16px) saturate(140%)",WebkitBackdropFilter:"blur(16px) saturate(140%)",boxShadow:`
                  0 8px 24px rgba(0, 0, 0, 0.25),
                  0 2px 12px rgba(0, 0, 0, 0.18),
                  inset 0 1px 0 rgba(255, 255, 255, 0.12)
                `,transition:"transform 280ms cubic-bezier(0.25, 0.1, 0.25, 1), background 180ms cubic-bezier(0.16, 1, 0.3, 1), box-shadow 180ms cubic-bezier(0.16, 1, 0.3, 1), border-color 180ms cubic-bezier(0.16, 1, 0.3, 1)",transform:"translateZ(0)",willChange:"transform, filter",cursor:"pointer"},onMouseEnter:r=>{window.matchMedia("(hover: hover)").matches&&(r.currentTarget.style.background=`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                    rgba(255, 255, 255, 0.10)
                  `,r.currentTarget.style.borderColor="rgba(255,255,255,0.3)",r.currentTarget.style.boxShadow=`
                    0 8px 24px rgba(0, 0, 0, 0.25),
                    0 2px 12px rgba(0, 0, 0, 0.18),
                    inset 0 1px 0 rgba(255, 255, 255, 0.12),
                    0 0 20px rgba(255,255,255,0.15),
                    0 4px 16px rgba(0,0,0,0.2)
                  `)},onMouseLeave:r=>{window.matchMedia("(hover: hover)").matches&&(r.currentTarget.style.background=`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 50%),
                    rgba(255, 255, 255, 0.10)
                  `,r.currentTarget.style.borderColor="rgba(255,255,255,0.2)",r.currentTarget.style.boxShadow=`
                    0 8px 24px rgba(0, 0, 0, 0.25),
                    0 2px 12px rgba(0, 0, 0, 0.18),
                    inset 0 1px 0 rgba(255, 255, 255, 0.12)
                  `)},"aria-label":"Ouvrir le menu de navigation principal","aria-expanded":t("mobileDrawer"),"aria-haspopup":"menu",onPointerDown:()=>a(),onClick:()=>{l.debug("HEADER","Mobile drawer toggle clicked"),i("mobileDrawer")},onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),a(),l.debug("HEADER","Mobile drawer toggle via keyboard"),i("mobileDrawer"))},whileHover:{scale:1.08},whileTap:{scale:.95},children:e.jsx(P,{Icon:I.Menu,size:20,style:{color:"rgba(255,255,255,0.9)",filter:"drop-shadow(0 0 8px rgba(247, 147, 30, 0.3))"},"aria-hidden":"true"})})]})]})}),e.jsx(Re,{}),e.jsx(de,{isOpen:n,onClose:()=>{}})]})});ue.displayName="Header";const pe=C.memo(({to:a,icon:t,label:i,subtitle:n,actionLabel:s,isPrimary:r=!1,isTwin:p=!1,isForge:f=!1,isActive:h,circuitColor:x,tabs:w,subItems:m,isExpanded:d,onToggleExpand:u})=>{const b=J(),A=I[t],k=x||Le(a),{sidebarClick:j}=Y(),c=m&&m.length>0,N=g=>{l.trace("SIDEBAR","NavItem click captured",{to:a,label:i,isActive:h}),l.trace("SIDEBAR","NavItem click triggered",{to:a,label:i,currentPath:window.location.pathname}),c&&(g.preventDefault(),u&&(u(),j()))},v=c&&m.some(g=>{const D=g.to.split("#")[0],R=g.to.split("#")[1],F=b.pathname,L=b.hash.replace("#","")||"daily";return F===D&&(!R||L===R)});b.pathname;let y="sidebar-item";return r?y="sidebar-item sidebar-item--primary":p?y="sidebar-item sidebar-item--twin":f&&(y="sidebar-item sidebar-item--forge"),e.jsxs("div",{className:"relative sidebar-nav-item-container",children:[e.jsxs(Z,{to:a,className:`
          ${y}
          ${c?"sidebar-item--with-submenu":""}
          group focus-ring
          ${h||v?"text-white shadow-sm":"text-white/70 hover:text-white"}
        `,onClick:N,onPointerDown:g=>{l.trace("SIDEBAR","NavItem pointer down",{to:a,label:i})},onMouseDown:g=>{l.trace("SIDEBAR","NavItem mouse down",{to:a,label:i})},"aria-current":h?"page":void 0,"aria-expanded":c?d:void 0,"aria-label":`${i} - ${n}`,role:r?"link":"menuitem",style:{"--item-circuit-color":k},children:[e.jsx("div",{className:`sidebar-item-icon-container ${h?"sidebar-item-icon-container--active":""}`,children:e.jsx(P,{Icon:A,size:r?22:p?20:18,className:`sidebar-item-icon ${h||v?"":"opacity-80 group-hover:opacity-100"}`,color:h||v?k:void 0,style:h||v?{color:k,filter:`drop-shadow(0 0 8px ${k}60)`}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium ${r?"text-base":p?"text-sm":"text-xs"} truncate ${h||v?"text-white":"text-white/82"}`,children:i}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate ${r?"mt-0.5":"mt-0"} ${h||v?"text-white/70":"text-white/50"}`,children:n})]}),f&&s&&!c&&e.jsx("div",{className:`sidebar-item-action-badge ${h?"sidebar-item-action-badge--active":""}`,children:s})]}),c&&e.jsx("div",{className:`sidebar-submenu ${d?"sidebar-submenu--expanded":""}`,role:"group","aria-label":`Sous-menu ${i}`,children:e.jsx("div",{className:"sidebar-submenu-inner",children:m.map(g=>{const D=I[g.icon],R=g.to.split("#")[0],F=g.to.split("#")[1],L=b.pathname,z=b.hash.replace("#","")||"daily",W=L===R&&(!F||z===F),K=g.isPrimarySubMenu&&L===R;return e.jsxs(Z,{to:g.to,className:`
                    sidebar-submenu-item
                    ${g.isPrimarySubMenu?"sidebar-submenu-item--primary":"sidebar-submenu-item--secondary"}
                    ${W||K?"sidebar-submenu-item--active":""}
                    focus-ring
                  `,onClick:()=>j(),"aria-current":W?"page":void 0,style:{"--item-circuit-color":g.color||k},children:[e.jsx("div",{className:`sidebar-submenu-item-icon-container ${W||K?"sidebar-submenu-item-icon-container--active":""}`,children:e.jsx(P,{Icon:D,size:g.isPrimarySubMenu?16:14,className:"sidebar-submenu-item-icon"})}),e.jsx("span",{className:"sidebar-submenu-item-label",children:g.label})]},g.to)})})})]})});pe.displayName="NavItem";const st=({title:a,type:t,children:i,isLastCategory:n})=>{const s=t==="forge-category",r=a==="Alimentation"||a==="Activité"||a==="Santé";return e.jsxs("div",{className:`space-y-1 ${s?"mt-4":""}`,children:[a&&e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"sidebar-category-separator"}),e.jsx("h3",{className:`sidebar-section-title ${ot(a,t)}`,role:"heading","aria-level":"3",children:a})]}),e.jsx("div",{className:"space-y-1",children:i})]})};function ot(a,t){if(t==="forge-category")return"sidebar-section--forge-category";switch(a){case"Rituels du Forgeron":return"sidebar-section--daily-tracking";case"Ateliers du Forgeron":return"sidebar-section--forge-tools";case"Mon Profil":return"sidebar-section--profile";default:return""}}const me=C.memo(({className:a=""})=>{const t=J(),i=q(),n=o.useCallback(m=>t.pathname===m,[t.pathname]),[s,r]=o.useState({}),[p,f]=o.useState(null),h=ze(),x=o.useCallback(async()=>{try{l.info("AUTH","Logout initiated"),await U.auth.signOut(),V.getState().setSession(null),V.getState().setProfile(null),l.info("AUTH","Logout successful, navigating to login"),i("/",{replace:!0})}catch(m){l.error("AUTH","Logout error",{error:m}),console.error("Logout error:",m),i("/",{replace:!0})}},[i]);C.useEffect(()=>{const m=t.pathname;let d=null;const u={};h.forEach(b=>{b.items.forEach(A=>{A.subItems&&A.subItems.length>0&&(A.subItems.some(j=>{const c=j.to.split("#")[0];return m===c})?(u[A.to]=!0,d=A.to):u[A.to]=!1)})}),r(u),f(d)},[t.pathname]),C.useEffect(()=>{l.trace("SIDEBAR","Component rendered",{currentPath:t.pathname})},[t.pathname]);const w=o.useCallback(m=>{r(d=>{if(d[m])return{...d,[m]:!1};const b={};return Object.keys(d).forEach(A=>{b[A]=!1}),b[m]=!0,f(m),b})},[]);return e.jsx("aside",{className:`hidden lg:flex flex-col ${a}
        sticky top-[88px] left-0
        h-[calc(100dvh-104px)]
        w-full
        sidebar-glass-enhanced rounded-2xl visionos-grid
      `,role:"complementary","aria-label":"Main navigation",children:e.jsxs("div",{className:"sidebar-content space-y-2 flex-1 pt-2",children:[h.map((m,d)=>e.jsxs(C.Fragment,{children:[e.jsx(st,{title:m.title,type:m.type,isLastCategory:d===h.length-1&&m.type==="forge-category",children:m.items.map(u=>e.jsx(pe,{to:u.to,icon:u.icon,label:u.label,subtitle:u.subtitle,actionLabel:u.actionLabel,isPrimary:u.isPrimary,isTwin:u.isTwin,isForge:u.isForge,isActive:n(u.to),circuitColor:u.circuitColor,tabs:u.tabs,subItems:u.subItems,isExpanded:s[u.to],onToggleExpand:()=>w(u.to)},u.to))}),m.type==="primary"&&e.jsx("div",{className:"sidebar-primary-separator","aria-hidden":"true"})]},m.title||m.type)),e.jsxs("div",{className:"mt-4 pt-2",children:[e.jsx("div",{className:"sidebar-category-separator mb-3"}),e.jsx("h3",{className:"sidebar-section-title text-white/50 text-xs uppercase tracking-wider font-semibold mb-1 px-1",children:"Compte"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"mb-2",children:e.jsx(Ue,{})}),e.jsxs(Z,{to:"/profile",className:`
                sidebar-item group focus-ring
                ${n("/profile")?"text-white shadow-sm":"text-white/70 hover:text-white"}
              `,style:{"--item-circuit-color":"#FDC830"},children:[e.jsx("div",{className:`sidebar-item-icon-container ${n("/profile")?"sidebar-item-icon-container--active":""}`,children:e.jsx(P,{Icon:I.User,size:18,className:`sidebar-item-icon ${n("/profile")?"":"opacity-80 group-hover:opacity-100"}`,style:n("/profile")?{color:"#FDC830",filter:"drop-shadow(0 0 8px rgba(253, 200, 48, 0.6))"}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium text-xs truncate ${n("/profile")?"text-white":"text-white/82"}`,children:"Mon Profil"}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate mt-0 ${n("/profile")?"text-white/70":"text-white/50"}`,children:"Infos personnelles"})]})]}),e.jsxs(Z,{to:"/settings",className:`
                sidebar-item group focus-ring
                ${n("/settings")?"text-white shadow-sm":"text-white/70 hover:text-white"}
              `,style:{"--item-circuit-color":"#FDC830"},children:[e.jsx("div",{className:`sidebar-item-icon-container ${n("/settings")?"sidebar-item-icon-container--active":""}`,children:e.jsx(P,{Icon:I.Settings,size:18,className:`sidebar-item-icon ${n("/settings")?"":"opacity-80 group-hover:opacity-100"}`,style:n("/settings")?{color:"#FDC830",filter:"drop-shadow(0 0 8px rgba(253, 200, 48, 0.6))"}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium text-xs truncate ${n("/settings")?"text-white":"text-white/82"}`,children:"Paramètres"}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate mt-0 ${n("/settings")?"text-white/70":"text-white/50"}`,children:"Configuration"})]})]})]}),e.jsx("div",{className:"sidebar-category-separator my-2"}),e.jsxs("button",{onClick:x,className:"sidebar-item group focus-ring text-white/70 hover:text-white w-full",style:{"--item-circuit-color":"#FF6B35",textAlign:"left"},children:[e.jsx("div",{className:"sidebar-item-icon-container",style:{background:"linear-gradient(135deg, rgba(255, 107, 53, 0.2), rgba(247, 147, 30, 0.15))",border:"1.5px solid rgba(255, 107, 53, 0.35)",boxShadow:"0 0 16px rgba(255, 107, 53, 0.18), inset 0 1px 0 rgba(255, 255, 255, 0.15)"},children:e.jsx(P,{Icon:I.LogOut,size:18,className:"sidebar-item-icon opacity-80 group-hover:opacity-100",style:{color:"#FF6B35",filter:"drop-shadow(0 0 6px rgba(255, 107, 53, 0.4))"}})}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("div",{className:"sidebar-item-label font-medium text-xs truncate text-white/82 text-left",children:"Déconnexion"}),e.jsx("div",{className:"sidebar-item-subtitle text-xxs truncate mt-0 text-white/50 text-left",children:"Se déconnecter"})]})]})]})]})})});me.displayName="Sidebar";const lt=[{id:"meal-scan",label:"Repas",icon:"Utensils",route:"/meals",color:"#10B981"},{id:"fridge-scan",label:"Frigo",icon:"Refrigerator",route:"/fridge",color:"#EC4899"},{id:"activity",label:"Activité",icon:"Activity",route:"/activity",color:"#3B82F6"},{id:"fasting",label:"Jeûne",icon:"Timer",route:"/fasting",color:"#F59E0B"},{id:"training",label:"Coaching",icon:"Dumbbell",route:"/training",color:"#06B6D4"},{id:"twin",label:"Twin",icon:"User",route:"/avatar",color:"#8B5CF6"}];function ct({button:a,active:t,onClick:i,hasUnread:n,unreadCount:s}){const r=()=>{je(a.color,t),i()};return e.jsxs(O.button,{onClick:r,className:"new-bottom-bar-button",style:{"--button-color":a.color,"--button-active":t?"1":"0"},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-current":t?"page":void 0,"aria-label":`Aller à ${a.label}`,children:[e.jsx("div",{className:`new-bottom-bar-icon-container ${t?"new-bottom-bar-icon-container--active":""}`,children:e.jsx(P,{Icon:I[a.icon],size:20,style:{color:t?a.color:"rgba(255, 255, 255, 0.5)"}})}),e.jsx("div",{className:`new-bottom-bar-label ${t?"new-bottom-bar-label--active":""}`,children:a.label})]})}const dt=()=>{const{pathname:a}=J(),t=q(),{close:i}=G(),{isPerformanceMode:n}=ie(),s=p=>{p.route&&(window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{t(p.route),i()},100))},r=p=>p.route?a.startsWith(p.route):!1;return e.jsx(e.Fragment,{children:e.jsx("nav",{className:"new-mobile-bottom-bar","aria-label":"Navigation principale mobile",style:{position:"fixed",bottom:"var(--new-bottom-bar-bottom-offset)",left:"8px",right:"8px",zIndex:9996,background:n?"rgba(11, 14, 23, 0.95)":void 0,backdropFilter:n?"blur(10px)":void 0,WebkitBackdropFilter:n?"blur(10px)":void 0,border:n?"1px solid rgba(255, 255, 255, 0.1)":void 0,borderRadius:"20px"},children:e.jsx("div",{className:"new-mobile-bottom-bar-container",children:e.jsx("div",{className:"new-mobile-bottom-bar-buttons",children:lt.map(p=>e.jsx(ct,{button:p,active:r(p),onClick:()=>s(p)},p.id))})})})})};function ut(){const{isInstallable:a,isInstalled:t}=Fe(),{isUpdateAvailable:i,updateInfo:n,applyUpdate:s,dismissUpdate:r}=at(),{showToast:p}=ce(),f=J(),{isAnyOpen:h,isOpen:x,close:w}=G(),m=x("centralMenu");rt(),C.useEffect(()=>{const v=h();if(v){const y=document.body.style.overflow,g=document.body.style.position,D=document.body.style.width,R=document.body.style.height;return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.height="100%",l.debug("OVERLAY_BODY_LOCK","Body scroll locked",{anyOverlayOpen:v,timestamp:new Date().toISOString()}),()=>{document.body.style.overflow=y,document.body.style.position=g,document.body.style.width=D,document.body.style.height=R,l.debug("OVERLAY_BODY_UNLOCK","Body scroll unlocked",{timestamp:new Date().toISOString()})}}},[h]),C.useEffect(()=>{(()=>{try{document.documentElement.scrollTo(0,0),window.scrollTo(0,0);const y=document.getElementById("main-content");y&&y.scrollTo(0,0),document.querySelectorAll("[data-scroll-container]").forEach(D=>{D.scrollTo(0,0)})}catch(y){l.warn("APP_NAVIGATION","Scroll error",{error:y})}})(),l.debug("APP_NAVIGATION","Scroll to top on route change",{newPath:f.pathname,previousScrollY:window.scrollY,pwa:{isInstallable:a,isInstalled:t,isUpdateAvailable:i},timestamp:new Date().toISOString()})},[f.pathname]);const{isGenerating:d,isGeneratingDetailedRecipes:u,cancelDetailedRecipeGeneration:b}=Je(),{isOpen:A,showModal:k,hideModal:j}=Xe(),c=f.pathname.startsWith("/body-scan")||f.pathname.startsWith("/avatar"),N=f.pathname.startsWith("/body-scan")||f.pathname.startsWith("/avatar");return o.useEffect(()=>{const v=g=>{if(d||u)return g.preventDefault(),g.returnValue="",k({title:d?"Génération de plan en cours":"Génération de recettes en cours",message:d?"Votre plan alimentaire est en cours de génération. Êtes-vous sûr de vouloir quitter ?":"Les recettes détaillées sont en cours de génération. Êtes-vous sûr de vouloir quitter ?",processName:d?"Génération de Plan Alimentaire":"Génération de Recettes Détaillées",onConfirm:()=>{d&&oe(),u&&b(),j(),window.location.reload()},onCancel:j}),""},y=g=>{(d||u)&&(g.preventDefault(),window.history.pushState(null,"",window.location.href),k({title:d?"Génération de plan en cours":"Génération de recettes en cours",message:d?"Votre plan alimentaire est en cours de génération. Êtes-vous sûr de vouloir quitter ?":"Les recettes détaillées sont en cours de génération. Êtes-vous sûr de vouloir quitter ?",processName:d?"Génération de Plan Alimentaire":"Génération de Recettes Détaillées",onConfirm:()=>{d&&oe(),u&&b(),j(),window.history.back()},onCancel:j}))};return(d||u)&&(window.addEventListener("beforeunload",v),window.addEventListener("popstate",y),window.history.pushState(null,"",window.location.href)),()=>{window.removeEventListener("beforeunload",v),window.removeEventListener("popstate",y)}},[d,u,k,j,b]),e.jsxs("div",{className:"min-h-screen flex flex-col z-auto-important will-change-auto-important position-static-important transform-none-important filter-none-important perspective-none-important contain-none-important isolation-auto-important overflow-visible-important",style:{position:"relative",zIndex:0},children:[e.jsx(ue,{}),e.jsxs("div",{className:"flex-1 flex min-w-0 position-static-important overflow-visible-important transform-none-important filter-none-important perspective-none-important contain-none-important isolation-auto-important z-auto-important",children:[e.jsx("div",{className:"hidden lg:flex lg:flex-col lg:w-[240px] xl:w-[260px] shrink-0 ml-6 mr-3 pt-20",children:e.jsx(me,{})}),e.jsx("main",{id:"main-content",className:`flex-1 min-w-0 px-4 py-4 md:px-6 lg:px-6 xl:px-8 md:pb-4 pt-20 pb-32 ${c?"body-scan-page":""}`,style:{position:"relative",overflow:"visible",minHeight:"100dvh",WebkitOverflowScrolling:"touch",scrollBehavior:"smooth"},role:"main","aria-label":"Contenu principal de l'application",children:e.jsx("div",{className:et("w-full min-w-0",{"mx-auto":!N}),children:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Ae,{})})})})]}),a&&!t&&e.jsx(We,{variant:"floating",onInstallSuccess:()=>p({type:"success",title:"TwinForge installé !",message:"L'application est maintenant disponible sur votre écran d'accueil",duration:4e3})}),e.jsx(Be,{isVisible:i,onUpdate:async()=>{try{await s(),p({type:"success",title:"Mise à jour appliquée",message:"TwinForge redémarre avec la nouvelle version",duration:4e3})}catch(v){l.error("PWA_UPDATE","Failed to apply update",{error:v instanceof Error?v.message:"Unknown error",timestamp:new Date().toISOString()}),p({type:"error",title:"Erreur de mise à jour",message:"Impossible d'appliquer la mise à jour. Réessayez plus tard.",duration:4e3})}},onDismiss:r,updateInfo:n}),e.jsx(dt,{}),e.jsx(Me,{}),e.jsx($e,{}),e.jsx(de,{isOpen:m,onClose:w}),e.jsx(He,{}),e.jsx(Ve,{})]})}function pt(){return e.jsx(ut,{})}function ee(){}function mt({storage:a,key:t="REACT_QUERY_OFFLINE_CACHE",throttleTime:i=1e3,serialize:n=JSON.stringify,deserialize:s=JSON.parse,retry:r}){if(a){const p=f=>{try{a.setItem(t,n(f));return}catch(h){return h}};return{persistClient:gt(f=>{let h=f,x=p(h),w=0;for(;x&&h;)w++,h=r?.({persistedClient:h,error:x,errorCount:w}),h&&(x=p(h))},i),restoreClient:()=>{const f=a.getItem(t);if(f)return s(f)},removeClient:()=>{a.removeItem(t)}}}return{persistClient:ee,restoreClient:ee,removeClient:ee}}function gt(a,t=100){let i=null,n;return function(...s){n=s,i===null&&(i=_e.setTimeout(()=>{a(...n),i=null},t))}}const ht=({children:a})=>(C.useEffect(()=>{},[]),e.jsx(e.Fragment,{children:a}));class xt extends C.Component{constructor(){super(...arguments);Q(this,"state",{hasError:!1})}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(i,n){if(/Loading chunk [\d]+ failed/i.test(String(i?.message))){l.debug("Chunk loading failed, auto-retrying:",i);return}l.error("React error boundary caught error:",i,n)}render(){return this.state.hasError?this.props.fallback??e.jsx("div",{className:"p-6 text-sm text-red-300 bg-red-900/20 rounded-xl",children:"Une erreur est survenue. Recharge la page ou réessaie."}):this.props.children}}const ft=o.createContext(null);function bt({children:a}){const[t,i]=o.useState(new Map),n=o.useCallback(d=>d.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s]/g,"").trim(),[]),s=o.useCallback(d=>{const u=n(d);return t.get(u)||null},[t,n]),r=o.useCallback((d,u)=>{const b=n(d);i(A=>{const k=new Map(A),j=k.get(b),c={exerciseName:j?.exerciseName||d,queueId:u.queueId||j?.queueId||"",status:u.status||j?.status||"queued",imageUrl:u.imageUrl||j?.imageUrl,illustrationId:u.illustrationId||j?.illustrationId,timestamp:u.timestamp||j?.timestamp||Date.now()};return k.set(b,c),l.debug("ILLUSTRATION_CACHE","Updated cache",{exerciseName:d,status:c.status,hasImageUrl:!!c.imageUrl}),k})},[n]),p=o.useCallback(d=>{const u=n(d);i(b=>{const A=new Map(b);return A.delete(u),l.debug("ILLUSTRATION_CACHE","Removed from cache",{exerciseName:d}),A})},[n]),f=o.useCallback(d=>{const u=s(d);return u?.status==="queued"||u?.status==="generating"},[s]),h=o.useCallback(()=>new Map(t),[t]),x=o.useCallback(()=>{i(new Map),l.info("ILLUSTRATION_CACHE","Cache cleared")},[]),w=o.useCallback(()=>{const d={total:t.size,queued:0,generating:0,completed:0,failed:0};return t.forEach(u=>{switch(u.status){case"queued":d.queued++;break;case"generating":d.generating++;break;case"completed":d.completed++;break;case"failed":d.failed++;break}}),d},[t]),m={getCachedIllustration:s,setCachedIllustration:r,removeCachedIllustration:p,isGenerating:f,getAllCached:h,clearCache:x,getStats:w};return e.jsx(ft.Provider,{value:m,children:a})}function vt(){return o.useEffect(()=>{const a=M.getConfig(),t=M.getCapabilities();return document.documentElement.style.setProperty("--glass-blur-adaptive",`${a.glassBlur}px`),document.documentElement.style.setProperty("--animation-duration-adaptive",`${a.animationDuration}ms`),document.documentElement.classList.remove("perf-high","perf-medium","perf-low"),document.documentElement.classList.add(`perf-${t.performanceLevel}`),t.isMobile&&document.documentElement.classList.add("is-mobile"),a.enableShimmer||document.documentElement.classList.add("disable-shimmer"),a.enablePulse||document.documentElement.classList.add("disable-pulse"),a.enableGlow||document.documentElement.classList.add("disable-glow"),()=>{M.destroy()}},[]),{capabilities:M.getCapabilities(),config:M.getConfig()}}class yt{constructor(){Q(this,"syncInterval",null);Q(this,"syncInProgress",new Set)}async performAutoSync(t){try{l.info("WEARABLE_AUTO_SYNC","Starting automatic sync",{userId:t});const n=(await X.getConnectedDevices(t)).filter(r=>r.connected&&!r.revoked);if(n.length===0)return l.info("WEARABLE_AUTO_SYNC","No active devices to sync",{userId:t}),[];const s=[];for(const r of n){if(this.syncInProgress.has(r.id)){l.info("WEARABLE_AUTO_SYNC","Sync already in progress for device",{deviceId:r.id});continue}try{this.syncInProgress.add(r.id);const p=r.last_sync?new Date(r.last_sync):null,f=new Date,h=p?(f.getTime()-p.getTime())/(1e3*60*60):1/0;if(h<1){l.info("WEARABLE_AUTO_SYNC","Device synced recently, skipping",{deviceId:r.id,hoursSinceSync:h}),this.syncInProgress.delete(r.id);continue}l.info("WEARABLE_AUTO_SYNC","Triggering sync for device",{deviceId:r.id,provider:r.provider,hoursSinceSync:h}),await X.triggerSync(r.id);const{data:x,error:w}=await U.from("activities").select("id").eq("user_id",t).eq("wearable_device_id",r.id).gte("created_at",p?.toISOString()||new Date(0).toISOString());if(w)throw w;s.push({success:!0,deviceId:r.id,activitiesImported:x?.length||0,lastSyncTime:f.toISOString()}),l.info("WEARABLE_AUTO_SYNC","Sync completed successfully",{deviceId:r.id,activitiesImported:x?.length||0})}catch(p){l.error("WEARABLE_AUTO_SYNC","Sync failed for device",{deviceId:r.id,error:p}),s.push({success:!1,deviceId:r.id,activitiesImported:0,lastSyncTime:new Date().toISOString(),error:p instanceof Error?p.message:"Unknown error"})}finally{this.syncInProgress.delete(r.id)}}return s}catch(i){throw l.error("WEARABLE_AUTO_SYNC","Auto sync failed",{error:i,userId:t}),i}}startAutoSync(t,i=60){this.syncInterval&&(l.warn("WEARABLE_AUTO_SYNC","Auto sync already running, clearing previous interval"),this.stopAutoSync()),l.info("WEARABLE_AUTO_SYNC","Starting auto sync scheduler",{userId:t,intervalMinutes:i}),this.performAutoSync(t).catch(n=>{l.error("WEARABLE_AUTO_SYNC","Initial auto sync failed",{error:n})}),this.syncInterval=setInterval(()=>{this.performAutoSync(t).catch(n=>{l.error("WEARABLE_AUTO_SYNC","Scheduled auto sync failed",{error:n})})},i*60*1e3)}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,l.info("WEARABLE_AUTO_SYNC","Auto sync scheduler stopped"))}async checkForNewActivities(t,i){try{const s=(await X.getConnectedDevices(t)).find(h=>h.id===i);if(!s)throw new Error("Device not found");const r=s.last_sync?new Date(s.last_sync):new Date(0),{data:p,error:f}=await U.from("activities").select("id").eq("user_id",t).eq("wearable_device_id",i).gte("timestamp",r.toISOString());if(f)throw f;return p?.length||0}catch(n){throw l.error("WEARABLE_AUTO_SYNC","Failed to check for new activities",{error:n,userId:t,deviceId:i}),n}}async intelligentDataFusion(t,i,n){try{l.info("WEARABLE_AUTO_SYNC","Starting intelligent data fusion",{userId:t,manualActivityId:i,wearableActivityId:n});const{data:s,error:r}=await U.from("activities").select("*").eq("id",i).maybeSingle(),{data:p,error:f}=await U.from("activities").select("*").eq("id",n).maybeSingle();if(r||f)throw r||f;if(!s||!p)throw new Error("Activity not found");const h={...s},x=["hr_avg","hr_max","hr_min","hr_zone1_minutes","hr_zone2_minutes","hr_zone3_minutes","hr_zone4_minutes","hr_zone5_minutes","hrv_avg","hrv_rmssd","vo2max_est","distance_km","pace_avg","speed_avg","elevation_gain","cadence_avg","power_avg","calories_measured","recovery_score","training_effect","trimp_score"];x.forEach(d=>{p[d]!==null&&p[d]!==void 0&&(h[d]=p[d])});const{error:w}=await U.from("activities").update(h).eq("id",i);if(w)throw w;const{error:m}=await U.from("activities").delete().eq("id",n);if(m)throw m;l.info("WEARABLE_AUTO_SYNC","Data fusion completed successfully",{manualActivityId:i,wearableActivityId:n,fusedFields:x.filter(d=>h[d]!==null).length})}catch(s){throw l.error("WEARABLE_AUTO_SYNC","Data fusion failed",{error:s,userId:t,manualActivityId:i,wearableActivityId:n}),s}}}const te=new yt;function wt(a,t={}){const{enabled:i=!0,intervalMinutes:n=60}=t,{showToast:s}=ce(),r=C.useRef(s);C.useEffect(()=>{r.current=s},[s]),o.useEffect(()=>{if(!a||!i){l.info("AUTO_SYNC_HOOK","Auto sync not enabled",{userId:a,enabled:i});return}l.info("AUTO_SYNC_HOOK","Initializing auto sync",{userId:a,intervalMinutes:n}),te.startAutoSync(a,n);const f=setInterval(async()=>{try{const x=(await te.performAutoSync(a)).filter(m=>m.success),w=x.reduce((m,d)=>m+d.activitiesImported,0);w>0&&(r.current({type:"success",title:"Synchronisation réussie",message:`${w} nouvelle${w>1?"s":""} activité${w>1?"s":""} importée${w>1?"s":""}`,duration:5e3}),l.info("AUTO_SYNC_HOOK","Auto sync completed with new activities",{userId:a,totalActivities:w,devicesCount:x.length}))}catch(h){l.error("AUTO_SYNC_HOOK","Auto sync failed",{error:h,userId:a})}},n*60*1e3);return()=>{te.stopAutoSync(),clearInterval(f),l.info("AUTO_SYNC_HOOK","Auto sync stopped",{userId:a})}},[a,i,n])}const ne=new Ne({defaultOptions:{queries:{staleTime:10*60*1e3,gcTime:24*60*60*1e3,retry:1,refetchOnWindowFocus:!1,refetchOnMount:a=>{const t=a.queryKey;return!!(t.includes("meals-today")||t.includes("meals-week")||t.includes("meals-recent")||t.includes("daily-ai-summary"))},refetchOnReconnect:!1},mutations:{retry:1}}}),St=mt({storage:window.localStorage,key:"twinforge-react-query-cache",serialize:JSON.stringify,deserialize:a=>{try{const t=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?$/,n=JSON.parse(a,(s,r)=>{if(typeof r=="string"&&t.test(r)){const p=new Date(r);return isNaN(p.getTime())?r:p}return r});return n&&n.queries&&n.queries.forEach(s=>{s.state&&((s.state.dataUpdatedAt===null||s.state.dataUpdatedAt===void 0)&&(s.state.dataUpdatedAt=0),(s.state.fetchedAt===null||s.state.fetchedAt===void 0)&&(s.state.fetchedAt=0),typeof s.state.dataUpdatedAt=="number"&&isNaN(s.state.dataUpdatedAt)&&(s.state.dataUpdatedAt=0),typeof s.state.fetchedAt=="number"&&isNaN(s.state.fetchedAt)&&(s.state.fetchedAt=0))}),n}catch(t){return l.error("REACT_QUERY_PERSISTENCE","Failed to deserialize cache",{error:t instanceof Error?t.message:"Unknown error",timestamp:new Date().toISOString()}),null}}});let le=!1;const jt=async()=>{if(!le)try{l.info("REACT_QUERY_PERSISTENCE","Initializing cache persistence",{persisterKey:"twinforge-react-query-cache",storage:"localStorage",timestamp:new Date().toISOString()}),await ke({queryClient:ne,persister:St,maxAge:24*60*60*1e3,hydrateOptions:{defaultOptions:{queries:{staleTime:10*60*1e3}}},dehydrateOptions:{shouldDehydrateQuery:a=>{const t=a.queryKey,i=a.state;return i.fetchStatus==="fetching"?(l.debug("REACT_QUERY_PERSISTENCE","Skipping query in fetching state",{queryKey:t,fetchStatus:i.fetchStatus,timestamp:new Date().toISOString()}),!1):i.status==="error"?(l.debug("REACT_QUERY_PERSISTENCE","Skipping query with error state",{queryKey:t,status:i.status,timestamp:new Date().toISOString()}),!1):t.includes("fasting")||t.includes("meals-today")||t.includes("meals-week")||t.includes("meals-recent")||t.includes("meals-history")||t.includes("meals-month")?!1:t.includes("insights")||t.includes("progression")||t.includes("trend-analysis")||t.includes("daily-summary")?!0:!(t.includes("daily-ai-summary")||t.includes("daily")&&!t.includes("summary")||t.includes("profile"))}}}),le=!0,l.info("REACT_QUERY_PERSISTENCE","Cache persistence initialized successfully",{cacheSize:Object.keys(localStorage).filter(a=>a.startsWith("twinforge-react-query")).length,timestamp:new Date().toISOString()})}catch(a){l.error("REACT_QUERY_PERSISTENCE","Failed to initialize cache persistence",{error:a instanceof Error?a.message:"Unknown error",timestamp:new Date().toISOString()})}};function Et({children:a}){return vt(),e.jsx(e.Fragment,{children:a})}function At({children:a}){const{profile:t}=V();return wt(t?.id||null,{enabled:!0,intervalMinutes:60}),e.jsx(e.Fragment,{children:a})}function _t(){const{showAlert:a,recommendation:t,dismissAlert:i}=Ke();return!a||!t?null:e.jsx(Qe,{recommendation:t,onDismiss:i,onNavigateToSettings:i})}function ge({children:a}){return C.useEffect(()=>{jt()},[]),e.jsx(xt,{children:e.jsx(Ce,{client:ne,children:e.jsx(ht,{children:e.jsx(Ye,{children:e.jsxs(Ee,{children:[e.jsx(qe,{}),e.jsx(bt,{children:e.jsx(Ge,{children:e.jsx(Et,{children:e.jsxs(At,{children:[e.jsx(_t,{}),a]})})})})]})})})})})}const da=Object.freeze(Object.defineProperty({__proto__:null,AppProviders:ge,queryClient:ne},Symbol.toStringTag,{value:"Module"})),Nt=({onSuccess:a})=>{const[t,i]=o.useState(!1),[n,s]=o.useState(""),[r,p]=o.useState(""),[f,h]=o.useState(""),[x,w]=o.useState(!1),[m,d]=o.useState(!1),[u,b]=o.useState(null),{setSession:A,fetchProfile:k}=V(),{formSubmit:j,error:c,click:N,success:v}=Y(),y=q(),{mode:g}=ie(),D=o.useMemo(()=>{const S=g==="high-performance",T=g==="balanced";return{backdropFilter:S?"none":T?"blur(8px) saturate(140%)":"blur(32px) saturate(180%)",background:S?"rgba(255, 255, 255, 0.08)":T?`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-plasma-cyan) 10%, transparent) 0%, transparent 60%),
            rgba(255, 255, 255, 0.07)
          `:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-plasma-cyan) 14%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, rgba(255, 107, 53, 0.08) 0%, transparent 50%),
            radial-gradient(circle at 50% 50%, rgba(61, 19, 179, 0.06) 0%, transparent 70%),
            rgba(255, 255, 255, 0.06)
          `,boxShadow:S?"0 16px 48px rgba(0, 0, 0, 0.4)":T?`
            0 20px 56px rgba(0, 0, 0, 0.45),
            0 0 32px color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.2)
          `:`
            0 24px 64px rgba(0, 0, 0, 0.5),
            0 0 48px color-mix(in srgb, var(--color-plasma-cyan) 20%, transparent),
            0 0 96px color-mix(in srgb, var(--color-plasma-cyan) 12%, transparent),
            0 0 120px rgba(255, 107, 53, 0.08),
            inset 0 2px 0 rgba(255, 255, 255, 0.25),
            inset 0 -2px 0 rgba(0, 0, 0, 0.15)
          `,borderColor:S?"rgba(255, 255, 255, 0.2)":"color-mix(in srgb, var(--color-plasma-cyan) 30%, transparent)"}},[g]),R=o.useMemo(()=>g==="high-performance"?"none":g==="balanced"?"blur(12px) saturate(140%)":"blur(20px) saturate(160%)",[g]),F=o.useMemo(()=>g==="high-performance"?"none":g==="balanced"?"blur(8px) saturate(120%)":"blur(12px) saturate(130%)",[g]),L=o.useMemo(()=>g==="high-performance"?.3:g==="balanced"?.5:.8,[g]),z=g!=="high-performance",W=async()=>{d(!0),b(null),N();try{l.info("AUTH","Starting Google OAuth flow",{timestamp:new Date().toISOString()});const{data:S,error:T}=await U.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/`,queryParams:{access_type:"offline",prompt:"consent"}}});if(T)throw T;l.info("AUTH","Google OAuth redirect initiated",{timestamp:new Date().toISOString()})}catch(S){l.error("AUTH","Google authentication error",{error:S.message,timestamp:new Date().toISOString()}),c(),b(S.message||"Erreur lors de la connexion avec Google"),d(!1)}},K=async S=>{S.preventDefault(),w(!0),b(null),j();try{if(t){const{data:T,error:B}=await U.auth.signUp({email:n,password:r,options:{data:{display_name:f}}});if(B)throw B;T.session?(l.info("AUTH","User signed up successfully",{userId:T.session.user.id}),A(T.session),await k(),v(),setTimeout(()=>{y("/",{replace:!0})},500),a?.()):b("Veuillez vérifier votre email pour confirmer votre compte")}else{const{data:T,error:B}=await U.auth.signInWithPassword({email:n,password:r});if(B)throw B;l.info("AUTH","User signed in successfully",{userId:T.session.user.id}),A(T.session),await k(),v(),setTimeout(()=>{y("/",{replace:!0})},500),a?.()}}catch(T){l.error("AUTH","Authentication error",{error:T.message}),c(),b(T.message||"Erreur lors de l'authentification")}finally{w(!1)}},he=()=>{N(),i(!t),b(null)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-twinforge-visionos relative overflow-hidden",style:{position:"relative",zIndex:1,isolation:"isolate",background:`
          radial-gradient(circle at 20% 30%, rgba(24, 227, 255, 0.08) 0%, transparent 50%),
          radial-gradient(circle at 80% 70%, rgba(255, 107, 53, 0.06) 0%, transparent 50%),
          radial-gradient(circle at 50% 50%, rgba(61, 19, 179, 0.04) 0%, transparent 60%),
          linear-gradient(180deg, #0B0E17 0%, #0F1219 50%, #0B0E17 100%)
        `},children:e.jsx("div",{className:"w-full max-w-md mx-auto px-4 auth-form-wrapper",style:{position:"relative",zIndex:100,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto"},children:e.jsx(O.div,{initial:z?{opacity:0,y:30,scale:.95}:!1,animate:{opacity:1,y:0,scale:1},transition:{duration:L,ease:"easeOut"},style:{position:"relative",zIndex:101,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto"},children:e.jsxs(se,{className:"p-6 relative w-full auth-form-card",style:{position:"relative",zIndex:102,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto",...D},children:[e.jsx(O.div,{className:"flex flex-col items-center justify-center mb-6",initial:z?{opacity:0,y:-20}:!1,animate:{opacity:1,y:0},transition:{duration:L*.75,delay:z?.15:0},style:{position:"relative",zIndex:103,pointerEvents:"auto"},children:e.jsx(O.div,{initial:z?{opacity:0,scale:.95}:!1,animate:{opacity:1,scale:1},transition:{duration:L*.875,delay:z?.2:0,ease:"easeOut"},style:{filter:g==="quality"?"drop-shadow(0 0 16px color-mix(in srgb, var(--color-plasma-cyan) 25%, transparent)) drop-shadow(0 0 8px rgba(255, 255, 255, 0.1))":"drop-shadow(0 0 8px color-mix(in srgb, var(--color-plasma-cyan) 20%, transparent))"},children:e.jsx(ae,{variant:"desktop",isHovered:!1})})}),e.jsxs("div",{style:{position:"relative",zIndex:103,pointerEvents:"auto"},children:[e.jsx("h1",{className:"text-xl font-bold text-white mb-2 text-center",children:t?"Rejoindre TwinForge":"Connexion TwinForge"}),e.jsx("p",{className:"text-white/70 text-sm text-center mb-4",children:t?"Créez votre Forge Spatiale":"Accédez à votre Forge Spatiale"})]}),e.jsx("form",{onSubmit:K,className:"auth-form-interactive",style:{position:"relative",zIndex:104,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto"},children:e.jsxs(O.div,{initial:z?{opacity:0}:!1,animate:{opacity:1},transition:{duration:L*.75,delay:z?.3:0},style:{position:"relative",zIndex:105,pointerEvents:"auto"},children:[e.jsx(re,{mode:"wait",children:t&&e.jsxs(O.div,{className:"mb-4",initial:z?{opacity:0,height:0,y:-10}:!1,animate:{opacity:1,height:"auto",y:0},exit:z?{opacity:0,height:0,y:-10}:void 0,transition:{duration:L*.375},style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("label",{htmlFor:"displayName",className:"block text-white/90 text-sm font-medium mb-1",children:"Nom d'affichage"}),e.jsx("input",{id:"displayName",type:"text",value:f,onChange:S=>h(S.target.value),className:"glass-input w-full auth-input",placeholder:"Votre nom dans la forge",required:t,style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"text",userSelect:"auto",WebkitUserSelect:"auto"}})]},"displayName")}),e.jsxs("div",{className:"mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("label",{htmlFor:"email",className:"block text-white/90 text-sm font-medium mb-1",children:"Adresse email"}),e.jsx("input",{id:"email",type:"email",value:n,onChange:S=>s(S.target.value),className:"glass-input w-full auth-input",placeholder:"votre@email.com",required:!0,style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"text",userSelect:"auto",WebkitUserSelect:"auto"}})]}),e.jsxs("div",{className:"mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("label",{htmlFor:"password",className:"block text-white/90 text-sm font-medium mb-1",children:"Mot de passe"}),e.jsx("input",{id:"password",type:"password",value:r,onChange:S=>p(S.target.value),className:"glass-input w-full auth-input",placeholder:"Votre mot de passe sécurisé",required:!0,minLength:6,style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"text",userSelect:"auto",WebkitUserSelect:"auto"}})]}),e.jsx(re,{children:u&&e.jsx(O.div,{className:"mb-4",initial:z?{opacity:0,y:-10,scale:.95}:!1,animate:{opacity:1,y:0,scale:1},exit:z?{opacity:0,y:-10,scale:.95}:void 0,transition:{duration:L*.375},style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:e.jsx(se,{className:"p-3",style:{background:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.4)",backdropFilter:F,boxShadow:g==="high-performance"?"0 0 12px rgba(239, 68, 68, 0.25)":"0 0 20px rgba(239, 68, 68, 0.3)",position:"relative",zIndex:107,pointerEvents:"auto"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(P,{Icon:I.AlertTriangle,size:14,className:"text-red-300 mt-0.5"}),e.jsx("p",{className:"text-red-200 text-sm leading-relaxed",children:u})]})})})}),e.jsx("button",{type:"submit",disabled:x||m,className:"w-full auth-submit-button mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto",cursor:"pointer",background:`
                      linear-gradient(135deg,
                        color-mix(in srgb, var(--brand-primary) 80%, transparent),
                        color-mix(in srgb, var(--color-plasma-cyan) 60%, transparent)
                      )
                    `,backdropFilter:R,boxShadow:g==="high-performance"?"0 8px 24px color-mix(in srgb, var(--brand-primary) 30%, transparent), inset 0 2px 0 rgba(255,255,255,0.3)":g==="balanced"?`
                          0 10px 32px color-mix(in srgb, var(--brand-primary) 35%, transparent),
                          0 0 48px color-mix(in srgb, var(--brand-primary) 25%, transparent),
                          inset 0 2px 0 rgba(255,255,255,0.35)
                        `:`
                          0 12px 40px color-mix(in srgb, var(--brand-primary) 40%, transparent),
                          0 0 60px color-mix(in srgb, var(--brand-primary) 30%, transparent),
                          0 0 100px color-mix(in srgb, var(--color-plasma-cyan) 20%, transparent),
                          inset 0 3px 0 rgba(255,255,255,0.4)
                        `,border:"2px solid color-mix(in srgb, var(--brand-primary) 60%, transparent)",borderRadius:"999px",padding:"0.75rem 1.5rem",minHeight:"48px",color:"white",fontWeight:"bold",fontSize:"1rem",transition:"all 0.2s ease"},onMouseEnter:S=>{!x&&!m&&(S.currentTarget.style.transform="translateY(-2px) scale(1.02)")},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0) scale(1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[x?e.jsx(P,{Icon:I.Loader2,size:18,className:"text-white animate-spin"}):e.jsx(P,{Icon:t?I.UserPlus:I.LogIn,size:18,className:"text-white"}),e.jsx("span",{children:x||m?"Forge en cours...":t?"Créer ma Forge":"Accéder à ma Forge"})]})}),e.jsxs("div",{className:"flex items-center gap-4 my-4",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("div",{className:"flex-1 h-px bg-white/20"}),e.jsx("span",{className:"text-white/50 text-sm",children:"ou"}),e.jsx("div",{className:"flex-1 h-px bg-white/20"})]}),e.jsx("button",{type:"button",onClick:W,disabled:m||x,className:"w-full auth-google-button mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto",cursor:"pointer",background:`
                      linear-gradient(135deg,
                        rgba(255, 255, 255, 0.95),
                        rgba(248, 250, 252, 0.9)
                      )
                    `,backdropFilter:R,boxShadow:g==="high-performance"?"0 6px 24px rgba(0, 0, 0, 0.12), inset 0 1px 0 rgba(255,255,255,0.7)":g==="balanced"?"0 7px 28px rgba(0, 0, 0, 0.135), 0 0 32px rgba(255, 255, 255, 0.08), inset 0 1.5px 0 rgba(255,255,255,0.75)":`
                          0 8px 32px rgba(0, 0, 0, 0.15),
                          0 0 40px rgba(255, 255, 255, 0.1),
                          inset 0 2px 0 rgba(255,255,255,0.8)
                        `,border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"999px",padding:"0.75rem 1.5rem",minHeight:"48px",color:"#1f2937",fontWeight:"600",fontSize:"1rem",transition:"all 0.2s ease"},onMouseEnter:S=>{!x&&!m&&(S.currentTarget.style.transform="translateY(-2px) scale(1.02)")},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0) scale(1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[m?e.jsx(P,{Icon:I.Loader2,size:18,style:{color:"#1f2937"},className:"animate-spin"}):e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),e.jsx("span",{children:m?"Redirection...":t?"Créer un compte avec Google":"Se connecter avec Google"})]})}),e.jsx("div",{className:"text-center",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:e.jsx("button",{type:"button",onClick:he,disabled:x||m,className:"text-white/70 hover:text-white text-sm transition-colors auth-toggle-button",style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"pointer",background:"none",border:"none",padding:"0.5rem"},children:t?"Déjà un compte ? Se connecter":"Pas de compte ? Créer un compte"})})]})})]})})})})},Ct=o.lazy(()=>_(()=>import("./Home-CiWuMMFg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),kt=o.lazy(()=>_(()=>import("./Profile-CMifN9PE.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,10,11,13,14,15]))),It=o.lazy(()=>_(()=>import("./ActivityPage-CaiOTAcc.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,17,18,19]))),Tt=o.lazy(()=>_(()=>import("./FastingPage-puzV9aqJ.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,10,11,13,21,14,15]))),Pt=o.lazy(()=>_(()=>import("./MealsPage-fs9S7XA9.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,13,23,24]))),Ot=o.lazy(()=>_(()=>import("./MealScanFlowPage-CikJF8sN.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,23,24,26]))),Dt=o.lazy(()=>_(()=>import("./FridgePage-2mQ4-Lf1.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,10,11]))),Rt=o.lazy(()=>_(()=>import("./TrainingPage-Dexnht3V.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,10,11,29]))),Lt=o.lazy(()=>_(()=>import("./SettingsPage-BoYOvMx4.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,29,31,32]))),zt=o.lazy(()=>_(()=>import("./NotificationsPage-CJ1_o47Z.js"),__vite__mapDeps([33,1,2,3,4,5,6,7,8,9,10,11,29])));o.lazy(()=>_(()=>import("./BodyScanPage-BRFZ-ez0.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,29])));const Ut=o.lazy(()=>_(()=>import("./AvatarPage-D9I4j2Zs.js"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,9,10,11,13,36,31,24,37,19]))),Ft=o.lazy(()=>_(()=>import("./BodyScan-Kym80jXU.js"),__vite__mapDeps([38,1,2,3,4,5,6,7,8,9,10,11,39,24,37,40,41,14,15]))),Wt=o.lazy(()=>_(()=>import("./BodyScanCelebrationWithHeader-p06eLcKp.js"),__vite__mapDeps([42,1,2,3,4,5,6,7,8,9,10,11,39]))),Bt=o.lazy(()=>_(()=>import("./BodyScanReviewWithHeader-CgdfS4-T.js"),__vite__mapDeps([43,1,2,3,4,5,6,7,8,9,10,11,40,39,41,36,31,24,37,19]))),Mt=o.lazy(()=>_(()=>import("./ActivityInputPage-C8ksJB44.js"),__vite__mapDeps([44,1,2,3,4,5,6,7,8,9,10,11,17,18,45]))),$t=o.lazy(()=>_(()=>import("./FastingInputPage-C55IFaFv.js"),__vite__mapDeps([46,1,2,3,4,5,6,7,8,9,10,11,21]))),Ht=o.lazy(()=>_(()=>import("./FridgeScanPage-CjBENrmk.js"),__vite__mapDeps([47,1,2,3,4,5,6,7,8,9,10,11]))),Vt=o.lazy(()=>_(()=>import("./VitalPage-CsYfC_EZ.js"),__vite__mapDeps([48,1,2,3,4,5,6,7,8,9,10,11]))),Yt=o.lazy(()=>_(()=>import("./DevCachePage-D05lnEjv.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,10,11]))),qt=o.lazy(()=>_(()=>import("./LogoGalleryPage-DMtFP24D.js"),__vite__mapDeps([50,1,2,3,4,5,6,7,8,9,10,11])));function Gt({children:a}){const[t,i]=o.useState(!0),[n,s]=o.useState(!1),[r,p]=o.useState(null),f=o.useRef(!1),{setSession:h,setAuthReady:x}=V();return o.useEffect(()=>{if(f.current)return;f.current=!0,(async()=>{try{l.debug("AUTH","Starting authentication initialization");const{data:{session:d}}=await U.auth.getSession();d?.user?(l.debug("AUTH","Found existing session"),p(d.user),s(!1),h(d),x(!0)):(l.debug("AUTH","No session found, showing auth form"),s(!0),h(null),x(!1))}catch(d){l.error("AUTH","Error during initialization",{error:d}),s(!0),h(null),x(!1)}finally{i(!1)}})();const{data:{subscription:m}}=U.auth.onAuthStateChange((d,u)=>{if(l.debug("AUTH","Auth state changed",{event:d,hasSession:!!u}),d==="SIGNED_OUT"){l.info("AUTH","User signed out, redirecting to auth form"),p(null),s(!0),h(null),x(!1),i(!1);return}u?.user?(p(u.user),s(!1),h(u),x(!0)):(p(null),s(!0),h(null),x(!1)),i(!1)});return()=>m.unsubscribe()},[]),t?e.jsx(E,{title:"Bienvenue sur TwinForge",subtitle:"Vérification de votre session..."}):n?e.jsx(Nt,{onSuccess:()=>window.location.href="/"}):e.jsx(e.Fragment,{children:a})}const Kt=Ie([{path:"/",element:e.jsx(Gt,{children:e.jsx(pt,{})}),children:[{index:!0,element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Ct,{})})},{path:"profile",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(kt,{})})},{path:"meals",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Pt,{})})},{path:"meals/scan",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Ot,{})})},{path:"activity",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(It,{})})},{path:"activity/input",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Mt,{})})},{path:"fasting",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Tt,{})})},{path:"fasting/input",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx($t,{})})},{path:"fridge",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Dt,{})})},{path:"fridge/scan",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Ht,{})})},{path:"training",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Rt,{})})},{path:"settings",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Lt,{})})},{path:"notifications",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(zt,{})})},{path:"avatar",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Ut,{})})},{path:"body-scan",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Ft,{})})},{path:"body-scan/celebration",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Wt,{})})},{path:"body-scan/review",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Bt,{})})},{path:"vital",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Vt,{})})},{path:"dev/cache",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Yt,{})})},{path:"dev/logos",element:e.jsx(o.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(qt,{})})}]}]),Qt=!1,Zt=e.jsx(ge,{children:e.jsx(Pe,{router:Kt})});Te(document.getElementById("root")).render(Zt);l.info("APP","React app initialized",{strictMode:Qt,env:"production"});export{da as A,xt as E,E as L};
