const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/localActivityInsightsProcessor-DXlDgi_m.js","assets/page-fridge-C1QVLxk9.js","assets/vendor-ZbFMzY-i.js","assets/utils-CUtLAp28.js","assets/supabase-8_3juhcZ.js","assets/stores-ZZM8MTtI.js","assets/ui-components-OHztaiDj.js","assets/motion-HGAT--uT.js","assets/page-fridge-scan-C_CisW7P.js","assets/page-fridge-scan-DAz6gEg3.css","assets/ui-components-DyoLTZgZ.css","assets/date-utils-BlBdbPk_.js"])))=>i.map(i=>d[i]);
import{R as k,b as Z,e as Fe,cW as Le,u as X,j as e,cX as ke,c as He,r as Ge,h as Ye}from"./vendor-ZbFMzY-i.js";import{u as ie,G as I,S as m,I as o,P as Ue,a as ye,r as Ze,o as We,q as U}from"./ui-components-OHztaiDj.js";import{u as W,l as _,_ as Se,s as V,a as oe,g as Je}from"./page-fridge-C1QVLxk9.js";import{a as L,c as Be,m as ne}from"./stores-ZZM8MTtI.js";import{c as Ke,d as Xe,g as Qe,f as et,a as tt,u as te,C as O,b as H,e as Ee,h as Ae}from"./ActivityUtils-DMO4ntjB.js";import{s as le}from"./debugFlags-CvPyqWqQ.js";import{f as P,d as st,a as G,c as rt,p as ae,i as it,e as at}from"./date-utils-BlBdbPk_.js";import{m as A,A as Te}from"./motion-HGAT--uT.js";import"./utils-CUtLAp28.js";import"./supabase-8_3juhcZ.js";import"./page-fridge-scan-C_CisW7P.js";function nt(t=100){const{session:r}=L();return Z({queryKey:["activities","history",r?.user?.id,t],queryFn:async()=>{if(!r?.user?.id)throw new Error("User not authenticated");const s=new Date,i=new Date;return i.setDate(i.getDate()-30),Qe(r.user.id,i,s,t)},enabled:!!r?.user?.id,staleTime:5*60*1e3,gcTime:15*60*1e3,refetchOnWindowFocus:!1,retry:2})}function De(t="last7Days"){const{session:r,profile:s}=L();return Z({queryKey:["activities","insights",r?.user?.id,t],queryFn:async()=>{if(le()&&_.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","queryFn execution started",{userId:r?.user?.id,period:t,executionTime:new Date().toISOString(),reason:"react_query_triggered_execution",cacheStrategy:"edge_function_with_local_fallback",timestamp:new Date().toISOString()}),!r?.user?.id)throw new Error("User not authenticated");const i="https://kwipydbtjagypocpvbwn.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U";try{const h={weight_kg:s?.weight_kg||70,height_cm:s?.height_cm,sex:s?.sex,birthdate:s?.birthdate,activity_level:s?.activity_level,objective:s?.objective};le("activity")&&_.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","Attempting edge function call",{userId:r.user.id,period:t,endpoint:`${i}/functions/v1/activity-progress-generator`,timestamp:new Date().toISOString()});const x=await fetch(`${i}/functions/v1/activity-progress-generator`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({userId:r.user.id,period:t,userProfile:h,clientTraceId:`activity_insights_${Date.now()}`})});if(!x.ok){const c=await x.json().catch(()=>({}));if(x.status===400&&c.error==="Insufficient data")return _.info("ACTIVITY_INSIGHTS","Insufficient data for insights generation",{userId:r.user.id,period:t,requiredActivities:c.required_activities,currentActivities:c.current_activities,timestamp:new Date().toISOString()}),{insufficient_data:!0,required_activities:c.required_activities,current_activities:c.current_activities,message:c.message};throw new Error(`Edge function error: ${x.statusText}`)}const n=await x.json();let l=n.current_activities;l==null&&(l=n.summary?.total_activities||0);const p={...n,current_activities:l};return le("activity")&&_.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","Edge function call successful",{userId:r.user.id,period:t,insightsCount:n.insights?.length||0,currentActivities:l,cached:n.cached||!1,timestamp:new Date().toISOString()}),p}catch(h){_.warn("ACTIVITY_INSIGHTS_DIAGNOSTIC","Edge function failed, falling back to local processing",{userId:r.user.id,period:t,error:h instanceof Error?h.message:"Unknown error",fallbackStrategy:"local_insights_processor",timestamp:new Date().toISOString()});const{generateLocalActivityInsights:x}=await Se(async()=>{const{generateLocalActivityInsights:n}=await import("./localActivityInsightsProcessor-DXlDgi_m.js");return{generateLocalActivityInsights:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]));try{const n=await x(r.user.id,t,V);return _.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","Local fallback completed successfully",{userId:r.user.id,period:t,insightsCount:n.insights.length,currentActivities:n.current_activities,fallback:!0,timestamp:new Date().toISOString()}),n}catch(n){throw _.error("ACTIVITY_INSIGHTS_DIAGNOSTIC","Both edge function and local fallback failed",{userId:r.user.id,period:t,edgeFunctionError:h instanceof Error?h.message:"Unknown",localError:n instanceof Error?n.message:"Unknown",timestamp:new Date().toISOString()}),new Error("Impossible de générer les insights. Vérifiez votre connexion.")}}},enabled:!!r?.user?.id,staleTime:dt(t),gcTime:xt(t),refetchOnWindowFocus:!1,refetchOnMount:!0,retry:(i,a)=>a?.message?.includes("Insufficient data")?!1:i<1})}function ot(){const{session:t}=L(),r=new Date;return Z({queryKey:["activities","daily",t?.user?.id,P(r,"yyyy-MM-dd")],queryFn:()=>{if(!t?.user?.id)throw new Error("User not authenticated");return et(t.user.id,r)},enabled:!!t?.user?.id,staleTime:0,gcTime:10*60*1e3,refetchOnWindowFocus:!0,refetchOnMount:"always",retry:2})}function lt(){const{data:t,isLoading:r,error:s}=ot();return{data:k.useMemo(()=>t?Ke(t):null,[t]),isLoading:r,error:s,activities:t||[]}}function ze(t=10){const{session:r}=L();return Z({queryKey:["activities","recent",r?.user?.id,t],queryFn:()=>{if(!r?.user?.id)throw new Error("User not authenticated");return tt(r.user.id,t)},enabled:!!r?.user?.id,staleTime:0,gcTime:5*60*1e3,refetchOnMount:"always",retry:2})}function ct(){const{session:t}=L();return Z({queryKey:["activities","last",t?.user?.id],queryFn:async()=>{if(!t?.user?.id)throw new Error("User not authenticated");const{data:r,error:s}=await V.from("activities").select("*").eq("user_id",t.user.id).order("timestamp",{ascending:!1}).limit(1).maybeSingle();if(s)throw _.error("ACTIVITIES_REPO","Failed to fetch last activity",{error:s.message,userId:t.user.id,timestamp:new Date().toISOString()}),s;return r||null},enabled:!!t?.user?.id,staleTime:2*60*1e3,gcTime:5*60*1e3,retry:2})}function $e(){const{session:t}=L(),{showToast:r}=ie(),{success:s,error:i}=W(),a=Fe();return Le({mutationFn:async h=>{if(!t?.user?.id)throw new Error("User not authenticated");if(!h||h.trim().length===0)throw new Error("ID d'activité invalide");return await Xe(h,t.user.id),h},onSuccess:h=>{s(),r({type:"success",title:"Activité supprimée",message:"L'activité a été supprimée avec succès",duration:3e3}),a.invalidateQueries({queryKey:["activities","daily",t?.user?.id]}),a.invalidateQueries({queryKey:["activities","recent",t?.user?.id]}),a.invalidateQueries({queryKey:["activities","stats",t?.user?.id]}),_.info("ACTIVITIES_HOOK","Activity deleted successfully",{activityId:h,userId:t?.user?.id,timestamp:new Date().toISOString()})},onError:h=>{i(),r({type:"error",title:"Erreur de suppression",message:h instanceof Error?h.message:"Impossible de supprimer l'activité",duration:4e3}),_.error("ACTIVITIES_HOOK","Failed to delete activity",{error:h instanceof Error?h.message:"Unknown error",userId:t?.user?.id,timestamp:new Date().toISOString()})}})}function Me(){const{session:t}=L();return Z({queryKey:["activities","has-history",t?.user?.id],queryFn:async()=>{if(!t?.user?.id)return!1;const{data:r,error:s}=await V.from("activities").select("id").eq("user_id",t.user.id).limit(1);return s?(_.error("ACTIVITIES_REPO","Failed to check activity history",{error:s.message,userId:t.user.id,timestamp:new Date().toISOString()}),!1):(r?.length||0)>0},enabled:!!t?.user?.id,staleTime:0,refetchOnMount:"always",retry:1})}function Y(t){switch(t){case"last7Days":return 3;case"last30Days":return 8;case"last3Months":return 20;case"last6Months":return 35;case"last1Year":return 60;default:return 8}}function dt(t){switch(t){case"last7Days":return 1e3*60*60*12;case"last30Days":return 1e3*60*60*72;case"last3Months":return 1e3*60*60*168;case"last6Months":return 1e3*60*60*336;case"last1Year":return 1e3*60*60*720;default:return 1e3*60*60*12}}function xt(t){switch(t){case"last7Days":return 7*24*60*60*1e3;case"last30Days":return 14*24*60*60*1e3;case"last3Months":return 30*24*60*60*1e3;case"last6Months":return 60*24*60*60*1e3;case"last1Year":return 90*24*60*60*1e3;default:return 7*24*60*60*1e3}}function Oe(t){if(!t)return 1/0;const r=typeof t=="string"?new Date(t):t;return st(new Date,r)}function Pe(t){if(!t)return 1/0;const r=typeof t=="string"?new Date(t):t;return rt(new Date,r)}function ce(t){if(!t)return"jamais";const r=typeof t=="string"?new Date(t):t,s=Oe(r);return Pe(r)<1?"il y a quelques instants":s===0?`aujourd'hui à ${P(r,"HH:mm")}`:s===1?`hier à ${P(r,"HH:mm")}`:s<=6?`il y a ${s} jours`:P(r,"dd MMM yyyy",{locale:G})}function mt(t,r){const s=Oe(r?.timestamp||null),i=(t?.activitiesCount||0)>0,a=t?.activitiesCount||0,h=t?.totalCalories||0;let x="none",n="";return r?s===0&&i?a===1?(x="low",n=`Dernière activité: ${ce(r.timestamp)}`):(x="none",n=`${a} activités aujourd'hui - Excellent rythme !`):s===0&&!i?Pe(r.timestamp)<6?(x="low",n=`Dernière activité: ${ce(r.timestamp)}`):(x="medium",n=`Dernière activité: ${ce(r.timestamp)}`):s===1?(x="medium",n="Dernière activité: hier - Reprenez votre rythme aujourd'hui !"):s<=3?(x="high",n=`Cela fait ${s} jours sans activité - Il est temps de bouger !`):s<=7?(x="high",n=`${s} jours d'inactivité - Votre corps a besoin de mouvement !`):(x="critical",n=`Plus de ${s>14?"2 semaines":`${s} jours`} sans activité - Recommencez en douceur !`):(x="critical",n="Vous n'avez pas encore enregistré d'activité. Commencez votre voyage énergétique !"),{daysSinceLastActivity:s,hasActivitiesThisWeek:s<=7,hasActivitiesToday:i,totalActivitiesToday:a,totalCaloriesToday:h,lastActivityDate:r?new Date(r.timestamp):null,lastActivityType:r?.type||null,urgencyLevel:x,contextMessage:n}}function ut(t){const{urgencyLevel:r,daysSinceLastActivity:s,hasActivitiesToday:i,totalActivitiesToday:a,contextMessage:h,lastActivityType:x}=t;return r==="critical"&&s===1/0?{title:"Commencez votre voyage énergétique",subtitle:h,buttonText:"Enregistrer ma première activité",encouragement:"Chaque grand voyage commence par un premier pas"}:r==="critical"&&s>7?{title:"Reprenez le contrôle de votre énergie",subtitle:h,buttonText:"Reprendre en douceur",encouragement:"Il n'est jamais trop tard pour recommencer"}:r==="high"&&s>=2?{title:"Votre corps attend du mouvement",subtitle:h,buttonText:"Forger mon énergie maintenant",encouragement:"Brisez la routine sédentaire avec une session aujourd'hui"}:r==="medium"&&s===1?{title:"Maintenez votre dynamique",subtitle:"Dernière activité: hier - Ne perdez pas votre élan !",buttonText:"Continuer ma progression",encouragement:"La régularité est la clé du succès"}:i&&a===1?{title:"Excellente session aujourd'hui !",subtitle:`Dernière activité: ${x||"enregistrée"} - Ajoutez-en une autre ?`,buttonText:"Ajouter une session",encouragement:"Doublez votre impact énergétique aujourd'hui"}:i&&a>=2?{title:"Journée énergétique exceptionnelle !",subtitle:`${a} activités aujourd'hui - Performance remarquable`,buttonText:"Ajouter une activité",encouragement:"Vous êtes sur une lancée formidable !"}:r==="low"&&s===0?{title:"Gardez votre élan du jour",subtitle:h,buttonText:"Enregistrer une activité",encouragement:"Profitez de votre dynamique actuelle"}:r==="medium"&&s===0?{title:"Forgez votre énergie aujourd'hui",subtitle:h,buttonText:"Enregistrer une activité",encouragement:"Il est encore temps de bouger aujourd'hui"}:{title:"Forgez votre énergie",subtitle:"Enregistrez votre prochaine session d'activité",buttonText:"Enregistrer une activité",encouragement:"Chaque mouvement compte pour votre bien-être"}}function pt(t){const{urgencyLevel:r,daysSinceLastActivity:s,totalActivitiesToday:i}=t;switch(r){case"critical":return{priority:"critical",color:"#EF4444",icon:"AlertTriangle",animation:"pulse",particleCount:8};case"high":return{priority:"high",color:"#F59E0B",icon:"Zap",animation:"pulse",particleCount:6};case"medium":return{priority:"medium",color:"#06B6D4",icon:"Activity",animation:"breathing",particleCount:4};case"low":return{priority:"low",color:"#3B82F6",icon:"TrendingUp",animation:"breathing",particleCount:2};case"none":default:return{priority:"none",color:"#22C55E",icon:"Target",animation:"none",particleCount:0}}}function ht(t){const r=[];return t?.totalCalories>0&&r.push(`${t.totalCalories} kcal brûlées`),t?.totalDuration>0&&r.push(`${t.totalDuration} min actives`),t?.activitiesCount>0&&r.push(`${t.activitiesCount} activité${t.activitiesCount>1?"s":""}`),r}const gt=({todayStats:t,profile:r})=>{const s=X(),{click:i}=W(),a=te(),{data:h}=ct();k.useEffect(()=>{_.info("DYNAMIC_ACTIVITY_CTA_DIAGNOSTIC","CTA render state",{hasTodayStats:!!t,todayActivitiesCount:t?.activitiesCount||0,todayTotalCalories:t?.totalCalories||0,hasLastActivity:!!h,lastActivityTimestamp:h?.timestamp,lastActivityType:h?.type,timestamp:new Date().toISOString()})},[t,h]);const x=k.useMemo(()=>{const b=mt(t||null,h);return _.info("DYNAMIC_ACTIVITY_CTA_DIAGNOSTIC","Activity context analyzed",{urgencyLevel:b.urgencyLevel,daysSinceLastActivity:b.daysSinceLastActivity,hasActivitiesToday:b.hasActivitiesToday,totalActivitiesToday:b.totalActivitiesToday,hasActivitiesThisWeek:b.hasActivitiesThisWeek,contextMessage:b.contextMessage,timestamp:new Date().toISOString()}),b},[t,h]),n=k.useMemo(()=>ut(x),[x]),l=k.useMemo(()=>pt(x),[x]),p=ht(t),c=(t?.activitiesCount||0)>0,u=()=>{i(),s("/activity/input")},g=()=>{i(),s("/activity#insights")},d={background:`
      radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 12%, transparent) 0%, transparent 60%),
      radial-gradient(circle at 70% 80%, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 50%),
      var(--glass-opacity)
    `,borderColor:"color-mix(in srgb, #3B82F6 25%, transparent)","--glow-color":"color-mix(in srgb, #3B82F6 30%, transparent)"},v=a.mode==="low"||a.mode==="medium",j=v?"div":A.div;return e.jsx("div",{className:"dynamic-activity-cta activity-capture-enter","data-performance-mode":v,children:e.jsxs(I,{className:"p-6 md:p-8 pb-8 md:pb-10 text-center relative overflow-hidden cursor-pointer activity-card-base",onClick:u,interactive:!0,style:d,children:[a.enableRotations&&e.jsx("div",{className:"training-hero-corners","aria-hidden":"true",children:[0,1,2,3].map(b=>e.jsx(j,{className:"corner-particle",style:{position:"absolute",width:"12px",height:"12px",borderRadius:"2px",background:"linear-gradient(135deg, #3B82F6, rgba(96, 165, 250, 0.8))",boxShadow:"0 0 20px #3B82F6",top:b<2?"12px":"auto",bottom:b>=2?"12px":"auto",left:b%2===0?"12px":"auto",right:b%2===1?"12px":"auto",willChange:v?"auto":"transform, opacity"},...!v&&{initial:{rotate:b%2===0?45:-45},animate:{scale:[1,1.2,1],opacity:[.6,.9,.6],rotate:b%2===0?[45,55,45]:[-45,-55,-45]},transition:{duration:3.5,repeat:1/0,delay:b*.25,ease:[.45,.05,.55,.95]}}},b))}),(l.priority==="high"||l.priority==="critical")&&a.enableGlows&&e.jsx("div",{className:"absolute inset-0 rounded-inherit pointer-events-none urgent-forge-glow-css",style:{background:"radial-gradient(circle at center, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 70%)",filter:"blur(20px)",transform:"scale(1.2)",zIndex:-1}}),e.jsxs("div",{className:"relative z-10 space-y-4 md:space-y-6",children:[e.jsxs(j,{className:`w-28 h-28 mx-auto rounded-full flex items-center justify-center relative ${l.animation==="pulse"&&a.enablePulseEffects?"icon-pulse-css":l.animation==="breathing"&&a.enablePulseEffects?"icon-breathing-css":""}`,style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3) 0%, transparent 60%),
                radial-gradient(circle at 70% 70%, color-mix(in srgb, #3B82F6 35%, transparent) 0%, transparent 50%),
                linear-gradient(135deg, color-mix(in srgb, #3B82F6 55%, transparent), color-mix(in srgb, #60A5FA 45%, transparent))
              `,border:"3px solid color-mix(in srgb, #3B82F6 70%, transparent)",boxShadow:`
                0 0 40px color-mix(in srgb, #3B82F6 60%, transparent),
                0 0 80px color-mix(in srgb, #3B82F6 40%, transparent),
                inset 0 3px 0 rgba(255,255,255,0.4)
              `,willChange:v?"auto":"transform"},...!v&&{animate:{scale:[1,1.05,1],boxShadow:["0 0 40px rgba(59, 130, 246, 0.6), 0 0 80px rgba(59, 130, 246, 0.4)","0 0 45px rgba(59, 130, 246, 0.65), 0 0 90px rgba(59, 130, 246, 0.45)","0 0 40px rgba(59, 130, 246, 0.6), 0 0 80px rgba(59, 130, 246, 0.4)"]},transition:{duration:3,repeat:1/0,ease:[.45,.05,.55,.95]}},children:[e.jsx(m,{Icon:o[l.icon],size:l.priority==="high"||l.priority==="critical"?56:48,color:"rgba(255, 255, 255, 0.95)",variant:"pure"}),!v&&a.enableAnimations&&e.jsx(A.div,{className:"absolute inset-0 rounded-full border-3",style:{borderColor:"color-mix(in srgb, #3B82F6 70%, transparent)",willChange:"transform, opacity"},animate:{scale:[1,1.5,1.5],opacity:[.7,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeOut"}}),a.enableParticles&&!v&&[...Array(6)].map((b,F)=>{const y=F*360/6,f=60,C=Math.cos(y*Math.PI/180)*f,N=Math.sin(y*Math.PI/180)*f;return e.jsx("div",{className:`absolute w-2 h-2 rounded-full dynamic-particle-css dynamic-particle-css--${F+1}`,style:{background:"#3B82F6",boxShadow:"0 0 12px color-mix(in srgb, #3B82F6 70%, transparent)","--particle-x":`${C*.4}px`,"--particle-y":`${N*.4}px`,"--particle-x-end":`${C}px`,"--particle-y-end":`${N}px`}},F)})]}),e.jsxs("div",{className:"space-y-2 md:space-y-3",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white",children:n.title}),e.jsx("p",{className:"text-white/80 text-base md:text-lg leading-relaxed max-w-md mx-auto",children:n.subtitle}),n.encouragement&&e.jsx("p",{className:"text-white/60 text-sm italic",children:n.encouragement})]}),e.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[e.jsxs("button",{onClick:u,className:`dynamic-cta-button-3d dynamic-cta-button-3d-high min-h-[64px] w-full sm:w-auto ${l.animation==="breathing"&&a.enableAnimations?"btn-breathing-css":""}`,style:{"--btn-color-light":"#60A5FA","--btn-color-base":"#3B82F6","--btn-color-dark":"#2563EB","--btn-shadow":"rgba(59, 130, 246, 0.6)","--btn-glow":"rgba(59, 130, 246, 0.8)"},children:[a.enableShimmers&&e.jsx("div",{className:"dynamic-cta-shimmer"}),e.jsxs("div",{children:[e.jsx(m,{Icon:o[l.icon],size:24,color:"white",variant:"pure"}),e.jsx("span",{children:n.buttonText})]})]}),c&&e.jsx("button",{onClick:g,className:"px-6 py-4 rounded-full font-medium text-white/90 transition-all duration-200 min-h-[64px]",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)",backdropFilter:"blur(12px) saturate(130%)"},onMouseEnter:b=>{a.mode!=="low"&&(b.currentTarget.style.background="color-mix(in srgb, #3B82F6 12%, transparent)",b.currentTarget.style.borderColor="color-mix(in srgb, #3B82F6 30%, transparent)",b.currentTarget.style.transform="translateY(-1px) scale(1.02)")},onMouseLeave:b=>{b.currentTarget.style.background="color-mix(in srgb, #3B82F6 8%, transparent)",b.currentTarget.style.borderColor="color-mix(in srgb, #3B82F6 20%, transparent)",b.currentTarget.style.transform="translateY(0) scale(1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{Icon:o.Zap,size:20,color:"white",variant:"pure"}),e.jsx("span",{children:"Voir mes Insights"})]})})]}),p.length>0&&e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-3 text-sm",children:p.map((b,F)=>e.jsx("div",{className:"px-3 py-1.5 rounded-full metric-badge-enter",style:{background:"color-mix(in srgb, #3B82F6 15%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 25%, transparent)",color:"#3B82F6",backdropFilter:"blur(8px) saturate(120%)",animationDelay:`${F*.1}s`},children:e.jsx("span",{className:"font-medium",children:b})},F))})]})]})})},qe=k.memo(({todayStats:t})=>{const{data:r=[]}=ze(1),s=r[0];return e.jsxs("div",{className:"daily-stats-grid",children:[e.jsxs(I,{className:"daily-stat-card daily-stat-card-primary",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-primary",children:e.jsx(m,{Icon:o.Zap,size:28,style:{color:"#3B82F6"}})}),e.jsx("h3",{className:"daily-stat-title",children:"Énergie Brûlée Aujourd'hui"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Calories du jour"})]}),e.jsx("div",{className:"daily-stat-value",children:t?.totalCalories||0}),e.jsx("div",{className:"daily-stat-label",children:"kcal forgées"})]}),e.jsxs(I,{className:"daily-stat-card daily-stat-card-secondary",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-secondary",children:e.jsx(m,{Icon:o.Activity,size:28,className:"text-cyan-400"})}),e.jsx("h3",{className:"daily-stat-title",children:"Activités d'Aujourd'hui"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Mouvements forgés"})]}),e.jsx("div",{className:"daily-stat-value",children:t?.activitiesCount||0}),e.jsx("div",{className:"daily-stat-label",children:"Sessions du jour"})]}),e.jsxs(I,{className:"daily-stat-card daily-stat-card-accent",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-accent",children:e.jsx(m,{Icon:o.Clock,size:28,className:"text-purple-400"})}),e.jsx("h3",{className:"daily-stat-title",children:"Dernière Activité"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Historique des forges"})]}),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"daily-stat-value text-lg",children:s.type}),e.jsxs("div",{className:"daily-stat-label",children:[P(new Date(s.timestamp),"dd MMM à HH:mm",{locale:G})," • ",s.duration_min," min"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"daily-stat-value",children:"--:--"}),e.jsx("div",{className:"daily-stat-label",children:"Aucune activité"})]})]})]})});qe.displayName="DailyStatsGrid";function pe(t){const r=["musculation","crossfit","bodyweight","weight","force","strength"];return t.filter(s=>r.some(i=>s.type.toLowerCase().includes(i))).reduce((s,i)=>s+i.duration_min,0)}function bt(t,r,s=[]){const i=r?.objective,a=r?.activity_level;switch(i){case"muscle_gain":{const h=pe(s),x=fe(a),n=h/x*100;return n<50?{status:"low",color:"#A855F7",message:"Volume de force insuffisant",recommendation:"Ajoutez des exercices de musculation pour stimuler la croissance",priority:"high",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:h,targetValue:x,unit:"min",icon:"Dumbbell",progressPercentage:n}:n>=50&&n<100?{status:"optimal",color:"#A855F7",message:"Bon volume d'entraînement",recommendation:"Continuez pour atteindre votre volume optimal de force",priority:"medium",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:h,targetValue:x,unit:"min",icon:"Dumbbell",progressPercentage:n}:{status:"high",color:"#A855F7",message:"Objectif de force atteint !",recommendation:"Excellent volume d'entraînement, maintenez cette intensité",priority:"low",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:h,targetValue:x,unit:"min",icon:"Dumbbell",progressPercentage:n}}case"fat_loss":{const h=t?.totalCalories||0,x=de(a,"fat_loss"),n=h/x*100;return n<50?{status:"low",color:"#EF4444",message:"Déficit énergétique insuffisant",recommendation:"Augmentez le cardio et la musculation pour brûler plus de calories",priority:"high",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:h,targetValue:x,unit:"kcal",icon:"Fire",progressPercentage:n}:n>=50&&n<100?{status:"optimal",color:"#EF4444",message:"Bon déficit énergétique",recommendation:"Continuez ce rythme pour optimiser la perte de graisse",priority:"medium",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:h,targetValue:x,unit:"kcal",icon:"Fire",progressPercentage:n}:{status:"high",color:"#EF4444",message:"Objectif de perte atteint !",recommendation:"Excellent déficit énergétique, vous êtes sur la bonne voie",priority:"low",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:h,targetValue:x,unit:"kcal",icon:"Fire",progressPercentage:n}}case"recomp":{const h=t?.totalCalories||0,x=pe(s),n=de(a,"recomp"),l=fe(a)*.7,p=Math.min(100,h/n*100),c=Math.min(100,x/l*100),u=p*.6+c*.4;return u<50?{status:"low",color:"#F59E0B",message:"Équilibre énergétique insuffisant",recommendation:"Combinez cardio et musculation pour une recomposition optimale",priority:"high",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:h,targetValue:n,unit:"kcal",icon:"GitCompare",progressPercentage:u}:u>=50&&u<100?{status:"optimal",color:"#F59E0B",message:"Bon équilibre énergétique",recommendation:"Maintenez ce mix cardio-force pour la recomposition",priority:"medium",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:h,targetValue:n,unit:"kcal",icon:"GitCompare",progressPercentage:u}:{status:"high",color:"#F59E0B",message:"Équilibre optimal atteint !",recommendation:"Parfait équilibre pour la recomposition corporelle",priority:"low",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:h,targetValue:n,unit:"kcal",icon:"GitCompare",progressPercentage:u}}default:{const h=t?.totalCalories||0,x=de(a,"maintenance"),n=h/x*100;return n<50?{status:"low",color:"#3B82F6",message:"Énergie faiblement forgée",recommendation:"Ajoutez des activités pour atteindre votre objectif",priority:"high",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:h,targetValue:x,unit:"kcal",icon:"Zap",progressPercentage:n}:n>=50&&n<100?{status:"optimal",color:"#3B82F6",message:"Bonne progression énergétique",recommendation:"Continuez pour atteindre votre objectif quotidien",priority:"medium",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:h,targetValue:x,unit:"kcal",icon:"Zap",progressPercentage:n}:{status:"high",color:"#3B82F6",message:"Objectif énergétique atteint !",recommendation:"Excellente journée active, maintenez ce rythme",priority:"low",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:h,targetValue:x,unit:"kcal",icon:"Zap",progressPercentage:n}}}}function de(t,r){let s=300;switch(t){case"athlete":s=500;break;case"active":s=400;break;case"moderate":s=350;break;case"light":s=250;break;case"sedentary":s=200;break}switch(r){case"fat_loss":return s+100;case"recomp":return s+50;case"maintenance":return s;default:return s}}function fe(t){switch(t){case"athlete":return 40;case"active":return 30;case"moderate":return 25;case"light":return 20;case"sedentary":return 15;default:return 25}}const vt=({todayStats:t,profile:r,todayActivities:s=[]})=>{const i=bt(t,r,s);return e.jsxs(I,{className:"calorie-progress-card",style:{"--recommendation-color":i.color},children:[e.jsxs("div",{className:"calorie-progress-header",children:[e.jsx("div",{className:"calorie-progress-icon",children:e.jsx(m,{Icon:o[i.icon],size:36,style:{color:i.color}})}),e.jsxs("div",{className:"calorie-progress-info",children:[e.jsxs("h3",{className:"calorie-progress-title",children:[i.mainMetricLabel," Aujourd'hui"]}),e.jsxs("p",{className:"calorie-progress-subtitle",children:["Progression vers votre objectif ",i.subMetricLabel.toLowerCase()," du jour"]})]}),e.jsxs("div",{className:"calorie-progress-percentage",children:[e.jsxs("div",{className:"calorie-progress-percentage-value",children:[Math.round(i.progressPercentage),"%"]}),e.jsx("div",{className:"calorie-progress-percentage-label",children:"Complété"})]})]}),e.jsx("div",{className:"calorie-progress-message",children:e.jsxs("div",{className:"calorie-progress-message-header",children:[e.jsx(m,{Icon:i.priority==="high"?o.AlertCircle:i.priority==="medium"?o.Info:o.Check,size:16,style:{color:i.color},className:"mt-0.5"}),e.jsxs("div",{className:"calorie-progress-message-content",children:[e.jsx("p",{className:"calorie-progress-message-title",style:{color:i.color},children:i.message}),e.jsx("p",{className:"calorie-progress-message-description",children:i.recommendation})]})]})}),e.jsx("div",{className:"calorie-progress-bar-container",children:e.jsx("div",{className:"calorie-progress-bar-fill",style:{width:`${Math.min(100,i.progressPercentage)}%`,background:`linear-gradient(90deg, ${i.color}, color-mix(in srgb, ${i.color} 80%, white))`},children:e.jsx("div",{className:"calorie-progress-bar-shimmer"})})}),e.jsxs("div",{className:"calorie-progress-values",children:[e.jsxs("span",{children:[i.currentValue," ",i.unit]}),e.jsxs("span",{children:[i.targetValue," ",i.unit]})]}),e.jsxs("div",{className:"calorie-progress-objective",children:["Objectif d'aujourd'hui : ",i.subMetricLabel.toLowerCase(),r?.objective&&` • Cible: ${r.objective==="fat_loss"?"Perte de graisse":r.objective==="muscle_gain"?"Prise de muscle":r.objective==="recomp"?"Recomposition":"Maintenance"}`]}),r?.objective==="recomp"&&e.jsxs("div",{className:"calorie-progress-details-grid",children:[e.jsxs("div",{className:"calorie-progress-detail-card",style:{background:"color-mix(in srgb, #EF4444 8%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 15%, transparent)"},children:[e.jsx("div",{className:"calorie-progress-detail-value text-red-400",children:t?.totalCalories||0}),e.jsx("div",{className:"calorie-progress-detail-label text-red-300",children:"Calories"})]}),e.jsxs("div",{className:"calorie-progress-detail-card",style:{background:"color-mix(in srgb, #A855F7 8%, transparent)",border:"1px solid color-mix(in srgb, #A855F7 15%, transparent)"},children:[e.jsx("div",{className:"calorie-progress-detail-value text-purple-400",children:pe(s)}),e.jsx("div",{className:"calorie-progress-detail-label text-purple-300",children:"Min Force"})]})]})]})},ee=({activityId:t,className:r="",showDetails:s=!1})=>{const{data:i,isLoading:a}=Z({queryKey:["activity-enrichment",t],queryFn:async()=>{if(!t){const{data:g}=await V.from("connected_devices").select("id, provider, status").eq("status","connected").limit(1);return{isEnriched:!1,hasConnectedDevices:g&&g.length>0}}const{data:p}=await V.from("activities").select("wearable_device_id, wearable_synced_at, wearable_raw_data").eq("id",t).single();if(!p||!p.wearable_device_id)return{isEnriched:!1};const{data:c}=await V.from("connected_devices").select("provider, display_name").eq("id",p.wearable_device_id).single(),u=p.wearable_raw_data?Object.keys(p.wearable_raw_data):[];return{isEnriched:!0,deviceProvider:c?.provider||"unknown",deviceName:c?.display_name,fieldsEnriched:u,syncedAt:p.wearable_synced_at,dataPoints:u.length}},enabled:!0,staleTime:3e5});if(a)return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${r}`,style:{background:"color-mix(in srgb, var(--color-activity-secondary) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)",color:"var(--color-activity-secondary)"},children:[e.jsx("div",{className:"w-2 h-2 rounded-full animate-pulse",style:{background:"var(--color-activity-secondary)"}}),"Vérification..."]});if(!i?.isEnriched&&!i?.hasConnectedDevices)return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${r}`,style:{background:"color-mix(in srgb, #64748B 10%, transparent)",border:"1px solid color-mix(in srgb, #64748B 20%, transparent)",color:"#94A3B8"},children:[e.jsx(m,{Icon:o.WifiOff,size:12,style:{color:"#94A3B8"}}),"Aucun objet connecté"]});if(!i?.isEnriched&&i?.hasConnectedDevices)return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${r}`,style:{background:"color-mix(in srgb, #F59E0B 10%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 20%, transparent)",color:"#FCD34D"},children:[e.jsx(m,{Icon:o.Clock,size:12,style:{color:"#FCD34D"}}),"En attente de données"]});const h={strava:"#FC4C02",apple_health:"#FF3B30",google_fit:"#4285F4",garmin:"#007CC3",fitbit:"#00B0B9",polar:"#E30613",wahoo:"#2E3192",whoop:"#000000",oura:"#5E17EB",suunto:"#FF3B3F",coros:"#FF6B00"},x={strava:"Strava",apple_health:"Apple Health",google_fit:"Google Fit",garmin:"Garmin",fitbit:"Fitbit",polar:"Polar",wahoo:"Wahoo",whoop:"WHOOP",oura:"Oura",suunto:"Suunto",coros:"COROS"},n=h[i.deviceProvider||"unknown"]||"#22C55E",l=x[i.deviceProvider||"unknown"]||"Objet Connecté";return e.jsxs("div",{className:r,children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium",style:{background:`color-mix(in srgb, ${n} 12%, transparent)`,border:`1px solid color-mix(in srgb, ${n} 25%, transparent)`,color:n},children:[e.jsxs("div",{className:"relative",children:[e.jsx(m,{Icon:o.Watch,size:12,style:{color:n}}),e.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 rounded-full animate-pulse",style:{background:n}})]}),e.jsxs("span",{children:["Enrichi par ",l]})]}),s&&i.dataPoints&&i.dataPoints>0&&e.jsxs("div",{className:"mt-2 text-xs px-3 py-2 rounded-lg",style:{background:`color-mix(in srgb, ${n} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${n} 15%, transparent)`,color:`color-mix(in srgb, ${n} 90%, white)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(m,{Icon:o.Activity,size:10,style:{color:n}}),e.jsx("span",{className:"font-medium",children:"Données synchronisées"})]}),e.jsxs("div",{className:"ml-4 space-y-0.5 text-[10px]",style:{color:`color-mix(in srgb, ${n} 70%, white)`},children:[i.fieldsEnriched?.includes("heart_rate")&&e.jsx("div",{children:"• Fréquence cardiaque"}),i.fieldsEnriched?.includes("calories")&&e.jsx("div",{children:"• Calories brûlées"}),i.fieldsEnriched?.includes("distance")&&e.jsx("div",{children:"• Distance parcourue"}),i.fieldsEnriched?.includes("elevation")&&e.jsx("div",{children:"• Dénivelé"}),i.fieldsEnriched?.includes("cadence")&&e.jsx("div",{children:"• Cadence"}),i.fieldsEnriched?.includes("power")&&e.jsx("div",{children:"• Puissance"}),i.fieldsEnriched?.includes("vo2max")&&e.jsx("div",{children:"• VO2max estimée"}),i.fieldsEnriched?.includes("hrv")&&e.jsx("div",{children:"• Variabilité cardiaque (HRV)"})]})]})]})},yt=({todayStats:t,profile:r})=>{const s=[{color:"#3B82F6",name:"Durée Totale",value:`${t?.totalDuration||0} min`,icon:"Clock"},{color:"#06B6D4",name:"Intensité Moy.",value:t?.averageIntensity||"Aucune",icon:"Zap"},{color:"#8B5CF6",name:"Type Principal",value:t?.mostFrequentType||"Aucun",icon:"Target"},{color:"#10B981",name:"Activités",value:`${t?.activitiesCount||0}`,icon:"Activity"}];return e.jsxs(I,{className:"activity-summary-card",children:[e.jsxs("div",{className:"activity-summary-header",children:[e.jsx("div",{className:"activity-summary-icon activity-icon-primary activity-icon-container-md",children:e.jsx(m,{Icon:o.BarChart3,size:20,style:{color:"var(--color-activity-primary)"}})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"activity-summary-title",children:"Résumé d'Aujourd'hui"}),e.jsx("p",{className:"activity-summary-subtitle",children:"Aperçu de vos activités du jour"})]}),e.jsx(ee,{})]})})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map((i,a)=>e.jsxs("div",{className:"activity-stat-card text-center rounded-xl activity-metric-enter",style:{background:`color-mix(in srgb, ${i.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${i.color} 20%, transparent)`,animationDelay:`${.5+a*.1}s`},children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${i.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${i.color} 25%, transparent)`},children:e.jsx(m,{Icon:o[i.icon],size:12,style:{color:i.color}})})}),e.jsx("div",{className:"text-lg font-bold",style:{color:i.color},children:i.value}),e.jsx("div",{className:"text-sm font-medium",style:{color:i.color},children:i.name})]},i.name))}),(t?.activitiesCount||0)>0&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl",style:{background:"color-mix(in srgb, var(--brand-accent) 6%, transparent)",border:"1px solid color-mix(in srgb, var(--brand-accent) 15%, transparent)"},children:[e.jsxs("h4",{className:"text-cyan-300 font-medium text-sm mb-2 flex items-center gap-2",children:[e.jsx(m,{Icon:o.Info,size:12,style:{color:"var(--brand-accent)"}}),"Optimisations Forge"]}),e.jsxs("div",{className:"activity-summary-content space-y-1",children:[e.jsx("p",{children:"• Excellente diversité d'activités aujourd'hui"}),e.jsx("p",{children:"• Maintenez ce rythme pour optimiser votre forme"}),r?.objective==="fat_loss"&&e.jsx("p",{children:"• Activités cardio recommandées pour votre objectif"})]})]})]})};function ft(t){const r=t.toLowerCase();return r.includes("course")||r.includes("running")||r.includes("marche")||r.includes("walk")||r.includes("velo")||r.includes("bike")||r.includes("natation")||r.includes("swim")?"Activity":r.includes("musculation")||r.includes("weight")?"Dumbbell":r.includes("yoga")?"Smile":r.includes("football")||r.includes("sport")?"Target":"Zap"}function se(t){switch(t){case"low":return"#22C55E";case"medium":return"#F59E0B";case"high":return"#EF4444";case"very_high":return"#DC2626";default:return"#3B82F6"}}const jt=({todayActivities:t=[],todayStats:r,hasAnyActivityHistory:s=!1,onActivityClick:i,deletingActivityId:a,onDeleteActivity:h})=>{const x=n=>{h&&h(n)};return e.jsxs(I,{className:"recent-activities-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"activity-summary-icon activity-icon-primary activity-icon-container-md",children:e.jsx(m,{Icon:o.History,size:20,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"activity-summary-title",children:"Dernières Activités"}),e.jsx("p",{className:"activity-summary-subtitle",children:"Historique de vos dernières sessions"})]})]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(m,{Icon:o.Activity,size:32,className:"text-blue-400"})}),e.jsx("p",{className:"text-white/70 text-sm mb-2",children:"Aucune activité enregistrée."}),e.jsx("p",{className:"text-white/50 text-xs",children:"Commencez votre voyage énergétique en enregistrant votre première activité !"})]}):e.jsx("div",{className:"recent-activities-list",children:t.map((n,l)=>e.jsx("div",{className:"group relative",children:e.jsx("div",{className:"recent-activity-item activity-item-enter",style:{animationDelay:`${l*.1}s`},onClick:()=>i?.(n),children:e.jsxs("div",{className:"recent-activity-item-header",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255,255,255,0.12) 0%, transparent 60%),
                          linear-gradient(135deg, color-mix(in srgb, ${se(n.intensity)} 25%, transparent), color-mix(in srgb, ${se(n.intensity)} 15%, transparent))
                        `,border:`1px solid color-mix(in srgb, ${se(n.intensity)} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${se(n.intensity)} 20%, transparent)`},children:e.jsx(m,{Icon:o[ft(n.type)],size:16,style:{color:se(n.intensity)}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"recent-activity-item-type",children:n.type}),e.jsx(ee,{activityId:n.id})]}),e.jsxs("div",{className:"recent-activity-item-time",children:[n.duration_min," min • ",P(new Date(n.timestamp),"dd MMM HH:mm",{locale:G})]})]})]}),e.jsxs("div",{className:"recent-activity-item-stats",children:[e.jsxs("div",{className:"recent-activity-item-stat",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[n.calories_est," kcal"]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Brûlées"})]}),h&&e.jsx("button",{onClick:p=>{p.stopPropagation(),x(n.id)},disabled:a===n.id,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-2 rounded-full",style:{background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)"},title:"Supprimer cette activité",children:a===n.id?e.jsx(m,{Icon:o.Loader2,size:14,className:"text-red-400 animate-spin"}):e.jsx(m,{Icon:o.Trash2,size:14,className:"text-red-400"})})]})]})})},n.id))})]})},Nt=[{zone:1,label:"Z1 Récupération",color:"#22C55E",range:"50-60%"},{zone:2,label:"Z2 Endurance",color:"#3B82F6",range:"60-70%"},{zone:3,label:"Z3 Tempo",color:"#F59E0B",range:"70-80%"},{zone:4,label:"Z4 Seuil",color:"#EF4444",range:"80-90%"},{zone:5,label:"Z5 VO2max",color:"#DC2626",range:"90-100%"}];function wt({metrics:t,className:r=""}){const s=!!(t.hr_zone1_minutes||t.hr_zone2_minutes||t.hr_zone3_minutes||t.hr_zone4_minutes||t.hr_zone5_minutes),i=(t.hr_zone1_minutes||0)+(t.hr_zone2_minutes||0)+(t.hr_zone3_minutes||0)+(t.hr_zone4_minutes||0)+(t.hr_zone5_minutes||0),a=h=>!h||i===0?0:h/i*100;return e.jsxs(I,{className:`p-6 ${r}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #EF4444 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #EF4444 30%, transparent), color-mix(in srgb, #EF4444 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #EF4444 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EF4444 30%, transparent)"},children:e.jsx(m,{Icon:o.Heart,size:20,style:{color:"#EF4444"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Métriques Cardiaques"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Données en temps réel"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.hr_avg&&e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-400",children:t.hr_avg}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Moyenne"})]}),t.hr_max&&e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-500",children:t.hr_max}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Max"})]}),t.hr_min&&e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400",children:t.hr_min}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Min"})]}),t.hr_recovery_1min&&e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:t.hr_recovery_1min}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"Récup. 1min"})]})]}),s&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-white/80 mb-3",children:"Distribution des Zones"}),Nt.map(({zone:h,label:x,color:n,range:l})=>{const p=h===1?t.hr_zone1_minutes:h===2?t.hr_zone2_minutes:h===3?t.hr_zone3_minutes:h===4?t.hr_zone4_minutes:t.hr_zone5_minutes;if(!p)return null;const c=a(p);return e.jsxs(A.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*h},className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n}}),e.jsx("span",{className:"text-white/80",children:x}),e.jsx("span",{className:"text-white/40",children:l})]}),e.jsxs("span",{className:"text-white/60",children:[p," min"]})]}),e.jsx("div",{className:"relative h-2 bg-white/5 rounded-full overflow-hidden",children:e.jsx(A.div,{initial:{width:0},animate:{width:`${c}%`},transition:{duration:.8,delay:.2+.1*h},className:"absolute top-0 left-0 h-full rounded-full",style:{backgroundColor:n,boxShadow:`0 0 12px ${n}40`}})})]},h)})]}),t.hr_avg&&e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Données enrichies par wearable"})]})})]})}const _t=t=>t?t>=80?"#22C55E":t>=60?"#3B82F6":t>=40?"#F59E0B":"#EF4444":"#6B7280",Ct=t=>t?t>=80?"Excellente":t>=60?"Bonne":t>=40?"Modérée":"Faible":"Indisponible",It=t=>t?t>=80?"Votre corps est prêt pour un entraînement intense":t>=60?"Vous pouvez vous entraîner normalement":t>=40?"Privilégiez un entraînement léger aujourd'hui":"Accordez-vous une journée de repos ou récupération active":"Connectez un objet pour obtenir votre score";function Ft({metrics:t,className:r=""}){const s=_t(t.recovery_score),i=Ct(t.recovery_score),a=It(t.recovery_score),h=({value:x,max:n,size:l=120,strokeWidth:p=8})=>{const c=(l-p)/2,u=2*Math.PI*c,g=x/n*u,d=l/2;return e.jsxs("svg",{width:l,height:l,className:"transform -rotate-90",children:[e.jsx("circle",{cx:d,cy:d,r:c,fill:"none",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:p}),e.jsx(A.circle,{cx:d,cy:d,r:c,fill:"none",stroke:s,strokeWidth:p,strokeLinecap:"round",initial:{strokeDasharray:`0 ${u}`},animate:{strokeDasharray:`${g} ${u}`},transition:{duration:1,ease:"easeOut"},style:{filter:`drop-shadow(0 0 8px ${s}40)`}})]})};return e.jsxs(I,{className:`p-6 ${r}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, ${s} 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:`color-mix(in srgb, ${s} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, ${s} 30%, transparent), color-mix(in srgb, ${s} 20%, transparent))
            `,border:`2px solid color-mix(in srgb, ${s} 40%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${s} 30%, transparent)`},children:e.jsx(m,{Icon:o.Battery,size:20,style:{color:s}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Score de Récupération"}),e.jsx("p",{className:"text-white/60 text-sm",children:"État de préparation"})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(h,{value:t.recovery_score||0,max:100}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(A.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},className:"text-4xl font-bold",style:{color:s},children:t.recovery_score||"--"}),e.jsx("div",{className:"text-white/40 text-xs mt-1",children:"sur 100"})]})]}),e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-center mt-4",children:[e.jsx("div",{className:"text-lg font-semibold mb-1",style:{color:s},children:i}),e.jsx("div",{className:"text-sm text-white/70 max-w-xs",children:a})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.hrv_pre_activity&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Activity,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-sm text-white/80",children:"HRV Pré-activité"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.hrv_pre_activity.toFixed(1)," ms"]})]}),t.hrv_avg_overnight&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Moon,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-sm text-white/80",children:"HRV Nuit"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.hrv_avg_overnight.toFixed(1)," ms"]})]}),t.sleep_quality_score&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Moon,size:14,style:{color:"#A855F7"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Qualité Sommeil"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.sleep_quality_score.toFixed(0),"%"]})]}),t.sleep_duration_hours&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Clock,size:14,style:{color:"#06B6D4"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Durée Sommeil"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.sleep_duration_hours.toFixed(1),"h"]})]}),t.stress_level_pre&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.AlertCircle,size:14,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Stress Pré-activité"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.stress_level_pre.toFixed(0),"%"]})]}),t.body_battery_pre&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Zap,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Body Battery"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.body_battery_pre.toFixed(0),"%"]})]})]}),t.recovery_score&&e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Données de récupération analysées"})]})})]})}const kt=t=>t?t>=55?"Excellent":t>=45?"Bon":t>=35?"Moyen":"À améliorer":"",St=t=>t?t>=55?"#22C55E":t>=45?"#3B82F6":t>=35?"#F59E0B":"#EF4444":"#6B7280";function Bt({metrics:t,activityType:r,className:s=""}){const i=St(t.vo2max_estimated),a=kt(t.vo2max_estimated),h=n=>n?n>=1e3?`${(n/1e3).toFixed(2)} km`:`${n.toFixed(0)} m`:"--",x=({icon:n,label:l,value:p,unit:c,color:u="#3B82F6",delay:g=0})=>e.jsxs(A.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:g,type:"spring",stiffness:200},className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:n,size:14,style:{color:u}}),e.jsx("span",{className:"text-sm text-white/80",children:l})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[p,c&&e.jsx("span",{className:"text-white/60 ml-1",children:c})]})]});return e.jsxs(I,{className:`p-6 ${s}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #3B82F6 30%, transparent), color-mix(in srgb, #3B82F6 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #3B82F6 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(m,{Icon:o.TrendingUp,size:20,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Métriques de Performance"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Données enrichies"})]})]}),t.vo2max_estimated&&e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-xl",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${i} 15%, transparent), color-mix(in srgb, ${i} 5%, transparent))`,border:`1px solid color-mix(in srgb, ${i} 30%, transparent)`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"VO2max Estimé"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold",style:{color:i},children:t.vo2max_estimated.toFixed(1)}),e.jsx("span",{className:"text-sm text-white/60",children:"ml/kg/min"})]}),e.jsx("div",{className:"text-xs font-medium mt-1",style:{color:i},children:a})]}),e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{background:`radial-gradient(circle, color-mix(in srgb, ${i} 20%, transparent), transparent)`,border:`2px solid color-mix(in srgb, ${i} 40%, transparent)`},children:e.jsx(m,{Icon:o.Zap,size:24,style:{color:i}})})]})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[t.distance_meters&&e.jsx(x,{icon:o.MapPin,label:"Distance",value:h(t.distance_meters),color:"#10B981",delay:.1}),t.avg_pace&&e.jsx(x,{icon:o.Timer,label:"Allure Moyenne",value:t.avg_pace,unit:"/km",color:"#3B82F6",delay:.15}),t.avg_speed_kmh&&e.jsx(x,{icon:o.Gauge,label:"Vitesse Moyenne",value:t.avg_speed_kmh.toFixed(1),unit:"km/h",color:"#06B6D4",delay:.2}),t.elevation_gain_meters&&e.jsx(x,{icon:o.TrendingUp,label:"Dénivelé Positif",value:t.elevation_gain_meters.toFixed(0),unit:"m",color:"#F59E0B",delay:.25})]}),(t.avg_cadence_rpm||t.avg_power_watts)&&e.jsxs("div",{className:"space-y-2 mb-4",children:[t.avg_cadence_rpm&&e.jsx(x,{icon:o.Activity,label:r==="vélo"?"Cadence Moyenne":"Fréquence de Pas",value:t.avg_cadence_rpm.toFixed(0),unit:r==="vélo"?"rpm":"spm",color:"#8B5CF6",delay:.3}),t.avg_power_watts&&e.jsx(x,{icon:o.Zap,label:"Puissance Moyenne",value:t.avg_power_watts.toFixed(0),unit:"W",color:"#EF4444",delay:.35})]}),(t.training_load_score||t.efficiency_score)&&e.jsxs("div",{className:"space-y-2",children:[t.training_load_score&&e.jsx(x,{icon:o.Activity,label:"Charge d'Entraînement",value:t.training_load_score.toFixed(0),unit:"TRIMP",color:"#F59E0B",delay:.4}),t.efficiency_score&&e.jsx(x,{icon:o.Target,label:"Score d'Efficience",value:t.efficiency_score.toFixed(1),unit:"/100",color:"#22C55E",delay:.45})]}),e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Métriques avancées enrichies par wearable"})]})})]})}function Et({hasWearableData:t,dataCompletenessScore:r,deviceName:s,className:i=""}){if(!t)return null;const a=r||0,h=a>=80?"#22C55E":a>=50?"#3B82F6":"#F59E0B";return e.jsxs(A.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:200},className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${i}`,style:{background:`linear-gradient(135deg, color-mix(in srgb, ${h} 20%, transparent), color-mix(in srgb, ${h} 10%, transparent))`,border:`1px solid color-mix(in srgb, ${h} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${h} 20%, transparent)`},children:[e.jsx(m,{Icon:o.Watch,size:12,style:{color:h}}),e.jsx("span",{style:{color:h},children:"Enrichi par wearable"}),s&&e.jsxs("span",{className:"text-white/60",children:["• ",s]}),r&&e.jsxs("span",{className:"text-white/60",children:["• ",Math.round(a),"%"]})]})}function At({activities:t,className:r=""}){const s=k.useMemo(()=>{if(!t||t.length===0)return null;const i=t.filter(c=>c.wearable_device_id);if(i.length===0)return null;const a=i[0],h=i.filter(c=>c.hr_avg).reduce((c,u)=>c+(u.hr_avg||0),0)/i.length||null,x=Math.max(...i.map(c=>c.hr_max||0))||null,n={zone1:i.reduce((c,u)=>c+(u.hr_zone1_minutes||0),0),zone2:i.reduce((c,u)=>c+(u.hr_zone2_minutes||0),0),zone3:i.reduce((c,u)=>c+(u.hr_zone3_minutes||0),0),zone4:i.reduce((c,u)=>c+(u.hr_zone4_minutes||0),0),zone5:i.reduce((c,u)=>c+(u.hr_zone5_minutes||0),0)},l=i.reduce((c,u)=>c+(u.distance_meters||0),0)||null,p=i.reduce((c,u)=>c+(u.training_load_score||0),0)||null;return{heartRate:{hr_avg:h?Math.round(h):null,hr_max:x||null,hr_min:a.hr_min,hr_resting_pre:a.hr_resting_pre,hr_recovery_1min:a.hr_recovery_1min,hr_zone1_minutes:n.zone1||null,hr_zone2_minutes:n.zone2||null,hr_zone3_minutes:n.zone3||null,hr_zone4_minutes:n.zone4||null,hr_zone5_minutes:n.zone5||null},recovery:{recovery_score:a.recovery_score,hrv_pre_activity:a.hrv_pre_activity,hrv_avg_overnight:a.hrv_avg_overnight,sleep_quality_score:a.sleep_quality_score,sleep_duration_hours:a.sleep_duration_hours,stress_level_pre:a.stress_level_pre,body_battery_pre:a.body_battery_pre,fatigue_index:a.fatigue_index},performance:{vo2max_estimated:a.vo2max_estimated,training_load_score:p,efficiency_score:a.efficiency_score,distance_meters:l,avg_pace:a.avg_pace,avg_speed_kmh:a.avg_speed_kmh,elevation_gain_meters:i.reduce((c,u)=>c+(u.elevation_gain_meters||0),0)||null,avg_cadence_rpm:a.avg_cadence_rpm,avg_power_watts:a.avg_power_watts},hasData:!0,activityType:a.type,dataCompletenessScore:a.data_completeness_score}},[t]);return s?e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Métriques Enrichies"}),e.jsx("p",{className:"text-white/60 text-sm mt-1",children:"Données biométriques provenant de vos objets connectés"})]}),e.jsx(Et,{hasWearableData:s.hasData,dataCompletenessScore:s.dataCompletenessScore})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Ft,{metrics:s.recovery}),e.jsx(wt,{metrics:s.heartRate})]}),e.jsx(Bt,{metrics:s.performance,activityType:s.activityType}),e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"p-4 rounded-xl",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 10%, transparent), color-mix(in srgb, #3B82F6 5%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(m,{Icon:o.Info,size:16,style:{color:"#3B82F6"}})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-blue-200",children:"Ces métriques sont automatiquement synchronisées depuis vos objets connectés. Plus vous portez votre montre, plus les données sont précises et les insights personnalisés."})})]})})]}):null}const Tt=({onStartTracking:t})=>{const r=X(),{isPerformanceMode:s}=oe(),i=s?"div":A.div,{profile:a}=L(),h=Je(a),x=()=>{t?t():r("/activity/input")};return e.jsxs(i,{...!s&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"}},className:"text-center py-12 py-1",children:[!h.isSufficient&&e.jsx("div",{className:"mb-6",children:e.jsx(Ue,{completion:h,forgeName:"le suivi d'activité",forgeColor:"#3B82F6"})}),e.jsx(I,{className:"p-8",style:{background:`radial-gradient(ellipse at center,
            rgba(59, 130, 246, 0.15) 0%,
            rgba(96, 165, 250, 0.08) 50%,
            rgba(0, 0, 0, 0.4) 100%)`,borderColor:"rgba(59, 130, 246, 0.3)",boxShadow:`
            0 0 30px rgba(59, 130, 246, 0.2),
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1)
          `,backdropFilter:"blur(20px) saturate(1.2)"},children:e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                rgba(59, 130, 246, 0.3) 0%,
                rgba(96, 165, 250, 0.15) 70%,
                transparent 100%)`,border:"1px solid rgba(59, 130, 246, 0.4)",boxShadow:`
                0 0 25px rgba(59, 130, 246, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(m,{Icon:o.Activity,size:48,className:"text-blue-400",style:{filter:`drop-shadow(0 0 12px rgba(59, 130, 246, 0.8))
                         drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3))`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Commencez à tracker votre activité"}),e.jsx("p",{className:"text-white/70 text-lg",children:"Enregistrez votre première activité et obtenez des insights personnalisés"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(59, 130, 246, 0.3) 0%,
                    rgba(96, 165, 250, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(59, 130, 246, 0.4)",boxShadow:`
                    0 0 20px rgba(59, 130, 246, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Mic,size:24,className:"text-blue-400",style:{filter:`drop-shadow(0 0 8px rgba(59, 130, 246, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Capture naturelle"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Vocal, texte ou sync automatique avec vos wearables"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(59, 130, 246, 0.3) 0%,
                    rgba(96, 165, 250, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(59, 130, 246, 0.4)",boxShadow:`
                    0 0 20px rgba(59, 130, 246, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Brain,size:24,className:"text-blue-400",style:{filter:`drop-shadow(0 0 8px rgba(59, 130, 246, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Analyse intelligente"}),e.jsx("p",{className:"text-white/60 text-sm",children:"IA avancée pour détecter type, intensité et dépense"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(59, 130, 246, 0.3) 0%,
                    rgba(96, 165, 250, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(59, 130, 246, 0.4)",boxShadow:`
                    0 0 20px rgba(59, 130, 246, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Target,size:24,className:"text-blue-400",style:{filter:`drop-shadow(0 0 8px rgba(59, 130, 246, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Conseils personnalisés"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Recommandations adaptées à vos objectifs"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:x,className:"group relative px-8 py-4 text-white font-semibold rounded-2xl transform hover:scale-105 transition-all duration-300",style:{background:`linear-gradient(135deg,
                  rgba(59, 130, 246, 0.8) 0%,
                  rgba(96, 165, 250, 0.9) 100%)`,border:"2px solid rgba(59, 130, 246, 0.6)",boxShadow:`
                  0 0 30px rgba(59, 130, 246, 0.4),
                  0 8px 25px rgba(0, 0, 0, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(10px) saturate(1.2)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{Icon:o.Plus,size:24,className:"group-hover:rotate-90 transition-transform duration-300",style:{color:"white",filter:`drop-shadow(0 0 10px rgba(59, 130, 246, 0.8))
                             drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3))`}}),e.jsx("span",{className:"text-lg",children:"Enregistrer ma première activité"})]}),e.jsx("div",{className:"absolute inset-0 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300 -z-10",style:{background:`linear-gradient(135deg,
                    rgba(59, 130, 246, 0.6) 0%,
                    rgba(96, 165, 250, 0.6) 100%)`}})]})}),e.jsx("div",{className:"text-white/50 text-sm p-3 rounded-xl",style:{background:`radial-gradient(ellipse at center,
                rgba(59, 130, 246, 0.1) 0%,
                transparent 70%)`,border:"1px solid rgba(59, 130, 246, 0.2)",boxShadow:"0 0 15px rgba(59, 130, 246, 0.1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{Icon:o.Lightbulb,size:16,className:"text-blue-400",style:{filter:"drop-shadow(0 0 6px rgba(59, 130, 246, 0.6))"}}),e.jsx("span",{children:"Astuce : Connectez votre montre pour une synchronisation automatique de vos activités !"})]})})]})})]})},Dt=()=>{const{profile:t,session:r}=L(),{showToast:s}=ie(),{success:i,error:a}=W(),{data:h,isLoading:x,error:n,activities:l}=lt(),{data:p=[],isLoading:c}=ze(10),u=$e(),{data:g=!1}=Z({queryKey:["activities","has-history",r?.user?.id],queryFn:async()=>{if(!r?.user?.id)return!1;const{supabase:j}=await Se(async()=>{const{supabase:y}=await import("./page-fridge-C1QVLxk9.js").then(f=>f.q);return{supabase:y}},__vite__mapDeps([1,2,3,4,5,6,7,8,9,10,11])),{data:b,error:F}=await j.from("activities").select("id").eq("user_id",r.user.id).limit(1);return F?(_.error("ACTIVITY_DAILY_TAB","Failed to check activity history",{error:F.message,userId:r.user.id,timestamp:new Date().toISOString()}),!1):(b?.length||0)>0},enabled:!!r?.user?.id,staleTime:5*60*1e3,retry:1});k.useEffect(()=>{n&&(_.error("ACTIVITY_DAILY_TAB","Failed to load activity stats",{error:n instanceof Error?n.message:"Unknown error",userId:r?.user?.id,timestamp:new Date().toISOString()}),a(),s({type:"error",title:"Erreur de Chargement",message:"Impossible de charger vos activités. Vérifiez votre connexion.",duration:4e3}))},[n,r?.user?.id,a,s]);const d=j=>{_.info("ACTIVITY_DAILY_TAB","Activity clicked for details",{activityId:j.id,activityType:j.type,userId:r?.user?.id,timestamp:new Date().toISOString()}),s({type:"info",title:"Détail d'Activité",message:`${j.type} - ${j.duration_min} min - ${j.calories_est} kcal`,duration:3e3})},v=j=>{_.info("ACTIVITY_DAILY_TAB","Delete activity requested",{activityId:j,userId:r?.user?.id,timestamp:new Date().toISOString()}),u.mutate(j)};return x?e.jsxs("div",{className:"space-y-6",children:[e.jsx(ye,{profile:t,forgeContext:"activity"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-32 bg-white/5 rounded-xl animate-pulse"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"})]}),e.jsx("div",{className:"h-40 bg-white/5 rounded-xl animate-pulse"})]})]}):!x&&!c&&!g?e.jsx(Tt,{}):e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(ye,{profile:t,forgeContext:"activity"}),e.jsx(gt,{todayStats:h,profile:t}),e.jsx(qe,{todayStats:h}),e.jsx(vt,{todayStats:h,profile:t,todayActivities:l}),e.jsx(yt,{todayStats:h,profile:t}),e.jsx(jt,{todayActivities:p,todayStats:h,hasAnyActivityHistory:g,deletingActivityId:u.isPending?"deleting":void 0,onActivityClick:d,onDeleteActivity:v}),l&&l.some(j=>j.wearable_device_id)&&e.jsx(At,{activities:l,className:"mt-6"})]})},Re=()=>{const t=Ze()==="reduced";return e.jsxs("div",{className:"space-y-6 analysis-loading-container",children:[e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.6},children:e.jsxs(I,{className:"p-8 text-center relative overflow-visible",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 12%, transparent) 0%, transparent 50%),
              radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--color-activity-accent) 8%, transparent) 0%, transparent 70%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 30%, transparent)",boxShadow:`
              0 16px 48px rgba(0, 0, 0, 0.3),
              0 0 40px color-mix(in srgb, var(--color-activity-primary) 20%, transparent),
              0 0 80px color-mix(in srgb, var(--color-activity-secondary) 15%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.2)
            `,backdropFilter:"blur(24px) saturate(160%)"},children:[e.jsx("div",{className:"absolute inset-0 rounded-inherit pointer-events-none",style:{background:"radial-gradient(circle at center, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 70%)",filter:"blur(20px)",transform:"scale(1.2)",zIndex:-1,animation:t?"none":"forge-glow 4s ease-in-out infinite"}}),e.jsxs("div",{className:"relative z-10 space-y-6 flex flex-col items-center",children:[e.jsxs(A.div,{className:"w-24 h-24 rounded-full flex items-center justify-center relative",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, var(--color-activity-primary) 45%, transparent), color-mix(in srgb, var(--color-activity-secondary) 35%, transparent))
                `,border:"3px solid color-mix(in srgb, var(--color-activity-primary) 70%, transparent)",boxShadow:`
                  0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent),
                  0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent),
                  inset 0 3px 0 rgba(255,255,255,0.4)
                `,display:"flex",alignItems:"center",justifyContent:"center"},animate:t?{}:{scale:[1,1.05,1],boxShadow:["0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent), 0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent)","0 0 80px color-mix(in srgb, var(--color-activity-primary) 80%, transparent), 0 0 160px color-mix(in srgb, var(--color-activity-primary) 50%, transparent)","0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent), 0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent)"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:[e.jsx(A.div,{className:"flex items-center justify-center",animate:t?{}:{rotate:360},transition:{duration:4,repeat:1/0,ease:"linear"},children:e.jsx(m,{Icon:o.Zap,size:36,className:"text-white",style:{filter:"drop-shadow(0 0 12px rgba(255,255,255,0.8))",display:"block"}})}),!t&&[...Array(6)].map((r,s)=>e.jsx("div",{className:"absolute w-3 h-3 rounded-full",style:{background:"var(--color-activity-secondary)",left:`${15+s*15}%`,top:`${15+s%3*25}%`,boxShadow:"0 0 12px color-mix(in srgb, var(--color-activity-secondary) 80%, transparent)",animation:`ai-particle-orbit 6s ease-in-out infinite ${s*.5}s`}},s))]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Analyse Énergétique Avancée"}),e.jsx("p",{className:"text-white/80 text-lg leading-relaxed max-w-md mx-auto",children:"Analyse de vos patterns d'activité pour générer des insights personnalisés"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{phase:"Analyse des Patterns",icon:"BarChart3",color:"var(--color-activity-primary)"},{phase:"Génération d'Insights",icon:"TrendingUp",color:"var(--color-activity-secondary)"},{phase:"Recommandations Personnalisées",icon:"Target",color:"var(--color-activity-accent)"}].map((r,s)=>e.jsxs(A.div,{className:"p-4 rounded-xl text-center",style:{background:`color-mix(in srgb, ${r.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 20%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.5,delay:t?0:.2+s*.1},children:[e.jsx(A.div,{className:"w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${r.color} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 30%, transparent)`},animate:t?{}:{scale:[1,1.1,1],boxShadow:[`0 0 16px color-mix(in srgb, ${r.color} 40%, transparent)`,`0 0 24px color-mix(in srgb, ${r.color} 60%, transparent)`,`0 0 16px color-mix(in srgb, ${r.color} 40%, transparent)`]},transition:{duration:2,repeat:1/0,delay:s*.3,ease:"easeInOut"},children:e.jsx(m,{Icon:o[r.icon],size:20,style:{color:r.color}})}),e.jsx("div",{className:"text-white font-medium text-sm",children:r.phase})]},r.phase))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-white/80 font-medium",children:"Analyse en cours..."}),e.jsx("span",{className:"text-white/60",children:"Forge Énergétique"})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(A.div,{className:"h-full rounded-full relative overflow-hidden",style:{background:`
                      linear-gradient(90deg,
                        var(--color-activity-primary),
                        var(--color-activity-secondary),
                        var(--color-activity-accent)
                      )
                    `,boxShadow:"0 0 16px color-mix(in srgb, var(--color-activity-primary) 60%, transparent)"},initial:{width:0},animate:{width:"100%"},transition:{duration:t?.1:8,repeat:1/0,ease:"easeInOut"},children:!t&&e.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`linear-gradient(90deg,
                          transparent 0%,
                          rgba(255,255,255,0.6) 50%,
                          transparent 100%
                        )`,animation:"progressShimmer 2s ease-in-out infinite"}})})})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(A.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:t?.1:.6,delay:t?0:.3},children:e.jsxs(I,{className:"p-6 h-80",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:16,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-40 skeleton-glass"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-32"})]})]}),e.jsxs("div",{className:"relative h-48 flex items-center justify-center",children:[e.jsx(A.div,{className:"w-32 h-32 rounded-full border-8 border-transparent relative",style:{background:`conic-gradient(from 0deg,
                    var(--color-activity-primary) 0% 40%,
                    var(--color-activity-secondary) 40% 70%,
                    var(--color-activity-accent) 70% 100%
                  )`,mask:"radial-gradient(circle at center, transparent 40%, black 42%)",WebkitMask:"radial-gradient(circle at center, transparent 40%, black 42%)"},animate:t?{}:{rotate:360},transition:{duration:8,repeat:1/0,ease:"linear"},children:e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-30"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:"Activités"}),e.jsx("div",{className:"text-white/60 text-sm",children:"Analyse..."})]})})]})]})}),e.jsx(A.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:t?.1:.6,delay:t?0:.4},children:e.jsxs(I,{className:"p-6 h-80",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsx(m,{Icon:o.LineChart,size:16,style:{color:"var(--color-activity-secondary)"}})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-36 skeleton-glass"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-28"})]})]}),e.jsx("div",{className:"relative h-48 rounded-xl bg-white/5 border border-white/10 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 flex items-end justify-around p-4",children:Array.from({length:7}).map((r,s)=>e.jsx(A.div,{className:"rounded-t",style:{width:"12px",height:`${30+Math.random()*60}%`,background:"color-mix(in srgb, var(--color-activity-secondary) 30%, transparent)"},initial:{height:0},animate:{height:`${30+Math.random()*60}%`},transition:{duration:t?.1:1.5,delay:t?0:s*.1,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}},s))})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((r,s)=>e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.5,delay:t?0:.5+s*.1},children:e.jsx(I,{className:"p-5",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 60%),
                  var(--glass-opacity)
                `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 15%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(A.div,{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},animate:t?{}:{scale:[1,1.1,1],opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0,delay:s*.2,ease:"easeInOut"},children:e.jsx(m,{Icon:[o.TrendingUp,o.Target,o.BarChart3,o.Zap][s],size:14,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded skeleton-glass",style:{width:`${60+Math.random()*30}%`}}),e.jsx("div",{className:"h-3 bg-white/5 rounded skeleton-glass",style:{width:`${80+Math.random()*15}%`}}),e.jsx("div",{className:"h-3 bg-white/5 rounded skeleton-glass",style:{width:`${40+Math.random()*40}%`}})]})]})})},s))}),!t&&e.jsx(A.div,{className:"relative h-16 overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},children:e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[Array.from({length:12}).map((r,s)=>e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:"linear-gradient(135deg, var(--color-activity-primary), var(--color-activity-secondary))",left:`${5+s*8}%`,top:`${40+s%3*20}%`,boxShadow:"0 0 8px color-mix(in srgb, var(--color-activity-primary) 60%, transparent)",display:"block",margin:"0 auto"}},s)),e.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none opacity-30",children:Array.from({length:4}).map((r,s)=>e.jsx(A.path,{d:`M ${10+s*25} 50 Q ${25+s*25} 20 ${40+s*25} 50`,stroke:"var(--color-activity-primary)",strokeWidth:"1",fill:"none",strokeDasharray:"2 2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:3,repeat:1/0,delay:s*.5,ease:"easeInOut"}},s))})]})}),e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.6,delay:t?0:1},children:e.jsx(I,{className:"p-6 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(m,{Icon:o.Info,size:16,style:{color:"var(--color-activity-secondary)"}}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Analyse de vos "," ",e.jsx("span",{className:"font-semibold text-white",children:"patterns énergétiques"})," "," en cours pour générer des recommandations sur mesure..."]})]})})}),e.jsx("style",{children:`
        @keyframes forge-glow {
          0%, 100% {
            opacity: 0.6;
            transform: scale(1.1);
          }
          50% {
            opacity: 0.9;
            transform: scale(1.3);
          }
        }

        @keyframes ai-particle-orbit {
          0%, 100% {
            transform: translateY(0px) translateX(0px) scale(1);
            opacity: 0.6;
          }
          25% {
            transform: translateY(-12px) translateX(8px) scale(1.3);
            opacity: 1;
          }
          50% {
            transform: translateY(-16px) translateX(-4px) scale(1.4);
            opacity: 1;
          }
          75% {
            transform: translateY(-8px) translateX(-8px) scale(1.2);
            opacity: 0.8;
          }
        }

        @keyframes ai-data-flow {
          0%, 100% {
            transform: translateY(0px) translateX(0px) scale(1);
            opacity: 0.6;
          }
          25% {
            transform: translateY(-8px) translateX(4px) scale(1.2);
            opacity: 0.9;
          }
          50% {
            transform: translateY(-12px) translateX(-2px) scale(1.3);
            opacity: 1;
          }
          75% {
            transform: translateY(-8px) translateX(-4px) scale(1.1);
            opacity: 0.8;
          }
        }

        /* Support pour reduced motion */
        @media (prefers-reduced-motion: reduce) {
          .forge-glow,
          .ai-particle-orbit,
          .ai-data-flow {
            animation: none !important;
          }

          .forge-glow {
            opacity: 0.7 !important;
            transform: scale(1.2) !important;
          }

          .ai-particle-orbit {
            opacity: 0.8 !important;
            transform: translateY(-10px) scale(1.2) !important;
          }

          .ai-data-flow {
            opacity: 0.7 !important;
            transform: translateY(-6px) scale(1.1) !important;
          }
        }

        /* Optimisations mobile */
        @media (max-width: 768px) {
          .analysis-loading-container {
            padding: 0.5rem;
          }

          .forge-glow {
            animation-duration: 5s;
          }

          .ai-particle-orbit {
            animation-duration: 8s;
          }

          .ai-data-flow {
            animation-duration: 6s;
          }
        }
      `})]})};function zt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}function $t(t){return{TrendingUp:"TrendingUp",Target:"Target",Zap:"Zap",Activity:"Activity",BarChart3:"BarChart3",Clock:"Clock",Heart:"Heart",Lightbulb:"Lightbulb",Check:"Check",AlertCircle:"AlertCircle",Info:"Info"}[t]||"Info"}const je=({insights:t,summary:r,period:s,apiPeriod:i})=>!t||t.length===0?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.Lightbulb,size:20,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-white font-bold text-xl",children:"Insights Énergétiques"}),e.jsxs("p",{className:"text-orange-200 text-sm",children:["Analyses et conseils sur ",zt(s)]})]})]}),e.jsx(I,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:r.total_activities}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:r.total_calories}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400 mb-1",children:r.total_duration}),e.jsx("div",{className:"text-cyan-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:r.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]})]})}),e.jsx("div",{className:"space-y-4",children:t.map((a,h)=>e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:h*.1},children:e.jsx(I,{className:"p-5",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, ${a.color} 8%, transparent) 0%, transparent 60%),
                  var(--glass-opacity)
                `,borderColor:`color-mix(in srgb, ${a.color} 20%, transparent)`,boxShadow:a.priority==="high"?`
                  0 8px 32px rgba(0, 0, 0, 0.2),
                  0 0 20px color-mix(in srgb, ${a.color} 15%, transparent)
                `:void 0},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`color-mix(in srgb, ${a.color} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${a.color} 30%, transparent)`},children:e.jsx(m,{Icon:o[$t(a.icon)],size:14,style:{color:a.color}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-white font-medium text-sm flex items-center gap-2",children:[a.title,a.priority==="high"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400 animate-pulse"})]}),a.confidence&&e.jsxs("span",{className:"text-xs text-white/50",children:[Math.round(a.confidence*100),"% confiance"]})]}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed mb-3",children:a.content}),a.actionable&&a.action&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg",style:{background:`color-mix(in srgb, ${a.color} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${a.color} 15%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{Icon:o.Target,size:12,style:{color:a.color}}),e.jsx("span",{className:"text-sm font-medium",style:{color:a.color},children:"Action suggérée :"})]}),e.jsx("p",{className:"text-xs mt-1 text-white/70",children:a.action})]})]})]})})},h))}),e.jsx(I,{className:"p-6 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(m,{Icon:o.Info,size:16,style:{color:"var(--color-activity-secondary)"}}),e.jsx("p",{className:"text-white/70 text-sm",children:"Continuez à enregistrer vos activités pour des insights encore plus précis et personnalisés"})]})})]});function Mt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}const Ne=({globalStats:t,period:r,apiPeriod:s})=>{const i=te();if(!t)return e.jsx(I,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #6B7280 8%, transparent) 0%, transparent 60%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #6B7280 20%, transparent)"},children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:32,style:{color:"#F59E0B"}})}),e.jsx("p",{className:"text-white/70 text-sm",children:"Aucune donnée disponible pour cette période"})]})});const a=Mt(r);return e.jsx(O,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:i.transitionDuration},fallback:e.jsx("div",{children:e.jsxs(I,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 50%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #F59E0B 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 40%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:24,style:{color:"#F59E0B"},variant:"pure"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl",children:["Forge Énergétique - ",a]}),e.jsx("div",{className:"text-white/60 text-sm font-normal mt-0.5",children:"Vos métriques de performance"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300 text-sm font-medium",children:"Période Active"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:t.avg_daily_calories}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories/jour"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.most_frequent_type||"Aucun"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Type Principal"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.avg_intensity==="low"?"Faible":t.avg_intensity==="medium"?"Modérée":t.avg_intensity==="high"?"Intense":t.avg_intensity==="very_high"?"Très Intense":"Modérée"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité Moy."})]})]})]})}),children:e.jsxs(I,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 50%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #F59E0B 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 40%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:24,style:{color:"#F59E0B"},variant:"pure"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl",children:["Forge Énergétique - ",a]}),e.jsx("div",{className:"text-white/60 text-sm font-normal mt-0.5",children:"Vos métriques de performance"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300 text-sm font-medium",children:"Période Active"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(O,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 10%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 10%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:t.total_activities}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Enregistrées"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:t.total_activities}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Enregistrées"})]}),e.jsxs(O,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #EF4444 10%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay*2},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #EF4444 10%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-red-400 mb-1",children:t.total_calories}),e.jsx("div",{className:"text-red-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-red-400 mb-1",children:t.total_calories}),e.jsx("div",{className:"text-red-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),e.jsxs(O,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #10B981 10%, transparent)",border:"1px solid color-mix(in srgb, #10B981 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay*3},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #10B981 10%, transparent)",border:"1px solid color-mix(in srgb, #10B981 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:t.total_duration}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:t.total_duration}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),e.jsxs(O,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay*4},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:t.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:t.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:t.avg_daily_calories}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories/jour"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.most_frequent_type||"Aucun"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Type Principal"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.avg_intensity==="low"?"Faible":t.avg_intensity==="medium"?"Modérée":t.avg_intensity==="high"?"Intense":t.avg_intensity==="very_high"?"Très Intense":"Modérée"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité Moy."})]})]})]})})};function xe(t){switch(t){case"week":return"7 derniers jours";case"month":return"30 derniers jours";case"quarter":return"90 derniers jours";default:return""}}function me(t){switch(t){case"week":return"Semaine";case"month":return"Mois";case"quarter":return"Trimestre";default:return""}}const Q=({selectedPeriod:t,onPeriodChange:r,currentActivities:s,periodThresholds:i,accentColor:a="#10B981"})=>{const{click:h}=W();k.useEffect(()=>{_.info("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Component state debug",{selectedPeriod:t,currentActivities:s,periodThresholds:i,componentRenderTime:new Date().toISOString(),propsReceived:{selectedPeriod:t,currentActivities:s,periodThresholds:i},timestamp:new Date().toISOString()})},[t,s,i]);const x=[{value:"week",label:me("week"),fullLabel:xe("week"),icon:o.Calendar,threshold:i.week},{value:"month",label:me("month"),fullLabel:xe("month"),icon:o.CalendarDays,threshold:i.month},{value:"quarter",label:me("quarter"),fullLabel:xe("quarter"),icon:o.CalendarRange,threshold:i.quarter}],n=l=>{const p=s>=l;return _.debug("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period availability check",{currentActivities:s,threshold:l,available:p,calculation:`${s} >= ${l} = ${p}`,timestamp:new Date().toISOString()}),p};return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"inline-flex gap-2 p-1 rounded-lg",style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)"},children:x.map(l=>{const p=n(l.threshold),c=t===l.value;return _.debug("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period button render state",{periodValue:l.value,periodLabel:l.label,periodThreshold:l.threshold,currentActivities:s,isAvailable:p,isSelected:c,willShowLock:!p,willBeDisabled:!p,calculation:`${s} >= ${l.threshold} = ${p}`,renderTime:new Date().toISOString(),timestamp:new Date().toISOString()}),_.debug("PROGRESSION_PERIOD_SELECTOR","Period button state",{periodValue:l.value,periodThreshold:l.threshold,isAvailable:p,isSelected:c,currentActivities:s,timestamp:new Date().toISOString()}),e.jsx("button",{onClick:()=>{p?(h(),r(l.value),_.info("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period changed",{newPeriod:l.value,wasAvailable:p,currentActivities:s,threshold:l.threshold,timestamp:new Date().toISOString()})):_.warn("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Attempted to select unavailable period",{period:l.value,currentActivities:s,requiredActivities:l.threshold,missingActivities:l.threshold-s,timestamp:new Date().toISOString()})},disabled:!p,className:"px-6 py-2.5 rounded-lg text-sm font-medium transition-all duration-200",style:{background:c?`${a}33`:"transparent",color:c?a:p?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.4)",border:c?`1px solid ${a}66`:"1px solid transparent",boxShadow:c?`0 0 20px ${a}4D`:"none",opacity:p?1:.5,cursor:p?"pointer":"not-allowed"},children:l.value==="week"?"7 jours":l.value==="month"?"30 jours":"90 jours"},l.value)})})})},Ot=({onStartTracking:t})=>{const r=X(),{isPerformanceMode:s}=oe(),i=s?"div":A.div,a=()=>{t?t():r("/activity/input")};return e.jsx(i,{...!s&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"}},className:"text-center py-12 py-1",children:e.jsx(I,{className:"p-8",style:{background:`radial-gradient(ellipse at center,
            rgba(245, 158, 11, 0.15) 0%,
            rgba(251, 146, 60, 0.08) 50%,
            rgba(0, 0, 0, 0.4) 100%)`,borderColor:"rgba(245, 158, 11, 0.3)",boxShadow:`
            0 0 30px rgba(245, 158, 11, 0.2),
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1)
          `,backdropFilter:"blur(20px) saturate(1.2)"},children:e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                rgba(245, 158, 11, 0.3) 0%,
                rgba(251, 146, 60, 0.15) 70%,
                transparent 100%)`,border:"1px solid rgba(245, 158, 11, 0.4)",boxShadow:`
                0 0 25px rgba(245, 158, 11, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(m,{Icon:o.Zap,size:48,className:"text-orange-400",style:{filter:`drop-shadow(0 0 12px rgba(245, 158, 11, 0.8))
                         drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3))`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Forge d'insights énergétiques"}),e.jsx("p",{className:"text-white/70 text-lg",children:"Enregistrez des activités pour générer vos analyses IA personnalisées"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(245, 158, 11, 0.3) 0%,
                    rgba(251, 146, 60, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(245, 158, 11, 0.4)",boxShadow:`
                    0 0 20px rgba(245, 158, 11, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.TrendingUp,size:24,className:"text-orange-400",style:{filter:`drop-shadow(0 0 8px rgba(245, 158, 11, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Progression analysée"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Suivez votre évolution sur 7, 30 ou 90 jours"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(245, 158, 11, 0.3) 0%,
                    rgba(251, 146, 60, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(245, 158, 11, 0.4)",boxShadow:`
                    0 0 20px rgba(245, 158, 11, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Brain,size:24,className:"text-orange-400",style:{filter:`drop-shadow(0 0 8px rgba(245, 158, 11, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Insights IA précis"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Recommandations basées sur vos données réelles"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(245, 158, 11, 0.3) 0%,
                    rgba(251, 146, 60, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(245, 158, 11, 0.4)",boxShadow:`
                    0 0 20px rgba(245, 158, 11, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Target,size:24,className:"text-orange-400",style:{filter:`drop-shadow(0 0 8px rgba(245, 158, 11, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Objectifs optimisés"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Conseils pour maximiser vos performances"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:a,className:"group relative px-8 py-4 text-white font-semibold rounded-2xl transform hover:scale-105 transition-all duration-300",style:{background:`linear-gradient(135deg,
                  rgba(245, 158, 11, 0.8) 0%,
                  rgba(251, 146, 60, 0.9) 100%)`,border:"2px solid rgba(245, 158, 11, 0.6)",boxShadow:`
                  0 0 30px rgba(245, 158, 11, 0.4),
                  0 8px 25px rgba(0, 0, 0, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(10px) saturate(1.2)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{Icon:o.Plus,size:24,className:"group-hover:rotate-90 transition-transform duration-300",style:{color:"white",filter:`drop-shadow(0 0 10px rgba(245, 158, 11, 0.8))
                             drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3))`}}),e.jsx("span",{className:"text-lg",children:"Enregistrer mes activités"})]}),e.jsx("div",{className:"absolute inset-0 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300 -z-10",style:{background:`linear-gradient(135deg,
                    rgba(245, 158, 11, 0.6) 0%,
                    rgba(251, 146, 60, 0.6) 100%)`}})]})}),e.jsx("div",{className:"text-white/50 text-sm p-3 rounded-xl",style:{background:`radial-gradient(ellipse at center,
                rgba(245, 158, 11, 0.1) 0%,
                transparent 70%)`,border:"1px solid rgba(245, 158, 11, 0.2)",boxShadow:"0 0 15px rgba(245, 158, 11, 0.1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{Icon:o.Lightbulb,size:16,className:"text-orange-400",style:{filter:"drop-shadow(0 0 6px rgba(245, 158, 11, 0.6))"}}),e.jsx("span",{children:"Astuce : Connectez votre montre pour enrichir automatiquement vos insights avec vos métriques !"})]})})]})})})};class Pt{async analyzeHRPerformanceCorrelation(r,s=30){try{const i=new Date;i.setDate(i.getDate()-s);const{data:a,error:h}=await V.from("activities").select("hr_avg, avg_pace, avg_power_watts, avg_cadence_rpm, efficiency_score").eq("user_id",r).gte("timestamp",i.toISOString()).not("hr_avg","is",null).order("timestamp",{ascending:!0});if(h)throw h;if(!a||a.length===0)return null;const x=a.filter(y=>y.hr_avg&&y.efficiency_score);if(x.length<5)return null;const n=x.reduce((y,f)=>y+(f.hr_avg||0),0)/x.length,l=this.calculateAverage(x.map(y=>y.avg_pace)),p=this.calculateAverage(x.map(y=>y.avg_power_watts)),c=this.calculateAverage(x.map(y=>y.avg_cadence_rpm)),u=x.reduce((y,f)=>y+(f.efficiency_score||0),0)/x.length,g=x.slice(-10),d=x.slice(0,10),v=g.reduce((y,f)=>y+(f.efficiency_score||0),0)/g.length,j=d.reduce((y,f)=>y+(f.efficiency_score||0),0)/d.length;let b;const F=v-j;return F>5?b="improving":F<-5?b="declining":b="stable",{avgHeartRate:n,avgPace:l,avgPower:p,avgCadence:c,efficiency:u,trend:b}}catch(i){throw _.error("BIOMETRIC_ANALYSIS","Failed to analyze HR/Performance correlation",{error:i,userId:r}),i}}async detectOvertraining(r){try{const s=new Date;s.setDate(s.getDate()-7);const i=new Date;i.setDate(i.getDate()-30);const{data:a,error:h}=await V.from("activities").select("hrv_pre_activity, recovery_score, hr_resting_pre, sleep_quality_score, stress_level_pre, training_load_score").eq("user_id",r).gte("timestamp",s.toISOString()).not("hrv_pre_activity","is",null),{data:x,error:n}=await V.from("activities").select("hrv_pre_activity, recovery_score, hr_resting_pre").eq("user_id",r).gte("timestamp",i.toISOString()).lt("timestamp",s.toISOString()).not("hrv_pre_activity","is",null);if(h||n)throw h||n;if(!a||a.length===0)return{severity:"none",indicators:["Données insuffisantes pour analyser le surentraînement"],hrvTrend:"stable",recommendations:["Connectez un objet pour suivre votre récupération"],score:0};const l=[];let p=0;const c=a.reduce((N,w)=>N+(w.hrv_pre_activity||0),0)/a.length,u=x&&x.length>0?x.reduce((N,w)=>N+(w.hrv_pre_activity||0),0)/x.length:c,g=(c-u)/u*100;let d;g<-10?(l.push("HRV en baisse significative (-"+Math.abs(g).toFixed(1)+"%)"),p+=30,d="declining"):g>10?d="improving":d="stable";const v=a.reduce((N,w)=>N+(w.recovery_score||0),0)/a.length;v<50&&(l.push("Score de récupération faible ("+v.toFixed(0)+"%)"),p+=25);const j=a.reduce((N,w)=>N+(w.hr_resting_pre||0),0)/a.length,b=x&&x.length>0?x.reduce((N,w)=>N+(w.hr_resting_pre||0),0)/x.length:j;j>b+5&&(l.push("Fréquence cardiaque au repos élevée (+"+(j-b).toFixed(0)+" bpm)"),p+=20);const F=a.reduce((N,w)=>N+(w.sleep_quality_score||0),0)/a.length;F>0&&F<60&&(l.push("Qualité de sommeil dégradée ("+F.toFixed(0)+"%)"),p+=15);const y=a.reduce((N,w)=>N+(w.stress_level_pre||0),0)/a.length;y>70&&(l.push("Niveau de stress élevé ("+y.toFixed(0)+"%)"),p+=10);let f;const C=[];return p>=60?(f="high",C.push("Repos complet recommandé pendant 3-5 jours"),C.push("Consultez un professionnel de santé si les symptômes persistent"),C.push("Évitez tout entraînement intense")):p>=40?(f="moderate",C.push("Réduisez l'intensité d'entraînement de 50%"),C.push("Privilégiez la récupération active (marche, yoga, étirements)"),C.push("Assurez-vous de dormir 8h+ par nuit")):p>=20?(f="low",C.push("Intégrez une journée de repos supplémentaire cette semaine"),C.push("Surveillez votre récupération de près"),C.push("Évitez d'augmenter votre charge d'entraînement")):(f="none",C.push("Votre récupération est bonne, continuez ainsi"),C.push("Maintenez une progression progressive")),l.length===0&&l.push("Aucun signe de surentraînement détecté"),{severity:f,indicators:l,hrvTrend:d,recommendations:C,score:p}}catch(s){throw _.error("BIOMETRIC_ANALYSIS","Failed to detect overtraining",{error:s,userId:r}),s}}async findOptimalTrainingWindows(r,s=60){try{const i=new Date;i.setDate(i.getDate()-s);const{data:a,error:h}=await V.from("activities").select("timestamp, efficiency_score, recovery_score, avg_power_watts, avg_pace").eq("user_id",r).gte("timestamp",i.toISOString()).not("efficiency_score","is",null);if(h)throw h;if(!a||a.length<10)return[];const x={morning:{performances:[],recoveries:[],count:0},afternoon:{performances:[],recoveries:[],count:0},evening:{performances:[],recoveries:[],count:0}};a.forEach(l=>{const p=new Date(l.timestamp).getHours();let c;p>=5&&p<12?c="morning":p>=12&&p<18?c="afternoon":c="evening",x[c].performances.push(l.efficiency_score||0),x[c].recoveries.push(l.recovery_score||0),x[c].count++});const n=[];for(const[l,p]of Object.entries(x)){if(p.count<3)continue;const c=p.performances.reduce((v,j)=>v+j,0)/p.performances.length,u=p.recoveries.reduce((v,j)=>v+j,0)/p.recoveries.length,g=Math.min(p.count/10,1);let d="";c>75&&u>70?d="Fenêtre optimale pour entraînements intensifs":c>60?d="Bon moment pour entraînements modérés":d="Privilégier récupération active ou repos",n.push({timeOfDay:l,avgPerformance:c,avgRecovery:u,recommendation:d,confidence:g})}return n.sort((l,p)=>p.avgPerformance-l.avgPerformance)}catch(i){throw _.error("BIOMETRIC_ANALYSIS","Failed to find optimal training windows",{error:i,userId:r}),i}}calculateAverage(r){const s=r.filter(i=>i!=null);if(s.length!==0)return s.reduce((i,a)=>i+a,0)/s.length}}const ue=new Pt,qt=({period:t})=>{const{profile:r}=L(),[s,i]=k.useState(null),[a,h]=k.useState(null),[x,n]=k.useState([]),[l,p]=k.useState([]),[c,u]=k.useState(!0),g=t==="week"?7:t==="month"?30:90;if(k.useEffect(()=>{(async()=>{if(r?.id)try{u(!0),_.info("BIOMETRIC_INSIGHTS_SECTION","Fetching biometric insights from local service",{userId:r.id,period:t,periodDays:g,timestamp:new Date().toISOString()});const[f,C,N,w]=await Promise.all([ue.analyzeHRPerformanceCorrelation(r.id,g),ue.detectOvertraining(r.id),ue.findOptimalTrainingWindows(r.id,g*2),Promise.resolve([])]);i(f),h(C),n(N),p(w),_.info("BIOMETRIC_INSIGHTS_SECTION","Biometric insights fetched successfully",{hasCorrelation:!!f,overtrainingSeverity:C?.severity,windowsCount:N?.length,hasGoals:w?.length>0,timestamp:new Date().toISOString()})}catch(f){_.error("BIOMETRIC_INSIGHTS_SECTION","Failed to fetch biometric insights",{error:f instanceof Error?f.message:"Unknown error",userId:r.id,period:t,timestamp:new Date().toISOString()})}finally{u(!1)}})()},[r?.id,g,t]),c)return e.jsx("div",{className:"space-y-4",children:[1,2,3].map(y=>e.jsx("div",{className:"h-48 rounded-2xl animate-pulse",style:{background:"linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02))"}},y))});if(!(s||a&&a.severity!=="none"||x.length>0))return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(ee,{})}),e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.Activity,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Insights Biométriques"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto leading-relaxed",children:"Connectez un objet et enregistrez des activités avec données biométriques pour débloquer des analyses avancées de corrélation FC/Performance, détection de surentraînement et fenêtres optimales."})]})]});const v={none:{primary:"#22C55E",secondary:"#10B981"},low:{primary:"#F59E0B",secondary:"#D97706"},moderate:{primary:"#F97316",secondary:"#EA580C"},high:{primary:"#EF4444",secondary:"#DC2626"}},j={improving:{primary:"#22C55E",secondary:"#10B981",icon:o.TrendingUp},stable:{primary:"#3B82F6",secondary:"#2563EB",icon:o.Minus},declining:{primary:"#EF4444",secondary:"#DC2626",icon:o.TrendingDown}},b={morning:"Matin",afternoon:"Après-midi",evening:"Soir"},F={morning:o.Sunrise,afternoon:o.Sun,evening:o.Moon};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(ee,{})}),s&&e.jsxs(I,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${j[s.trend].primary} 25%, transparent), color-mix(in srgb, ${j[s.trend].secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${j[s.trend].primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${j[s.trend].primary} 20%, transparent)`},children:e.jsx(m,{Icon:o.Activity,size:24,style:{color:j[s.trend].primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Corrélation FC / Performance"}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1.5",style:{background:`color-mix(in srgb, ${j[s.trend].primary} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${j[s.trend].primary} 25%, transparent)`,color:j[s.trend].primary},children:[e.jsx(m,{Icon:j[s.trend].icon,size:12}),s.trend==="improving"&&"En amélioration",s.trend==="stable"&&"Stable",s.trend==="declining"&&"En baisse"]})]}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Analyse de l'efficacité cardiovasculaire sur les ",g," derniers jours"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.Heart,size:14,style:{color:"#EF4444"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Fréquence Cardiaque Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgHeartRate.toFixed(0)," bpm"]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.Target,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Score d'Efficacité"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.efficiency.toFixed(0),"%"]})]}),s.avgPace&&e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.Zap,size:14,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Allure Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgPace.toFixed(1)," min/km"]})]}),s.avgPower&&e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.Zap,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Puissance Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgPower.toFixed(0)," W"]})]})]})]}),a&&a.severity!=="none"&&e.jsxs(I,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, ${v[a.severity].primary} 12%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:`color-mix(in srgb, ${v[a.severity].primary} 30%, transparent)`,boxShadow:`0 0 24px color-mix(in srgb, ${v[a.severity].primary} 15%, transparent)`},children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${v[a.severity].primary} 25%, transparent), color-mix(in srgb, ${v[a.severity].secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${v[a.severity].primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${v[a.severity].primary} 25%, transparent)`},children:e.jsx(m,{Icon:o.AlertTriangle,size:24,style:{color:v[a.severity].primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Détection Surentraînement"}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold",style:{background:`color-mix(in srgb, ${v[a.severity].primary} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${v[a.severity].primary} 25%, transparent)`,color:v[a.severity].primary},children:[a.severity==="low"&&"Vigilance",a.severity==="moderate"&&"Attention",a.severity==="high"&&"Alerte"]})]}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Score de risque: ",a.score,"/100"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(m,{Icon:o.AlertCircle,size:14}),"Indicateurs détectés"]}),e.jsx("div",{className:"space-y-2",children:a.indicators.map((y,f)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("div",{className:"w-1 h-1 rounded-full mt-2",style:{background:v[a.severity].primary}}),e.jsx("span",{className:"text-white/80 text-sm",children:y})]},f))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(m,{Icon:o.Lightbulb,size:14}),"Recommandations"]}),e.jsx("div",{className:"space-y-2",children:a.recommendations.map((y,f)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg",style:{background:`color-mix(in srgb, ${v[a.severity].primary} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${v[a.severity].primary} 15%, transparent)`},children:[e.jsx(m,{Icon:o.Check,size:14,style:{color:v[a.severity].primary,marginTop:2}}),e.jsx("span",{className:"text-white/90 text-sm",children:y})]},f))})]})]})]}),x.length>0&&e.jsxs(I,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #8B5CF6 15%, transparent))",border:"1px solid color-mix(in srgb, #8B5CF6 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsx(m,{Icon:o.Clock,size:24,style:{color:"#8B5CF6"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Fenêtres Optimales d'Entraînement"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Basé sur ",g*2," jours d'analyse de vos performances"]})]})]}),e.jsx("div",{className:"space-y-3",children:x.map((y,f)=>e.jsxs("div",{className:"p-4 rounded-xl",style:{background:f===0?"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 12%, transparent), color-mix(in srgb, #8B5CF6 5%, transparent))":"rgba(255,255,255,0.05)",border:f===0?"1px solid color-mix(in srgb, #8B5CF6 25%, transparent)":"1px solid rgba(255,255,255,0.08)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{Icon:F[y.timeOfDay],size:20,style:{color:"#8B5CF6"}}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold text-base",children:b[y.timeOfDay]}),f===0&&e.jsx("span",{className:"text-purple-300 text-xs font-medium",children:"Meilleur créneau"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white/50 text-xs",children:"Confiance"}),e.jsxs("p",{className:"text-white font-bold text-sm",children:[(y.confidence*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Performance"}),e.jsxs("p",{className:"text-white font-semibold",children:[y.avgPerformance.toFixed(0),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Récupération"}),e.jsxs("p",{className:"text-white font-semibold",children:[y.avgRecovery.toFixed(0),"%"]})]})]}),e.jsx("p",{className:"text-white/80 text-sm",children:y.recommendation})]},f))})]}),l.length>0&&e.jsxs(I,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 25%, transparent), color-mix(in srgb, #10B981 15%, transparent))",border:"1px solid color-mix(in srgb, #10B981 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsx(m,{Icon:o.Target,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Recommandations basées sur vos Objectifs"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Insights personnalisés pour atteindre vos objectifs"})]})]}),e.jsx("div",{className:"space-y-4",children:l.map(y=>{const f=y.goal,C=f.deadline?Math.ceil((new Date(f.deadline).getTime()-new Date().getTime())/(1e3*60*60*24)):null,N=C&&C<=14&&y.progress_percentage<70,w=!y.on_track&&y.progress_percentage<100;return!N&&!w?null:e.jsxs("div",{className:"p-4 rounded-xl",style:{background:N?"linear-gradient(135deg, color-mix(in srgb, #F59E0B 12%, transparent), color-mix(in srgb, #F59E0B 5%, transparent))":"linear-gradient(135deg, color-mix(in srgb, #3B82F6 12%, transparent), color-mix(in srgb, #3B82F6 5%, transparent))",border:N?"1px solid color-mix(in srgb, #F59E0B 25%, transparent)":"1px solid color-mix(in srgb, #3B82F6 25%, transparent)"},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(m,{Icon:N?o.AlertTriangle:o.Info,size:20,style:{color:N?"#F59E0B":"#3B82F6",marginTop:2}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-semibold text-base mb-1",children:f.title}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:N?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Action urgente :"})," Il vous reste ",C," jours pour atteindre cet objectif. Vous êtes à ",y.progress_percentage.toFixed(0),"% de complétion.",f.goal_type==="volume"&&" Augmentez votre fréquence d'entraînement de 20% cette semaine.",f.goal_type==="distance"&&" Privilégiez des séances plus longues pour maximiser la distance parcourue.",f.goal_type==="endurance"&&" Intégrez 2 séances d'interval training haute intensité cette semaine."]}):w?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Ajustez votre stratégie :"})," Vous êtes légèrement en retard sur cet objectif. Basé sur vos performances biométriques, ",s&&s.trend==="improving"?"vous êtes en phase d'amélioration. Maintenez le cap avec une progression constante.":"assurez-vous de bien récupérer entre les séances pour optimiser vos performances."]}):null}),y.estimated_completion_date&&C&&C>0&&e.jsxs("p",{className:"text-white/60 text-xs mt-2",children:["Estimation d'achèvement: ",new Date(y.estimated_completion_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})]})]})]}),x.length>0&&N&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/70 text-xs mb-1",children:"💡 Fenêtre optimale recommandée"}),e.jsxs("p",{className:"text-white text-sm font-medium",children:[x[0].timeOfDay==="morning"&&"Matin",x[0].timeOfDay==="afternoon"&&"Après-midi",x[0].timeOfDay==="evening"&&"Soir"," ","pour maximiser vos performances et atteindre votre objectif plus rapidement"]})]})]},f.id)})})]})]})};function Rt({period:t,enabled:r=!0}){const{profile:s,session:i}=L();return Z({queryKey:["biometric-insights",i?.user?.id,t],queryFn:async()=>{if(!i?.user?.id)throw new Error("User not authenticated");_.info("BIOMETRIC_INSIGHTS","Fetching biometric insights",{userId:i.user.id,period:t,timestamp:new Date().toISOString()});const x=await fetch("https://kwipydbtjagypocpvbwn.supabase.co/functions/v1/biometric-insights-analyzer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U"},body:JSON.stringify({userId:i.user.id,period:t,userProfile:{weight_kg:s?.weight_kg,sex:s?.sex,birthdate:s?.birthdate,activity_level:s?.activity_level,objective:s?.objective},clientTraceId:`biometric_insights_${t}_${Date.now()}`})});if(!x.ok){const l=await x.json().catch(()=>({error:"Unknown error"}));if(l.insufficient_data)return _.info("BIOMETRIC_INSIGHTS","Insufficient enriched data",{userId:i.user.id,period:t,required:l.required_enriched,current:l.current_enriched,timestamp:new Date().toISOString()}),{biometric_insights:[],zone_distribution:{},performance_trends:{},recovery_recommendations:{},summary:{},enriched_activities:[],insufficient_data:!0};throw _.error("BIOMETRIC_INSIGHTS","Failed to fetch biometric insights",{userId:i.user.id,period:t,status:x.status,error:l,timestamp:new Date().toISOString()}),new Error(l.message||l.error||"Failed to fetch biometric insights")}const n=await x.json();return _.info("BIOMETRIC_INSIGHTS","Biometric insights fetched successfully",{userId:i.user.id,period:t,insightsCount:n.biometric_insights?.length||0,enrichedActivitiesCount:n.enriched_activities?.length||0,timestamp:new Date().toISOString()}),n},enabled:r&&!!i?.user?.id,staleTime:10*60*1e3,gcTime:30*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1})}const we={week:"last7Days",month:"last30Days",quarter:"last3Months"},Vt=()=>{const{profile:t}=L(),{showToast:r}=ie(),{click:s}=W(),{showModal:i}=Be(),a=ne(z=>z.selectedPeriod),h=ne(z=>z.setSelectedPeriod),x=we[a],[n,l]=k.useState(0),{data:p=!1}=Me(),{data:c,isLoading:u,error:g}=De(x),{data:d,isLoading:v,error:j}=Rt({period:x,enabled:!!c&&!c.insufficient_data}),b=k.useMemo(()=>d&&!d.insufficient_data&&d.enriched_activities&&d.enriched_activities.length>0,[d]);k.useEffect(()=>{d&&_.info("ACTIVITY_INSIGHTS_TAB_BIOMETRIC","Biometric data received",{hasData:!!d,insufficient:d.insufficient_data,enrichedCount:d.enriched_activities?.length||0,insightsCount:d.biometric_insights?.length||0,timestamp:new Date().toISOString()})},[d]);const[F,y]=k.useState(!1);k.useEffect(()=>{const z=()=>{const M=window.location.hash.replace("#","");y(M==="insights"||M==="")};return z(),window.addEventListener("hashchange",z),()=>window.removeEventListener("hashchange",z)},[]);const f=ke(({currentLocation:z,nextLocation:M})=>{const S=F&&u&&z.pathname!==M.pathname;return S&&(_.info("ACTIVITY_INSIGHTS_TAB","Navigation blocked during analysis loading",{currentPath:z.pathname,nextPath:M.pathname,isLoading:u,timestamp:new Date().toISOString()}),i({title:"Attention ! Analyse d'insights en cours",message:"Voulez-vous vraiment quitter l'analyse ? Les insights pourraient être perdus et devront être régénérés.",processName:"Analyse d'Insights",onConfirm:()=>{_.info("ACTIVITY_INSIGHTS_TAB","User confirmed exit during analysis",{currentPath:z.pathname,nextPath:M.pathname,timestamp:new Date().toISOString()}),f.proceed?.()},onCancel:()=>{_.info("ACTIVITY_INSIGHTS_TAB","User cancelled exit during analysis",{currentPath:z.pathname,nextPath:M.pathname,timestamp:new Date().toISOString()}),f.reset?.()}})),S});k.useEffect(()=>{c?.current_activities!==void 0&&(_.info("ACTIVITY_INSIGHTS_TAB_DIAGNOSTIC","Current activities count updated",{previousCount:n,newCount:c.current_activities,summaryTotalActivities:c.summary?.total_activities,dataConsistency:c.current_activities===c.summary?.total_activities?"consistent":"inconsistent",cached:c.cached||!1,timestamp:new Date().toISOString()}),l(c.current_activities))},[c?.current_activities,n,c?.summary?.total_activities,c?.cached]),k.useEffect(()=>{g&&(_.error("ACTIVITY_INSIGHTS_TAB","Erreur lors de la génération des insights",{error:g instanceof Error?g.message:"Unknown error",selectedPeriod:a,timestamp:new Date().toISOString()}),r({type:"error",title:"Erreur d'analyse",message:"Impossible de générer les insights. Veuillez réessayer.",duration:4e3}))},[g,a,r]);const C=z=>{s(),h(z),_.info("ACTIVITY_INSIGHTS_TAB","Period changed by user",{newPeriod:z,apiPeriod:we[z],timestamp:new Date().toISOString()})},N={week:Y("last7Days"),month:Y("last30Days"),quarter:Y("last3Months")},w=c?.fallback,$=c?.cached;return p?c?.insufficient_data?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{selectedPeriod:a,onPeriodChange:C,currentActivities:n,periodThresholds:N,accentColor:"#F59E0B"}),e.jsxs(I,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.AlertCircle,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Insights en Construction"}),e.jsx("p",{className:"text-white/70 text-base",children:"Plus d'activités nécessaires"})]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg mx-auto",children:[e.jsxs("p",{className:"text-white/80 text-lg leading-relaxed",children:["Vous avez ",e.jsx("strong",{className:"text-orange-300",children:c.current_activities})," activité",c.current_activities>1?"s":""," enregistrée",c.current_activities>1?"s":"","."]}),e.jsxs("p",{className:"text-white/70 text-base leading-relaxed",children:["Il vous faut au moins ",e.jsx("strong",{className:"text-orange-300",children:c.required_activities})," activités pour générer des insights personnalisés sur cette période."]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(m,{Icon:o.Zap,size:16,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Passez à l'action !"})]}),e.jsxs("p",{className:"text-blue-200 text-sm leading-relaxed",children:["Enregistrez ",c.required_activities-c.current_activities," activité",c.required_activities-c.current_activities>1?"s":""," supplémentaire",c.required_activities-c.current_activities>1?"s":"","pour débloquer vos insights personnalisés et découvrir des recommandations sur mesure."]})]})]})]})]}):w&&c?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{selectedPeriod:a,onPeriodChange:C,currentActivities:n,periodThresholds:N,accentColor:"#F59E0B"}),e.jsx(I,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #F59E0B 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #F59E0B 15%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 25%, transparent)"},children:e.jsx(m,{Icon:o.Info,size:14,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-300 font-medium text-sm",children:"Mode Analyse Locale"}),e.jsx("p",{className:"text-orange-200 text-xs mt-0.5",children:"Insights générés localement à partir de vos données d'activité"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ne,{globalStats:c?.summary,period:a,apiPeriod:x}),e.jsx(je,{insights:c?.insights||[],summary:c?.summary,period:a,apiPeriod:x})]})]}):e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(Q,{selectedPeriod:a,onPeriodChange:C,currentActivities:n,periodThresholds:N,accentColor:"#F59E0B"}),w&&e.jsx(I,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #F59E0B 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #F59E0B 15%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 25%, transparent)"},children:e.jsx(m,{Icon:o.Info,size:14,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-300 font-medium text-sm",children:"Mode Analyse Locale"}),e.jsx("p",{className:"text-orange-200 text-xs mt-0.5",children:"Insights générés localement à partir de vos données d'activité"})]})]})}),$&&!w&&e.jsx(I,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #22C55E 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #22C55E 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)"},children:e.jsx(m,{Icon:o.Check,size:14,style:{color:"#22C55E"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-medium text-sm",children:"Données mises en cache"}),e.jsxs("p",{className:"text-green-200 text-xs mt-0.5",children:["Dernière analyse: ",c.cache_age_hours,"h • Économie de coûts IA"]})]})]})}),u?e.jsx(Re,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ne,{globalStats:c?.summary,period:a,apiPeriod:x}),e.jsx(je,{insights:c?.insights||[],summary:c?.summary,period:a,apiPeriod:x}),b&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{className:"p-6",style:{background:`
                    radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 60%),
                    var(--glass-opacity)
                  `,borderColor:"color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                        radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                        linear-gradient(135deg, color-mix(in srgb, #8B5CF6 30%, transparent), color-mix(in srgb, #8B5CF6 20%, transparent))
                      `,border:"2px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent)"},children:e.jsx(m,{Icon:o.Activity,size:20,style:{color:"#8B5CF6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Analyse Biométrique Avancée"}),e.jsx("p",{className:"text-purple-200 text-sm",children:"Insights basés sur vos données de fréquence cardiaque et performance"})]})]})}),v?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(z=>e.jsx("div",{className:"h-48 rounded-2xl animate-pulse",style:{background:"linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02))"}},z))}):j?e.jsxs(I,{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #EF4444 20%, transparent), color-mix(in srgb, #EF4444 10%, transparent))",border:"1px solid color-mix(in srgb, #EF4444 30%, transparent)"},children:e.jsx(m,{Icon:o.AlertCircle,size:32,style:{color:"#EF4444"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Erreur d'analyse biométrique"}),e.jsx("p",{className:"text-white/70 text-base",children:"Impossible de charger les insights biométriques"})]}):e.jsx(qt,{period:a})]}),!v&&!b&&c&&!c.insufficient_data&&e.jsxs(I,{className:"p-6 text-center",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 60%),
                  var(--glass-opacity)
                `,borderColor:"color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 20%, transparent), color-mix(in srgb, #3B82F6 10%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(m,{Icon:o.Watch,size:32,style:{color:"#3B82F6"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Débloquez l'Analyse Biométrique"}),e.jsx("p",{className:"text-white/70 text-base mb-4 max-w-md mx-auto leading-relaxed",children:"Connectez une montre ou un capteur cardiaque pour accéder à des insights avancés: corrélation FC/Performance, détection de surentraînement, fenêtres optimales d'entraînement."}),e.jsx("div",{className:"text-blue-300 text-sm",children:"Rendez-vous dans Paramètres → Objets Connectés"})]}),c&&(!c.insights||c.insights.length===0)&&e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.Info,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Aucun Insight Généré"}),e.jsx("p",{className:"text-white/70 text-base mb-6 max-w-md mx-auto leading-relaxed",children:"Aucun insight n'a été généré pour cette période. Continuez à enregistrer vos activités pour enrichir l'analyse et débloquer des insights personnalisés."}),e.jsx("div",{className:"text-orange-300 text-sm",children:"Enregistrez plus d'activités pour des insights détaillés"})]})]})]}):e.jsx(Ot,{})};function Lt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}const _e=({data:t,profile:r,period:s,apiPeriod:i})=>{const a=te();if(!t||!t.activity_types||t.activity_types.length===0)return e.jsx("div",{className:"chart-enter-right",children:e.jsx(I,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 25%, transparent)",boxShadow:`
              0 8px 32px rgba(0, 0, 0, 0.2),
              0 0 20px color-mix(in srgb, var(--color-activity-primary) 10%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.12)
            `},children:e.jsxs("div",{className:"flex items-center justify-center gap-3 p-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-white font-bold text-xl mb-2",children:"Distribution Énergétique"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Données insuffisantes pour l'analyse"})]})]})})});const x=(()=>{if(!t?.activity_types||t.activity_types.length===0)return 0;const l=Math.min(100,t.activity_types.length/5*100),p=(t.intensity_levels||[]).reduce((c,u)=>{const d=Math.abs(u.percentage-25);return c+(25-Math.min(25,d))},0);return Math.round((l+p)/2)})(),n=x>=80?"#22C55E":x>=60?"#F59E0B":"#EF4444";return e.jsx("div",{className:"chart-enter-right",children:e.jsxs(I,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 25%, transparent)",boxShadow:`
            0 8px 32px rgba(0, 0, 0, 0.2),
            0 0 20px color-mix(in srgb, var(--color-activity-primary) 10%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"Distribution Énergétique"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Répartition de vos activités sur ",Lt(s)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n,boxShadow:`0 0 8px color-mix(in srgb, ${n} 60%, transparent)`}}),e.jsx("span",{className:"text-white font-bold text-lg",children:x})]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Score Équilibre"})]})]}),t.activity_types&&t.activity_types.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(m,{Icon:o.Target,size:16,style:{color:"#10B981"}}),"Types d'Activités"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.activity_types.slice(0,a.mode==="low"?3:a.mode==="medium"?5:t.activity_types.length).map((l,p)=>e.jsxs(O,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 20%, transparent)`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:a.transitionDuration,delay:p*a.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 20%, transparent)`},children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${l.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 25%, transparent)`},children:e.jsx(m,{Icon:o.Activity,size:12,style:{color:l.color}})})}),e.jsxs("div",{className:"text-lg font-bold",style:{color:l.color},children:[l.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:l.name}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[l.total_minutes," min • ",l.total_calories," kcal"]})]}),children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${l.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 25%, transparent)`},children:e.jsx(m,{Icon:o.Activity,size:12,style:{color:l.color}})})}),e.jsxs("div",{className:"text-lg font-bold",style:{color:l.color},children:[l.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:l.name}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[l.total_minutes," min • ",l.total_calories," kcal"]})]},l.name))})]}),t?.intensity_levels&&t.intensity_levels.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(m,{Icon:o.Zap,size:16,style:{color:"#10B981"}}),"Niveaux d'Intensité"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.intensity_levels.map((l,p)=>e.jsxs(O,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 20%, transparent)`},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:a.transitionDuration,delay:p*a.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 20%, transparent)`},children:[e.jsxs("div",{className:"text-xl font-bold",style:{color:l.color},children:[l.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:l.level}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[l.sessions_count," sessions"]})]}),children:[e.jsxs("div",{className:"text-xl font-bold",style:{color:l.color},children:[l.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:l.level}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[l.sessions_count," sessions"]})]},l.level))})]}),t?.time_patterns&&t.time_patterns.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(m,{Icon:o.Clock,size:16,style:{color:"#10B981"}}),"Patterns Temporels"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.time_patterns.map((l,p)=>e.jsxs(O,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 20%, transparent)`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:a.transitionDuration,delay:p*a.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${l.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${l.color} 20%, transparent)`},children:[e.jsx("div",{className:"text-lg font-bold",style:{color:l.color},children:l.activity_count}),e.jsx("div",{className:"text-sm font-medium text-white",children:l.period}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[l.avg_calories," kcal moy."]})]}),children:[e.jsx("div",{className:"text-lg font-bold",style:{color:l.color},children:l.activity_count}),e.jsx("div",{className:"text-sm font-medium text-white",children:l.period}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[l.avg_calories," kcal moy."]})]},l.period))})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${n} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${n} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(m,{Icon:x>=80?o.Check:x>=60?o.Info:o.AlertCircle,size:14,style:{color:n},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:n},children:x>=80?"Excellent équilibre énergétique":x>=60?"Bon équilibre, quelques ajustements possibles":"Équilibre à améliorer"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${n}CC`},children:x>=80?"Continuez cette diversité d'activités":x>=60?"Variez davantage vos types d'activités":"Essayez d'intégrer plus de variété dans vos entraînements"})]})]})})]})})};function Ht(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}function Gt(t){switch(t){case"week":return 7;case"month":return 30;case"quarter":return 90;default:return 30}}function re(t,r){const s={excellent:"#22C55E",high:"#3B82F6",medium:"#F59E0B",low:"#EF4444",none:"rgba(255, 255, 255, 0.05)"},i=s[t]||s.none;if(t==="none")return i;const a=Math.max(.3,r);return`${i}${Math.round(a*255).toString(16).padStart(2,"0")}`}const Ce=({activities:t,period:r,apiPeriod:s})=>{const i=te(),a=t||[],h=()=>{const l=new Date;let p=Gt(r);i.mode==="low"?p=Math.min(p,14):i.mode==="medium"&&(p=Math.min(p,30));const c=new Date(l);c.setDate(l.getDate()-p+1);const u=[];for(let N=0;N<p;N++){const w=new Date(c);w.setDate(c.getDate()+N);const $=w.toISOString().split("T")[0],z=a.filter(D=>D.timestamp.startsWith($)),M=z.reduce((D,q)=>D+(q.calories_est||0),0),S=z.reduce((D,q)=>D+(q.duration_min||0),0),E=z.length;let B="none",T=0;E>0&&(M>=500||S>=60?(B="excellent",T=1):M>=300||S>=40?(B="high",T=.8):M>=150||S>=20?(B="medium",T=.6):(B="low",T=.4)),u.push({date:$,dayName:P(w,"EEEE",{locale:G}),dayNumber:w.getDate(),monthName:P(w,"MMMM",{locale:G}),status:B,intensity:T,calories:M,activitiesCount:E,duration:S})}const g=[];let d=[];u.forEach((N,w)=>{const $=new Date(N.date).getDay(),z=$===0?6:$-1;(d.length===7||w===0&&z>0)&&d.length>0&&(g.push(d),d=[]),d.push(N),w===u.length-1&&g.push(d)});const v=u.filter(N=>N.status==="excellent").length,j=u.filter(N=>N.activitiesCount>0).length,b=Math.round(j/u.length*100),F=Math.round(v/u.length*100),y=Math.round(u.reduce((N,w)=>N+w.calories,0)/u.length),f=Math.round(u.reduce((N,w)=>N+w.duration,0)/u.length);return{weeks:g,stats:{excellentDays:v,activityRate:b,excellenceRate:F,avgCaloriesPerDay:y,avgDurationPerDay:f}}},{weeks:x,stats:n}=h();return e.jsx("div",{className:"heatmap-enter",children:e.jsxs(I,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-accent) 6%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 25%, transparent)",boxShadow:`
            0 8px 32px rgba(0, 0, 0, 0.2),
            0 0 20px color-mix(in srgb, var(--color-activity-secondary) 10%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.Calendar,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"Activité Énergétique"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Votre régularité sur ",Ht(r)]})]})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsxs("span",{className:"text-green-300 text-sm font-medium",children:[n.excellentDays," jours excellents"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"var(--color-activity-secondary)"}}),e.jsxs("span",{className:"text-white/70 text-sm font-medium",children:[n.activityRate,"% d'activité"]})]})]})]}),e.jsxs("div",{className:"space-y-3 heatmap-grid-container overflow-x-auto",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map(l=>e.jsx("div",{className:"text-center text-white/60 text-xs font-medium py-1",children:l},l))}),e.jsx("div",{className:"space-y-2",children:x.map((l,p)=>e.jsx("div",{className:"grid grid-cols-7 gap-2",children:l.map((c,u)=>e.jsxs(O,{className:"aspect-square rounded-lg border cursor-pointer group relative overflow-hidden min-w-0",style:{backgroundColor:re(c.status,c.intensity),borderColor:c.status!=="none"?`color-mix(in srgb, ${re(c.status,1)} 40%, transparent)`:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px) saturate(120%)"},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:(p*7+u)*i.staggerDelay},whileHover:i.mode!=="low"?{scale:1.1,zIndex:10,transition:{duration:.2}}:void 0,title:`${c.dayName} ${c.dayNumber} ${c.monthName} - ${c.calories} kcal (${c.activitiesCount} activités, ${c.duration} min)`,fallback:e.jsxs("div",{className:"aspect-square rounded-lg border cursor-pointer group relative overflow-hidden min-w-0",style:{backgroundColor:re(c.status,c.intensity),borderColor:c.status!=="none"?`color-mix(in srgb, ${re(c.status,1)} 40%, transparent)`:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px) saturate(120%)"},title:`${c.dayName} ${c.dayNumber} ${c.monthName} - ${c.calories} kcal (${c.activitiesCount} activités, ${c.duration} min)`,children:[e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-0.5",children:[e.jsx("div",{className:"text-white text-xs font-bold leading-none",children:c.dayNumber}),c.activitiesCount>0&&e.jsx("div",{className:"text-white/80 text-xxs leading-none mt-0.5",children:c.activitiesCount})]}),i.mode!=="low"&&e.jsx("div",{className:"absolute inset-0 rounded-lg opacity-0 group-hover:opacity-30 transition-opacity duration-200",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, transparent 50%, rgba(255,255,255,0.1) 100%)"}})]}),children:[e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-0.5",children:[e.jsx("div",{className:"text-white text-xs font-bold leading-none",children:c.dayNumber}),c.activitiesCount>0&&e.jsx("div",{className:"text-white/80 text-xxs leading-none mt-0.5",children:c.activitiesCount})]}),i.mode!=="low"&&e.jsx("div",{className:"absolute inset-0 rounded-lg opacity-0 group-hover:opacity-30 transition-opacity duration-200",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, transparent 50%, rgba(255,255,255,0.1) 100%)"}})]},c.date))},p))})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-white/10 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-white/60 text-sm",children:"Moins actif"}),e.jsx("div",{className:"flex items-center gap-1",children:[.2,.4,.6,.8,1].map((l,p)=>e.jsx("div",{className:"w-3 h-3 rounded border border-white/20",style:{backgroundColor:re("excellent",l)}},p))}),e.jsx("span",{className:"text-white/60 text-sm",children:"Plus actif"})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 sm:gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsx("span",{className:"text-green-300",children:"Excellent"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400"}),e.jsx("span",{className:"text-blue-300",children:"Élevé"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300",children:"Modéré"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-400"}),e.jsx("span",{className:"text-red-300",children:"Faible"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl bg-cyan-500/10 border border-cyan-400/20 overflow-hidden",children:[e.jsxs("h4",{className:"text-cyan-300 font-medium text-sm mb-3 flex items-center gap-2",children:[e.jsx(m,{Icon:o.Info,size:12}),"Analyse des Patterns"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsxs("strong",{children:[n.excellenceRate,"%"]})," de jours avec activité excellente"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsx("strong",{children:n.avgCaloriesPerDay})," kcal brûlées en moyenne par jour"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsxs("strong",{children:[n.activityRate,"%"]})," de jours avec activité enregistrée"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsx("strong",{children:n.avgDurationPerDay})," min d'activité moyenne par jour"]})})]})]})]})})},Yt=({userId:t,period:r})=>{const s=te(),[i,a]=k.useState([]),[h,x]=k.useState(!0),n=r==="week"?7:r==="month"?30:90;if(k.useEffect(()=>{(async()=>{try{x(!0);const E=new Date;E.setDate(E.getDate()-n);const{data:B,error:T}=await V.from("activities").select("timestamp, calories_est").eq("user_id",t).gte("timestamp",E.toISOString()).not("calories_est","is",null).order("timestamp",{ascending:!0});if(T)throw T;if(B&&B.length>0){const D=new Map;B.forEach(K=>{const R=new Date(K.timestamp).toISOString().split("T")[0];D.has(R)||D.set(R,{date:R,calories:0,activitiesCount:0});const J=D.get(R);J.calories+=K.calories_est||0,J.activitiesCount+=1});const q=Array.from(D.values()).sort((K,R)=>K.date.localeCompare(R.date));a(q)}_.debug("CALORIE_EVOLUTION_CHART","Data fetched successfully",{count:B?.length})}catch(E){_.error("CALORIE_EVOLUTION_CHART","Failed to fetch calorie data",{error:E})}finally{x(!1)}})()},[t,n]),h)return e.jsx("div",{className:"h-80 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(i.length===0)return e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.Flame,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Évolution des Calories"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de calories disponible pour cette période."})]});const l=i.reduce((S,E)=>S+E.calories,0),p=l/i.length,c=Math.max(...i.map(S=>S.calories)),u=Math.min(...i.map(S=>S.calories)),g=i.slice(0,Math.floor(i.length/2)),d=i.slice(Math.floor(i.length/2)),v=g.reduce((S,E)=>S+E.calories,0)/g.length,j=d.reduce((S,E)=>S+E.calories,0)/d.length,b=j>v?"improving":j<v?"declining":"stable",F=(j-v)/v*100,y=b==="improving"?"#22C55E":b==="declining"?"#EF4444":"#06B6D4",f=b==="improving"?o.TrendingUp:b==="declining"?o.TrendingDown:o.Minus,C=c-u,N=Math.max(C*.2,10),w=Math.max(0,u-N),$=c+N,z=Math.max($-w,1),M=i.slice(0,s.maxDataPoints);return e.jsx(O,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:s.transitionDuration},fallback:e.jsx("div",{children:e.jsxs(I,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #EF4444 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.Flame,size:24,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution des Calories"}),e.jsxs("p",{className:"text-white/80 text-sm",children:[i.length," jours • Tendance ",b==="improving"?"à la hausse":b==="declining"?"à la baisse":"stable"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1.5 rounded-full mb-2",style:{background:`color-mix(in srgb, ${y} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 25%, transparent)`},children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(m,{Icon:f,size:12,style:{color:y}}),e.jsxs("span",{className:"text-sm font-medium",style:{color:y},children:[b==="improving"?"+":b==="declining"?"":"±",F.toFixed(1),"%"]})]})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:p.toFixed(0)}),e.jsx("p",{className:"text-white/60 text-xs",children:"kcal moy./jour"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #22C55E 10%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:c.toFixed(0)}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Maximum"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #F59E0B 10%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:l.toFixed(0)}),e.jsx("div",{className:"text-orange-300 text-sm font-medium",children:"Total"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:u.toFixed(0)}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Minimum"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx(m,{Icon:o.BarChart3,size:16,className:"text-orange-400"}),"Calories Brûlées par Jour"]}),e.jsx("div",{className:"relative h-48 bg-white/5 rounded-xl p-4 overflow-hidden",children:e.jsx("div",{className:"relative h-full flex items-end justify-between gap-1",children:M.map((S,E)=>{const B=z>0?(S.calories-w)/z*100:0,T=Math.max(B,5),D=S.calories===c;return e.jsxs(O,{className:"flex-1 group cursor-pointer relative",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},transition:{duration:s.transitionDuration,delay:E*s.staggerDelay},fallback:e.jsxs("div",{className:"flex-1 group cursor-pointer relative",children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${T}%`,minHeight:"8px",background:D?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:D?1:.8,boxShadow:D?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:P(ae(S.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[S.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[S.activitiesCount," activité",S.activitiesCount>1?"s":""]})]})]}),children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${T}%`,minHeight:"8px",background:D?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:D?1:.8,boxShadow:D?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:P(ae(S.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[S.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[S.activitiesCount," activité",S.activitiesCount>1?"s":""]})]})]},S.date)})})})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${y} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(m,{Icon:b==="improving"?o.TrendingUp:b==="declining"?o.TrendingDown:o.Info,size:14,style:{color:y},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:y},children:b==="improving"?"Dépense énergétique en hausse":b==="declining"?"Dépense énergétique en baisse":"Dépense énergétique stable"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${y}CC`},children:b==="improving"?"Excellente progression ! Continuez sur cette lancée.":b==="declining"?"Pensez à intensifier ou augmenter la fréquence de vos entraînements.":"Maintenez votre rythme actuel pour des résultats réguliers."})]})]})})]})}),children:e.jsxs(I,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #EF4444 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.Flame,size:24,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution des Calories"}),e.jsxs("p",{className:"text-white/80 text-sm",children:[M.length," jours • Tendance ",b==="improving"?"à la hausse":b==="declining"?"à la baisse":"stable"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1.5 rounded-full mb-2",style:{background:`color-mix(in srgb, ${y} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 25%, transparent)`},children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(m,{Icon:f,size:12,style:{color:y}}),e.jsxs("span",{className:"text-sm font-medium",style:{color:y},children:[b==="improving"?"+":b==="declining"?"":"±",F.toFixed(1),"%"]})]})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:p.toFixed(0)}),e.jsx("p",{className:"text-white/60 text-xs",children:"kcal moy./jour"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #22C55E 10%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:c.toFixed(0)}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Maximum"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #F59E0B 10%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:l.toFixed(0)}),e.jsx("div",{className:"text-orange-300 text-sm font-medium",children:"Total"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:u.toFixed(0)}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Minimum"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx(m,{Icon:o.BarChart3,size:16,className:"text-orange-400"}),"Calories Brûlées par Jour"]}),e.jsx("div",{className:"relative h-48 bg-white/5 rounded-xl p-4 overflow-hidden",children:e.jsx("div",{className:"relative h-full flex items-end justify-between gap-1",children:M.map((S,E)=>{const B=z>0?(S.calories-w)/z*100:0,T=Math.max(B,5),D=S.calories===c;return e.jsxs(O,{className:"flex-1 group cursor-pointer relative",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},transition:{duration:s.transitionDuration,delay:E*s.staggerDelay},fallback:e.jsxs("div",{className:"flex-1 group cursor-pointer relative",children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${T}%`,minHeight:"8px",background:D?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:D?1:.8,boxShadow:D?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:P(ae(S.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[S.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[S.activitiesCount," activité",S.activitiesCount>1?"s":""]})]})]}),children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${T}%`,minHeight:"8px",background:D?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:D?1:.8,boxShadow:D?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:P(ae(S.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[S.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[S.activitiesCount," activité",S.activitiesCount>1?"s":""]})]})]},S.date)})})})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${y} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(m,{Icon:b==="improving"?o.TrendingUp:b==="declining"?o.TrendingDown:o.Info,size:14,style:{color:y},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:y},children:b==="improving"?"Dépense énergétique en hausse":b==="declining"?"Dépense énergétique en baisse":"Dépense énergétique stable"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${y}CC`},children:b==="improving"?"Excellente progression ! Continuez sur cette lancée.":b==="declining"?"Pensez à intensifier ou augmenter la fréquence de vos entraînements.":"Maintenez votre rythme actuel pour des résultats réguliers."})]})]})})]})})},Ut=({userId:t,period:r})=>{const s=te(),[i,a]=k.useState([]),[h,x]=k.useState(!0),n=r==="week"?7:r==="month"?30:90,l=[{name:"Lun",number:1,color:"#3B82F6"},{name:"Mar",number:2,color:"#8B5CF6"},{name:"Mer",number:3,color:"#10B981"},{name:"Jeu",number:4,color:"#F59E0B"},{name:"Ven",number:5,color:"#EF4444"},{name:"Sam",number:6,color:"#EC4899"},{name:"Dim",number:0,color:"#06B6D4"}];if(k.useEffect(()=>{(async()=>{try{x(!0);const v=new Date;v.setDate(v.getDate()-n);const{data:j,error:b}=await V.from("activities").select("timestamp, calories_est, duration_min").eq("user_id",t).gte("timestamp",v.toISOString()).order("timestamp",{ascending:!0});if(b)throw b;if(j&&j.length>0){const F=new Map;l.forEach(f=>{F.set(f.number,{day:f.name,dayNumber:f.number,activitiesCount:0,totalCalories:0,totalDuration:0,color:f.color})}),j.forEach(f=>{const C=new Date(f.timestamp).getDay(),N=F.get(C);N.activitiesCount+=1,N.totalCalories+=f.calories_est||0,N.totalDuration+=f.duration_min||0});const y=Array.from(F.values()).sort((f,C)=>f.dayNumber===0?1:C.dayNumber===0?-1:f.dayNumber-C.dayNumber);a(y)}_.debug("WEEKLY_DISTRIBUTION_CHART","Data fetched successfully",{count:j?.length})}catch(v){_.error("WEEKLY_DISTRIBUTION_CHART","Failed to fetch weekly data",{error:v})}finally{x(!1)}})()},[t,n]),h)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(i.length===0)return e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 20%, transparent), color-mix(in srgb, #3B82F6 10%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(m,{Icon:o.Calendar,size:32,style:{color:"#3B82F6"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Distribution Hebdomadaire"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune activité disponible pour cette période."})]});const p=Math.max(...i.map(d=>d.activitiesCount)),c=i.reduce((d,v)=>d+v.activitiesCount,0),u=i.reduce((d,v)=>v.activitiesCount>d.activitiesCount?v:d),g=i.reduce((d,v)=>v.activitiesCount>0&&v.activitiesCount<d.activitiesCount?v:d,i[0]);return e.jsx(O,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:s.transitionDuration},fallback:e.jsx("div",{children:e.jsxs(I,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #3B82F6 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #3B82F6 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #3B82F6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #3B82F6 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(m,{Icon:o.Calendar,size:24,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Distribution Hebdomadaire"}),e.jsxs("p",{className:"text-white/80 text-sm",children:["Répartition de vos ",c," activités par jour de semaine"]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(m,{Icon:o.BarChart3,size:16,className:"text-blue-400"}),"Nombre d'Activités par Jour"]}),e.jsx("div",{className:"space-y-3",children:i.map((d,v)=>{const j=p>0?d.activitiesCount/p*100:0,b=d.day===u.day;return e.jsxs(O,{className:"relative",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:s.transitionDuration,delay:v*s.staggerDelay},fallback:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:d.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${d.color}40, ${d.color})`,border:`1px solid ${d.color}60`,boxShadow:b?`0 0 16px ${d.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:d.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[d.totalCalories.toFixed(0)," kcal"]})})]}),b&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${d.color}40`,border:`2px solid ${d.color}`,boxShadow:`0 0 12px ${d.color}80`},children:e.jsx(m,{Icon:o.Zap,size:12,style:{color:d.color}})})})]}),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:d.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx(O,{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{background:`linear-gradient(to right, ${d.color}40, ${d.color})`,border:`1px solid ${d.color}60`,boxShadow:b?`0 0 16px ${d.color}80`:"none"},initial:{width:0},animate:{width:`${Math.max(j,5)}%`},transition:{duration:s.transitionDuration,delay:v*s.staggerDelay},fallback:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${d.color}40, ${d.color})`,border:`1px solid ${d.color}60`,boxShadow:b?`0 0 16px ${d.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:d.activitiesCount})}),children:e.jsx("span",{className:"text-white font-bold text-sm",children:d.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[d.totalCalories.toFixed(0)," kcal"]})})]}),b&&s.enableComplexEffects&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx(O,{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${d.color}40`,border:`2px solid ${d.color}`,boxShadow:`0 0 12px ${d.color}80`},initial:{scale:0},animate:{scale:1},transition:{delay:s.staggerDelay*8,type:"spring"},fallback:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${d.color}40`,border:`2px solid ${d.color}`,boxShadow:`0 0 12px ${d.color}80`},children:e.jsx(m,{Icon:o.Zap,size:12,style:{color:d.color}})}),children:e.jsx(m,{Icon:o.Zap,size:12,style:{color:d.color}})})})]},d.day)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:`color-mix(in srgb, ${u.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${u.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.TrendingUp,size:14,style:{color:u.color}}),e.jsx("span",{className:"text-xs font-medium",style:{color:u.color},children:"Jour le + actif"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:u.day}),e.jsxs("div",{className:"text-sm text-white/70",children:[u.activitiesCount," activité",u.activitiesCount>1?"s":""]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.BarChart3,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-xs font-medium text-purple-300",children:"Moyenne/jour"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:(c/7).toFixed(1)}),e.jsx("div",{className:"text-sm text-white/70",children:"activités"})]})]}),e.jsx("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 6%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 18%, transparent)",backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(m,{Icon:o.Info,size:14,style:{color:"#3B82F6"},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-300",children:"Pattern hebdomadaire identifié"}),e.jsx("p",{className:"text-xs mt-1 text-blue-200",children:u.activitiesCount>c/7*1.5?`Pic d'activité le ${u.day}. Excellente régularité !`:g.activitiesCount===0?`Jour de repos le ${g.day}. Pensez à répartir vos efforts.`:"Distribution équilibrée tout au long de la semaine."})]})]})})]})}),children:e.jsxs(I,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #3B82F6 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #3B82F6 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #3B82F6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #3B82F6 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(m,{Icon:o.Calendar,size:24,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Distribution Hebdomadaire"}),e.jsxs("p",{className:"text-white/80 text-sm",children:["Répartition de vos ",c," activités par jour de semaine"]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(m,{Icon:o.BarChart3,size:16,className:"text-blue-400"}),"Nombre d'Activités par Jour"]}),e.jsx("div",{className:"space-y-3",children:i.map((d,v)=>{const j=p>0?d.activitiesCount/p*100:0,b=d.day===u.day;return e.jsxs(O,{className:"relative",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:s.transitionDuration,delay:v*s.staggerDelay},fallback:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:d.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${d.color}40, ${d.color})`,border:`1px solid ${d.color}60`,boxShadow:b?`0 0 16px ${d.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:d.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[d.totalCalories.toFixed(0)," kcal"]})})]}),b&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${d.color}40`,border:`2px solid ${d.color}`,boxShadow:`0 0 12px ${d.color}80`},children:e.jsx(m,{Icon:o.Zap,size:12,style:{color:d.color}})})})]}),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:d.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx(O,{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{background:`linear-gradient(to right, ${d.color}40, ${d.color})`,border:`1px solid ${d.color}60`,boxShadow:b?`0 0 16px ${d.color}80`:"none"},initial:{width:0},animate:{width:`${Math.max(j,5)}%`},transition:{duration:s.transitionDuration,delay:v*s.staggerDelay},fallback:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${d.color}40, ${d.color})`,border:`1px solid ${d.color}60`,boxShadow:b?`0 0 16px ${d.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:d.activitiesCount})}),children:e.jsx("span",{className:"text-white font-bold text-sm",children:d.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[d.totalCalories.toFixed(0)," kcal"]})})]}),b&&s.enableComplexEffects&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx(O,{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${d.color}40`,border:`2px solid ${d.color}`,boxShadow:`0 0 12px ${d.color}80`},initial:{scale:0},animate:{scale:1},transition:{delay:s.staggerDelay*8,type:"spring"},fallback:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${d.color}40`,border:`2px solid ${d.color}`,boxShadow:`0 0 12px ${d.color}80`},children:e.jsx(m,{Icon:o.Zap,size:12,style:{color:d.color}})}),children:e.jsx(m,{Icon:o.Zap,size:12,style:{color:d.color}})})})]},d.day)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:`color-mix(in srgb, ${u.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${u.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.TrendingUp,size:14,style:{color:u.color}}),e.jsx("span",{className:"text-xs font-medium",style:{color:u.color},children:"Jour le + actif"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:u.day}),e.jsxs("div",{className:"text-sm text-white/70",children:[u.activitiesCount," activité",u.activitiesCount>1?"s":""]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.BarChart3,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-xs font-medium text-purple-300",children:"Moyenne/jour"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:(c/7).toFixed(1)}),e.jsx("div",{className:"text-sm text-white/70",children:"activités"})]})]}),e.jsx("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 6%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 18%, transparent)",backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(m,{Icon:o.Info,size:14,style:{color:"#3B82F6"},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-300",children:"Pattern hebdomadaire identifié"}),e.jsx("p",{className:"text-xs mt-1 text-blue-200",children:u.activitiesCount>c/7*1.5?`Pic d'activité le ${u.day}. Excellente régularité !`:g.activitiesCount===0?`Jour de repos le ${g.day}. Pensez à répartir vos efforts.`:"Distribution équilibrée tout au long de la semaine."})]})]})})]})})},Zt=({userId:t,period:r})=>{const[s,i]=k.useState([]),[a,h]=k.useState(!0),x=r==="week"?7:r==="month"?30:90;if(k.useEffect(()=>{(async()=>{try{h(!0);const T=new Date;T.setDate(T.getDate()-x);const{data:D,error:q}=await V.from("activities").select("timestamp, vo2max_estimated").eq("user_id",t).gte("timestamp",T.toISOString()).not("vo2max_estimated","is",null).order("timestamp",{ascending:!0});if(q)throw q;if(D&&D.length>0){const K=D.map(R=>({date:new Date(R.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}),vo2max:R.vo2max_estimated}));i(K)}_.info("VO2MAX_CHART","Data fetched successfully",{count:D?.length})}catch(T){_.error("VO2MAX_CHART","Failed to fetch VO2max data",{error:T})}finally{h(!1)}})()},[t,x]),a)return e.jsx("div",{className:"h-80 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.TrendingUp,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Évolution VO2max"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée VO2max disponible pour cette période. Utilisez un objet connecté pour mesurer votre VO2max."})]});const n=Math.min(...s.map(B=>B.vo2max)),l=Math.max(...s.map(B=>B.vo2max)),p=s.reduce((B,T)=>B+T.vo2max,0)/s.length,c=s[s.length-1].vo2max,u=s[0].vo2max,g=c-u,d=g/u*100,j=(l-n)*.2,b=n-j,y=l+j-b,f=800,C=400,N={top:20,right:20,bottom:40,left:60},w=f-N.left-N.right,$=C-N.top-N.bottom,z=w/(s.length-1||1),M=s.map((B,T)=>{const D=N.left+T*z,q=N.top+$-(B.vo2max-b)/y*$;return`${D},${q}`}).join(" "),S=`M ${M.split(" ").join(" L ")}`,E="vo2max-gradient";return e.jsxs(I,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 25%, transparent), color-mix(in srgb, #3B82F6 15%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 20%, transparent)"},children:e.jsx(m,{Icon:o.Activity,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution VO2max"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Capacité cardiovasculaire maximale"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Actuel"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:c.toFixed(1)}),e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold mt-1",style:{background:g>=0?"color-mix(in srgb, #22C55E 15%, transparent)":"color-mix(in srgb, #EF4444 15%, transparent)",border:g>=0?"1px solid color-mix(in srgb, #22C55E 25%, transparent)":"1px solid color-mix(in srgb, #EF4444 25%, transparent)",color:g>=0?"#22C55E":"#EF4444"},children:[e.jsx(m,{Icon:g>=0?o.TrendingUp:o.TrendingDown,size:10}),g>=0?"+":"",d.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Minimum"}),e.jsx("p",{className:"text-white font-bold text-lg",children:n.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Moyenne"}),e.jsx("p",{className:"text-white font-bold text-lg",children:p.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Maximum"}),e.jsx("p",{className:"text-white font-bold text-lg",children:l.toFixed(1)})]})]}),e.jsx("div",{className:"relative",style:{width:"100%",height:"300px"},children:e.jsxs("svg",{viewBox:`0 0 ${f} ${C}`,style:{width:"100%",height:"100%"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:E,x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#3B82F6",stopOpacity:.4}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#3B82F6",stopOpacity:.05}})]})}),e.jsx("path",{d:`${S} L ${N.left+w},${N.top+$} L ${N.left},${N.top+$} Z`,fill:`url(#${E})`}),e.jsx("polyline",{points:M,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),s.map((B,T)=>{const D=N.left+T*z,q=N.top+$-(B.vo2max-b)/y*$;return e.jsxs("g",{children:[e.jsx("circle",{cx:D,cy:q,r:"5",fill:"#3B82F6",stroke:"rgba(255,255,255,0.3)",strokeWidth:"2"}),e.jsx("text",{x:D,y:N.top+$+25,textAnchor:"middle",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:B.date})]},T)}),[0,.25,.5,.75,1].map(B=>{const T=N.top+$*(1-B),D=b+y*B;return e.jsxs("g",{children:[e.jsx("line",{x1:N.left,y1:T,x2:N.left+w,y2:T,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1",strokeDasharray:"4,4"}),e.jsx("text",{x:N.left-10,y:T+4,textAnchor:"end",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:D.toFixed(0)})]},B)})]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"rgba(59, 130, 246, 0.08)",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.Info,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Interprétation"})]}),e.jsx("p",{className:"text-blue-200 text-sm leading-relaxed",children:c>=50?"Excellente capacité aérobie ! Maintenez ce niveau avec des entraînements variés.":c>=40?"Bonne capacité cardiovasculaire. Continuez à progresser avec des séances d'endurance.":"Marge de progression importante. Augmentez progressivement votre volume d'entraînement cardio."})]})]})},Wt=({userId:t,period:r})=>{const[s,i]=k.useState([]),[a,h]=k.useState(!0),x=r==="week"?7:r==="month"?30:90;if(k.useEffect(()=>{(async()=>{try{h(!0);const g=new Date;g.setDate(g.getDate()-x);const{data:d,error:v}=await V.from("activities").select("timestamp, hr_zone1_minutes, hr_zone2_minutes, hr_zone3_minutes, hr_zone4_minutes, hr_zone5_minutes").eq("user_id",t).gte("timestamp",g.toISOString()).not("hr_zone1_minutes","is",null).order("timestamp",{ascending:!0});if(v)throw v;if(d&&d.length>0){const j=new Map;d.forEach(F=>{const y=new Date(F.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"});j.has(y)||j.set(y,{date:y,z1:0,z2:0,z3:0,z4:0,z5:0});const f=j.get(y);f.z1+=F.hr_zone1_minutes||0,f.z2+=F.hr_zone2_minutes||0,f.z3+=F.hr_zone3_minutes||0,f.z4+=F.hr_zone4_minutes||0,f.z5+=F.hr_zone5_minutes||0});const b=Array.from(j.values());i(b)}_.info("HR_ZONES_HEATMAP","Data fetched successfully",{count:d?.length})}catch(g){_.error("HR_ZONES_HEATMAP","Failed to fetch HR zones data",{error:g})}finally{h(!1)}})()},[t,x]),a)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.Heart,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Heatmap Zones FC"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de zones de fréquence cardiaque disponible. Utilisez un objet connecté pour suivre vos zones FC."})]});const n=[{key:"z1",label:"Z1 Récupération",color:"#22C55E",lightColor:"#86EFAC"},{key:"z2",label:"Z2 Endurance",color:"#3B82F6",lightColor:"#93C5FD"},{key:"z3",label:"Z3 Tempo",color:"#F59E0B",lightColor:"#FCD34D"},{key:"z4",label:"Z4 Seuil",color:"#F97316",lightColor:"#FDBA74"},{key:"z5",label:"Z5 Max",color:"#EF4444",lightColor:"#FCA5A5"}],l=Math.max(...s.flatMap(u=>[u.z1,u.z2,u.z3,u.z4,u.z5])),p=s.reduce((u,g)=>u+g.z1+g.z2+g.z3+g.z4+g.z5,0),c={z1:s.reduce((u,g)=>u+g.z1,0)/p*100,z2:s.reduce((u,g)=>u+g.z2,0)/p*100,z3:s.reduce((u,g)=>u+g.z3,0)/p*100,z4:s.reduce((u,g)=>u+g.z4,0)/p*100,z5:s.reduce((u,g)=>u+g.z5,0)/p*100};return e.jsxs(I,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #EF4444 25%, transparent), color-mix(in srgb, #EF4444 15%, transparent))",border:"1px solid color-mix(in srgb, #EF4444 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EF4444 20%, transparent)"},children:e.jsx(m,{Icon:o.Heart,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Heatmap Zones FC"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Distribution du temps par zone de fréquence cardiaque"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"Distribution globale"}),e.jsxs("span",{className:"text-white/50 text-xs",children:[p.toFixed(0)," min total"]})]}),e.jsx("div",{className:"flex gap-1 h-3 rounded-full overflow-hidden",children:n.map(u=>{const g=c[u.key];return g===0?null:e.jsx("div",{style:{width:`${g}%`,background:u.color},title:`${u.label}: ${g.toFixed(1)}%`},u.key)})})]}),e.jsx("div",{className:"grid grid-cols-5 gap-3 mb-6",children:n.map(u=>{const g=c[u.key];return e.jsxs("div",{className:"p-3 rounded-lg",style:{background:`color-mix(in srgb, ${u.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${u.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:u.color}}),e.jsx("span",{className:"text-xs font-semibold",style:{color:u.lightColor},children:u.label})]}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[g.toFixed(0),"%"]})]},u.key)})}),e.jsx("div",{className:"rounded-xl p-4 overflow-x-auto",style:{background:"rgba(255,255,255,0.03)"},children:e.jsxs("div",{className:"min-w-max",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("div",{className:"w-20 flex-shrink-0"}),n.map(u=>e.jsx("div",{className:"w-16 text-center",children:e.jsx("span",{className:"text-xs font-semibold",style:{color:u.lightColor},children:u.key.toUpperCase()})},u.key))]}),s.slice(-14).map((u,g)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("div",{className:"w-20 flex-shrink-0 flex items-center",children:e.jsx("span",{className:"text-xs text-white/50",children:u.date})}),n.map(d=>{const v=u[d.key],j=v/l,b=Math.max(.1,j);return e.jsx("div",{className:"w-16 h-10 rounded flex items-center justify-center transition-all duration-200 hover:scale-105",style:{background:`color-mix(in srgb, ${d.color} ${b*100}%, transparent)`,border:v>0?`1px solid color-mix(in srgb, ${d.color} 30%, transparent)`:"1px solid rgba(255,255,255,0.05)"},title:`${u.date} - ${d.label}: ${v}min`,children:v>0&&e.jsx("span",{className:"text-xs font-semibold text-white",children:v.toFixed(0)})},d.key)})]},g))]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"rgba(239, 68, 68, 0.08)",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.Info,size:14,style:{color:"#EF4444"}}),e.jsx("span",{className:"text-red-300 font-semibold text-sm",children:"Analyse"})]}),e.jsx("p",{className:"text-red-200 text-sm leading-relaxed",children:c.z1+c.z2>60?"Excellent équilibre ! Vous passez la majorité du temps en zones d'endurance fondamentale.":c.z4+c.z5>30?"Attention : beaucoup de temps en zones intenses. Assurez-vous de suffisamment récupérer.":"Distribution équilibrée. Variez vos séances pour optimiser les adaptations cardiovasculaires."})]})]})},Jt=({userId:t,period:r})=>{const[s,i]=k.useState([]),[a,h]=k.useState(!0),x=r==="week"?7:r==="month"?30:90;if(k.useEffect(()=>{(async()=>{try{h(!0);const B=new Date;B.setDate(B.getDate()-x);const{data:T,error:D}=await V.from("activities").select("timestamp, training_load_score").eq("user_id",t).gte("timestamp",B.toISOString()).not("training_load_score","is",null).order("timestamp",{ascending:!0});if(D)throw D;if(T&&T.length>0){let R=0,J=0;const ge=[];T.forEach(be=>{const ve=be.training_load_score||0;R=R+(ve-R)/42,J=J+(ve-J)/7;const Ve=R-J;ge.push({date:new Date(be.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}),fitness:R,fatigue:J,form:Ve})}),i(ge)}_.info("FITNESS_FATIGUE_CHART","Data computed successfully",{count:T?.length})}catch(B){_.error("FITNESS_FATIGUE_CHART","Failed to compute fitness/fatigue",{error:B})}finally{h(!1)}})()},[t,x]),a)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.TrendingUp,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Fitness / Fatigue"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de charge d'entraînement disponible. Utilisez un objet connecté pour calculer automatiquement votre TRIMP."})]});const n=s[s.length-1],l=n.form;let p;l>10?p={label:"Forme Optimale",color:"#22C55E",advice:"Condition idéale pour une performance maximale. C'est le moment d'un objectif ambitieux !"}:l>0?p={label:"Forme Fraîche",color:"#3B82F6",advice:"Bonne forme générale. Maintenez l'équilibre entre entraînement et récupération."}:l>-10?p={label:"Forme Neutre",color:"#F59E0B",advice:"Équilibre précaire. Ajustez la charge selon vos sensations."}:l>-20?p={label:"Fatigue Modérée",color:"#F97316",advice:"Phase de fatigue accumulée. Privilégiez la récupération et réduisez l'intensité."}:p={label:"Fatigue Élevée",color:"#EF4444",advice:"Attention au surentraînement ! Repos obligatoire. Consultez un professionnel si persistant."};const c=Math.min(...s.flatMap(E=>[E.fitness,E.fatigue,E.form])),u=Math.max(...s.flatMap(E=>[E.fitness,E.fatigue,E.form])),d=(u-c)*.2,v=c-d,b=u+d-v,F=800,y=400,f={top:20,right:20,bottom:40,left:60},C=F-f.left-f.right,N=y-f.top-f.bottom,w=C/(s.length-1||1),$=E=>E.map((B,T)=>{const D=f.left+T*w,q=f.top+N-(B-v)/b*N;return T===0?`M ${D},${q}`:`L ${D},${q}`}).join(" "),z=$(s.map(E=>E.fitness)),M=$(s.map(E=>E.fatigue)),S=$(s.map(E=>E.form));return e.jsxs(I,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${p.color} 25%, transparent), color-mix(in srgb, ${p.color} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${p.color} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${p.color} 20%, transparent)`},children:e.jsx(m,{Icon:o.TrendingUp,size:24,style:{color:p.color}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Courbe Fitness / Fatigue"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Modèle de charge d'entraînement (CTL/ATL/TSB)"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-semibold mb-2",style:{background:`color-mix(in srgb, ${p.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${p.color} 25%, transparent)`,color:p.color},children:p.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:l.toFixed(1)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#3B82F6"}}),e.jsx("p",{className:"text-blue-300 text-xs font-medium",children:"Fitness (CTL)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:n.fitness.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#EF4444"}}),e.jsx("p",{className:"text-red-300 text-xs font-medium",children:"Fatigue (ATL)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:n.fatigue.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:`color-mix(in srgb, ${p.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${p.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:p.color}}),e.jsx("p",{className:"text-xs font-medium",style:{color:p.color},children:"Forme (TSB)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:n.form.toFixed(1)})]})]}),e.jsx("div",{className:"relative",style:{width:"100%",height:"300px"},children:e.jsxs("svg",{viewBox:`0 0 ${F} ${y}`,style:{width:"100%",height:"100%"},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"fitness-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#3B82F6",stopOpacity:.2}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#3B82F6",stopOpacity:.02}})]}),e.jsxs("linearGradient",{id:"fatigue-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#EF4444",stopOpacity:.2}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#EF4444",stopOpacity:.02}})]})]}),[0,.25,.5,.75,1].map(E=>{const B=f.top+N*(1-E),T=v+b*E;return e.jsxs("g",{children:[e.jsx("line",{x1:f.left,y1:B,x2:f.left+C,y2:B,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1",strokeDasharray:"4,4"}),e.jsx("text",{x:f.left-10,y:B+4,textAnchor:"end",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:T.toFixed(0)})]},E)}),e.jsx("path",{d:z,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:M,fill:"none",stroke:"#EF4444",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:S,fill:"none",stroke:p.color,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"6,4"}),s.filter((E,B)=>B%Math.max(1,Math.floor(s.length/8))===0).map((E,B)=>{const T=B*Math.max(1,Math.floor(s.length/8)),D=f.left+T*w;return e.jsx("text",{x:D,y:f.top+N+25,textAnchor:"middle",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:E.date},T)})]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${p.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${p.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{Icon:o.Lightbulb,size:14,style:{color:p.color}}),e.jsx("span",{className:"font-semibold text-sm",style:{color:p.color},children:"Conseil"})]}),e.jsx("p",{className:"text-sm leading-relaxed",style:{color:p.color},children:p.advice})]})]})},Kt=()=>{const t=X(),{profile:r}=L(),[s,i]=k.useState([]),[a,h]=k.useState(!0),[x,n]=k.useState(!1);k.useEffect(()=>{(async()=>{if(r?.id)try{h(!0);const v=[];i(v),_.info("CONNECTED_GOALS","Goals progress fetched",{count:v.length})}catch(v){_.error("CONNECTED_GOALS","Failed to fetch goals progress",{error:v})}finally{h(!1)}})()},[r?.id]);const l=async()=>{if(r?.id)try{n(!0),i([]),_.info("CONNECTED_GOALS","All goals recalculated successfully")}catch(d){_.error("CONNECTED_GOALS","Failed to recalculate goals",{error:d})}finally{n(!1)}};if(a)return e.jsx("div",{className:"space-y-4",children:[1,2].map(d=>e.jsx("div",{className:"h-32 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}},d))});if(s.length===0)return e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.Target,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Objectifs Connectés"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto leading-relaxed mb-6",children:"Créez des objectifs et ils se synchroniseront automatiquement avec vos activités et métriques biométriques pour suivre votre progression en temps réel."}),e.jsx("button",{onClick:()=>{_.info("CONNECTED_GOALS","User clicked Connect Device button",{from:"activity_progression_tab",destination:"/settings?tab=appareils",timestamp:new Date().toISOString()}),t("/settings?tab=appareils")},className:"px-6 py-3 rounded-xl font-semibold text-white transition-all hover:scale-105 active:scale-95",style:{background:"linear-gradient(135deg, #22C55E, #16A34A)",boxShadow:"0 4px 12px rgba(34, 197, 94, 0.3)"},children:"Connecter un Objet"})]});const p=d=>{switch(d){case"volume":return o.Clock;case"distance":return o.MapPin;case"endurance":return o.Activity;case"strength":return o.Zap;case"frequency":return o.Calendar;case"vo2max":return o.Heart;default:return o.Target}},c=(d,v)=>d>=100?{primary:"#22C55E",secondary:"#10B981"}:v?{primary:"#3B82F6",secondary:"#2563EB"}:{primary:"#F59E0B",secondary:"#D97706"},u=(d,v)=>{if(v==="km"||v==="kilometers")return`${d.toFixed(1)} km`;if(v==="minutes"||v==="min"){const j=Math.floor(d/60),b=Math.round(d%60);return j>0?`${j}h ${b}min`:`${b}min`}return v==="sessions"?`${Math.round(d)} séances`:v==="vo2max"?`${d.toFixed(1)} ml/kg/min`:`${d.toFixed(1)} ${v}`},g=d=>{if(!d)return"";const v=new Date(d),j=new Date,b=Math.ceil((v.getTime()-j.getTime())/(1e3*60*60*24));return b<0?"Échéance dépassée":b===0?"Aujourd'hui":b===1?"Demain":b<=7?`${b} jours`:v.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #8B5CF6 15%, transparent))",border:"1px solid color-mix(in srgb, #8B5CF6 35%, transparent)"},children:e.jsx(m,{Icon:o.Target,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Objectifs Connectés"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Synchronisés avec vos activités"})]})]}),e.jsxs("button",{onClick:l,disabled:x,className:"px-4 py-2 rounded-lg font-medium text-white/80 hover:text-white transition-all flex items-center gap-2",style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(m,{Icon:o.RefreshCw,size:16,className:x?"animate-spin":""}),x?"Synchronisation...":"Recalculer"]})]}),e.jsx("div",{className:"space-y-4",children:s.map(d=>{const v=d.goal,j=c(d.progress_percentage,d.on_track),b=p(v.goal_type);return e.jsxs(I,{className:"p-6",style:{background:d.progress_percentage>=100?"radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 12%, transparent) 0%, transparent 60%), var(--glass-opacity)":void 0},children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${j.primary} 25%, transparent), color-mix(in srgb, ${j.secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${j.primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${j.primary} 20%, transparent)`},children:e.jsx(m,{Icon:b,size:24,style:{color:j.primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:v.title}),d.progress_percentage>=100&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)",color:"#22C55E"},children:"Complété"}),!d.on_track&&d.progress_percentage<100&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{background:"color-mix(in srgb, #F59E0B 15%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 25%, transparent)",color:"#F59E0B"},children:"Retard"})]}),v.discipline&&e.jsx("p",{className:"text-white/50 text-sm",children:v.discipline}),v.deadline&&e.jsxs("p",{className:"text-white/50 text-xs mt-1",children:["Échéance: ",g(v.deadline)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-3xl font-bold text-white",children:[d.progress_percentage.toFixed(0),"%"]}),e.jsx("p",{className:"text-white/50 text-xs",children:"progression"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"relative h-3 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.1)"},children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-500",style:{width:`${Math.min(d.progress_percentage,100)}%`,background:`linear-gradient(90deg, ${j.primary}, ${j.secondary})`,boxShadow:`0 0 12px ${j.primary}`}})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Actuel"}),e.jsx("p",{className:"text-white font-semibold",children:u(v.current_value,v.unit)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Objectif"}),e.jsx("p",{className:"text-white font-semibold",children:u(v.target_value,v.unit)})]})]}),d.remaining>0&&e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.03)"},children:[e.jsxs("p",{className:"text-white/70 text-sm",children:["Encore ",u(d.remaining,v.unit)," pour atteindre l'objectif"]}),d.estimated_completion_date&&e.jsxs("p",{className:"text-white/50 text-xs mt-1",children:["Estimation: ",new Date(d.estimated_completion_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})]})]})]})]},v.id)})})]})},Xt=()=>{const t=X(),{isPerformanceMode:r}=oe(),s=r?"div":A.div,i=()=>{t("/activity/input")};return e.jsx(s,{...!r&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"}},className:"text-center py-12 py-1",children:e.jsx(I,{className:"p-8",style:{background:`radial-gradient(ellipse at center,
            rgba(16, 185, 129, 0.15) 0%,
            rgba(52, 211, 153, 0.08) 50%,
            rgba(0, 0, 0, 0.4) 100%)`,borderColor:"rgba(16, 185, 129, 0.3)",boxShadow:`
            0 0 30px rgba(16, 185, 129, 0.2),
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1)
          `,backdropFilter:"blur(20px) saturate(1.2)"},children:e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                rgba(16, 185, 129, 0.3) 0%,
                rgba(52, 211, 153, 0.15) 70%,
                transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                0 0 25px rgba(16, 185, 129, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(m,{Icon:o.TrendingUp,size:48,className:"text-green-400",style:{filter:`drop-shadow(0 0 12px rgba(16, 185, 129, 0.8))
                         drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3))`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Analysez votre progression sportive"}),e.jsx("p",{className:"text-white/70 text-lg",children:"Enregistrez vos activités pour visualiser votre évolution"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(16, 185, 129, 0.3) 0%,
                    rgba(52, 211, 153, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                    0 0 20px rgba(16, 185, 129, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Activity,size:24,className:"text-green-400",style:{filter:`drop-shadow(0 0 8px rgba(16, 185, 129, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Courbes de performance"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Suivez vos calories et intensités au fil du temps"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(16, 185, 129, 0.3) 0%,
                    rgba(52, 211, 153, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                    0 0 20px rgba(16, 185, 129, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Award,size:24,className:"text-green-400",style:{filter:`drop-shadow(0 0 8px rgba(16, 185, 129, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Records personnels"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Identifiez vos meilleures performances"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(16, 185, 129, 0.3) 0%,
                    rgba(52, 211, 153, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(16, 185, 129, 0.4)",boxShadow:`
                    0 0 20px rgba(16, 185, 129, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Zap,size:24,className:"text-green-400",style:{filter:`drop-shadow(0 0 8px rgba(16, 185, 129, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Analyse de tendances"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Détectez vos patterns d'entraînement"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:i,className:"group relative px-8 py-4 text-white font-semibold rounded-2xl transform hover:scale-105 transition-all duration-300",style:{background:`linear-gradient(135deg,
                  rgba(16, 185, 129, 0.8) 0%,
                  rgba(52, 211, 153, 0.9) 100%)`,border:"2px solid rgba(16, 185, 129, 0.6)",boxShadow:`
                  0 0 30px rgba(16, 185, 129, 0.4),
                  0 8px 25px rgba(0, 0, 0, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(10px) saturate(1.2)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{Icon:o.Plus,size:24,className:"group-hover:rotate-90 transition-transform duration-300",style:{color:"white",filter:`drop-shadow(0 0 10px rgba(16, 185, 129, 0.8))
                             drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3))`}}),e.jsx("span",{className:"text-lg",children:"Enregistrer mes activités"})]}),e.jsx("div",{className:"absolute inset-0 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300 -z-10",style:{background:`linear-gradient(135deg,
                    rgba(16, 185, 129, 0.6) 0%,
                    rgba(52, 211, 153, 0.6) 100%)`}})]})}),e.jsx("div",{className:"text-white/50 text-sm p-3 rounded-xl",style:{background:`radial-gradient(ellipse at center,
                rgba(16, 185, 129, 0.1) 0%,
                transparent 70%)`,border:"1px solid rgba(16, 185, 129, 0.2)",boxShadow:"0 0 15px rgba(16, 185, 129, 0.1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{Icon:o.Lightbulb,size:16,className:"text-green-400",style:{filter:"drop-shadow(0 0 6px rgba(16, 185, 129, 0.6))"}}),e.jsx("span",{children:"Astuce : Plus vous enregistrez d'activités, plus les analyses sont précises !"})]})})]})})})},he={week:"last7Days",month:"last30Days",quarter:"last3Months"};function Ie(t,r){_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Calculating default period",{hasActivityHistory:t,currentActivities:r,weekThreshold:Y("last7Days"),monthThreshold:Y("last30Days"),quarterThreshold:Y("last3Months"),calculationTime:new Date().toISOString(),timestamp:new Date().toISOString()});const s=Y("last7Days");_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Threshold checks",{currentActivities:r,weekThreshold:s,weekAvailable:r>=s,timestamp:new Date().toISOString()});let i="week";return!t||r<s?(i="week",_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period: week (insufficient data or no history)",{hasActivityHistory:t,currentActivities:r,weekThreshold:s,timestamp:new Date().toISOString()})):(i="week",_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period: week (prioritized to avoid auto API calls)",{currentActivities:r,weekThreshold:s,reasoning:"always_prioritize_week_to_avoid_costly_auto_calls",timestamp:new Date().toISOString()})),_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period calculated",{defaultPeriod:i,reasoning:"always_week_to_prevent_auto_expensive_calls",finalDecision:i,calculationComplete:!0,costOptimization:"prevents_automatic_30day_90day_api_calls",timestamp:new Date().toISOString()}),i}function Qt(t,r){const s=he[t],i=Y(s);return r>=i}const es=()=>{const{profile:t}=L(),{showToast:r}=ie(),{click:s}=W(),{showModal:i}=Be(),{data:a=!1}=Me(),[h,x]=k.useState(0),n=ne(w=>w.selectedPeriod),l=ne(w=>w.setSelectedPeriod),[p,c]=k.useState(!1),u=he[n],{data:g,isLoading:d,error:v}=De(u);k.useEffect(()=>{g&&_.info("ACTIVITY_PROGRESS_TAB_DATA","Insights data received",{hasData:!!g,hasDistribution:!!g.distribution,hasActivities:!!g.activities,activitiesCount:g.activities?.length||0,distributionKeys:g.distribution?Object.keys(g.distribution):[],hasSummary:!!g.summary,summaryKeys:g.summary?Object.keys(g.summary):[],timestamp:new Date().toISOString()})},[g]);const[j,b]=k.useState(!1);k.useEffect(()=>{const w=()=>{const $=window.location.hash.replace("#","");b($==="progression")};return w(),window.addEventListener("hashchange",w),()=>window.removeEventListener("hashchange",w)},[]);const F=ke(({currentLocation:w,nextLocation:$})=>{const z=j&&d&&w.pathname!==$.pathname;return z&&(_.debug("ACTIVITY_PROGRESS_TAB","Navigation blocked during analysis loading",{currentPath:w.pathname,nextPath:$.pathname,isLoading:d,timestamp:new Date().toISOString()}),i({title:"Attention ! Analyse de progression en cours",message:"Voulez-vous vraiment quitter l'analyse de progression ? Les données d'analyse pourraient être perdues et devront être régénérées.",processName:"Analyse de Progression",onConfirm:()=>{_.info("ACTIVITY_PROGRESS_TAB","User confirmed exit during analysis",{currentPath:w.pathname,nextPath:$.pathname,timestamp:new Date().toISOString()}),F.proceed?.()},onCancel:()=>{_.info("ACTIVITY_PROGRESS_TAB","User cancelled exit during analysis",{currentPath:w.pathname,nextPath:$.pathname,timestamp:new Date().toISOString()}),F.reset?.()}})),z}),y=g?.fallback,f=g?.cached;k.useEffect(()=>{if(g?.current_activities!==void 0)if(_.info("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Activities count updated from insights data",{previousCount:h,newCount:g.current_activities,summaryTotalActivities:g.summary?.total_activities,dataConsistency:g.current_activities===g.summary?.total_activities?"consistent":"inconsistent",selectedPeriod:n,userHasSelectedPeriod:p,cacheStatus:g.cached?"cached":"fresh",willRespectUserChoice:p,timestamp:new Date().toISOString()}),x(g.current_activities),p){const w=Qt(n,g.current_activities);if(_.debug("ACTIVITY_PROGRESS_TAB","Checking user-selected period validity",{selectedPeriod:n,activitiesCount:g.current_activities,isCurrentPeriodValid:w,userHasSelectedPeriod:p,willRespectUserChoice:!0,timestamp:new Date().toISOString()}),!w){const $=Ie(a,g.current_activities);_.warn("ACTIVITY_PROGRESS_TAB","User-selected period no longer valid, falling back",{invalidPeriod:n,fallbackPeriod:$,activitiesCount:g.current_activities,reason:"user_selected_period_became_invalid",timestamp:new Date().toISOString()}),l($),c(!1),r({type:"info",title:"Période ajustée",message:`Période changée vers ${$==="week"?"7 jours":$==="month"?"30 jours":"90 jours"} (données insuffisantes pour la période précédente)`,duration:4e3})}}else{const w=Ie(a,g.current_activities);_.debug("ACTIVITY_PROGRESS_TAB","Auto-calculating period (no user selection)",{currentSelectedPeriod:n,newDefaultPeriod:w,activitiesCount:g.current_activities,willAutoSwitch:w!==n&&!p,timestamp:new Date().toISOString()}),w!==n&&!p&&(_.debug("ACTIVITY_PROGRESS_TAB","Auto-switching to calculated period",{from:n,to:w,reason:"automatic_calculation_respecting_no_user_selection",timestamp:new Date().toISOString()}),l(w))}},[g?.current_activities,p,n,a]),k.useEffect(()=>{v&&(_.error("ACTIVITY_PROGRESS_TAB","Erreur lors de la génération des insights",{error:v instanceof Error?v.message:"Unknown error",selectedPeriod:n,timestamp:new Date().toISOString()}),r({type:"error",title:"Erreur d'analyse",message:"Impossible de générer les insights. Veuillez réessayer.",duration:4e3}))},[v,n,r]);const C=w=>{s(),c(!0),l(w),_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Period changed by user",{newPeriod:w,apiPeriod:he[w],userAction:!0,manualSelection:!0,userHasSelectedPeriod:!0,timestamp:new Date().toISOString()})},N={week:Y("last7Days"),month:Y("last30Days"),quarter:Y("last3Months")};return a?g?.insufficient_data?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{selectedPeriod:n,onPeriodChange:C,currentActivities:h,periodThresholds:N,accentColor:"#10B981"}),e.jsxs(I,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.AlertCircle,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Forge en Construction"}),e.jsx("p",{className:"text-white/70 text-base",children:"Plus d'activités nécessaires"})]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg mx-auto",children:[e.jsxs("p",{className:"text-white/80 text-lg leading-relaxed",children:["Vous avez ",e.jsx("strong",{className:"text-orange-300",children:g.current_activities})," activité",g.current_activities>1?"s":""," enregistrée",g.current_activities>1?"s":"","."]}),e.jsxs("p",{className:"text-white/70 text-base leading-relaxed",children:["Il vous faut au moins ",e.jsx("strong",{className:"text-orange-300",children:g.required_activities})," activités pour générer des insights personnalisés sur cette période."]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(m,{Icon:o.Zap,size:16,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Passez à l'action !"})]}),e.jsxs("p",{className:"text-blue-200 text-sm leading-relaxed",children:["Enregistrez ",g.required_activities-g.current_activities," activité",g.required_activities-g.current_activities>1?"s":""," supplémentaire",g.required_activities-g.current_activities>1?"s":"","pour débloquer vos insights personnalisés et découvrir des recommandations sur mesure."]})]})]})]})]}):y&&g?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{selectedPeriod:n,onPeriodChange:C,currentActivities:h,periodThresholds:N,accentColor:"#10B981"}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-amber-800 text-sm",children:"⚠️ Analyse détaillée temporairement indisponible. Voici les visualisations de base."})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(_e,{data:g?.distribution,period:n,apiPeriod:u}),e.jsx(Ce,{activities:g?.activities||[],period:n,apiPeriod:u})]})})]}):e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(Q,{selectedPeriod:n,onPeriodChange:C,currentActivities:h,periodThresholds:N,accentColor:"#10B981"}),f&&e.jsx(I,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #22C55E 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #22C55E 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)"},children:e.jsx(m,{Icon:o.Check,size:14,style:{color:"#22C55E"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-medium text-sm",children:"Données mises en cache"}),e.jsxs("p",{className:"text-green-200 text-xs mt-0.5",children:["Dernière analyse: ",g.cache_age_hours,"h • Économie de coûts IA"]})]})]})}),d?e.jsx(Re,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{className:"p-6",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
                var(--glass-opacity)
              `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                  `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Visualisez votre évolution énergétique"}),e.jsx("p",{className:"text-green-200 text-sm",children:"Graphiques et tendances de vos activités sur la période sélectionnée"})]})]})}),g&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.distribution?e.jsx(_e,{data:g.distribution,period:n,apiPeriod:u}):e.jsxs(I,{className:"p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.BarChart3,size:24,style:{color:"#F59E0B"}})}),e.jsx("h4",{className:"text-lg font-semibold text-white mb-2",children:"Distribution non disponible"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Continuez à enregistrer des activités pour générer ce graphique"})]}),g.activities&&g.activities.length>0?e.jsx(Ce,{activities:g.activities,period:n,apiPeriod:u}):e.jsxs(I,{className:"p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(m,{Icon:o.Calendar,size:24,style:{color:"#F59E0B"}})}),e.jsx("h4",{className:"text-lg font-semibold text-white mb-2",children:"Heatmap non disponible"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Enregistrez plus d'activités pour visualiser votre heatmap"})]})]}),t?.id&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Yt,{userId:t.id,period:n}),e.jsx(Ut,{userId:t.id,period:n})]}),t?.id&&e.jsx("div",{className:"space-y-6",children:e.jsx(Kt,{})}),t?.id&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Zt,{userId:t.id,period:n}),e.jsx(Wt,{userId:t.id,period:n}),e.jsx(Jt,{userId:t.id,period:n})]}),e.jsx(I,{className:"p-6 text-center",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 60%),
                var(--glass-opacity)
              `,borderColor:"color-mix(in srgb, #F59E0B 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(m,{Icon:o.Lightbulb,size:16,style:{color:"#F59E0B"}}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Consultez l'onglet ",e.jsx("strong",{className:"text-orange-300",children:"Insights"})," pour des conseils personnalisés basés sur ces données"]})]})})]})]}):e.jsx(Xt,{})},ts=({activity:t,onClose:r,onDelete:s})=>{const{click:i}=W(),a=l=>{l.target===l.currentTarget&&(i(),r())},h=()=>{s&&(s(t.id),r())},x=H(t.intensity),n=Ee(t.type);return He.createPortal(e.jsx(Te,{children:e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},onClick:a,role:"dialog","aria-modal":"true","aria-labelledby":"activity-detail-title",children:e.jsx(A.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"w-full max-w-lg",onClick:l=>l.stopPropagation(),children:e.jsxs(I,{className:"p-6",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, ${x} 12%, transparent) 0%, transparent 60%),
                radial-gradient(circle at 70% 80%, color-mix(in srgb, ${x} 8%, transparent) 0%, transparent 50%),
                linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.10)),
                rgba(11, 14, 23, 0.95)
              `,borderColor:`color-mix(in srgb, ${x} 30%, transparent)`,boxShadow:`
                0 25px 80px rgba(0, 0, 0, 0.6),
                0 0 60px color-mix(in srgb, ${x} 30%, transparent),
                inset 0 3px 0 rgba(255, 255, 255, 0.3),
                inset 0 -3px 0 rgba(0, 0, 0, 0.2)
              `,backdropFilter:"blur(32px) saturate(180%)",WebkitBackdropFilter:"blur(32px) saturate(180%)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                      linear-gradient(135deg, color-mix(in srgb, ${x} 40%, transparent), color-mix(in srgb, ${x} 30%, transparent))
                    `,border:`3px solid color-mix(in srgb, ${x} 60%, transparent)`,boxShadow:`0 0 30px color-mix(in srgb, ${x} 50%, transparent)`},children:e.jsx(m,{Icon:o[n],size:28,style:{color:x},variant:"pure"})}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("h2",{id:"activity-detail-title",className:"text-2xl font-bold text-white mb-1",children:t.type}),e.jsx("p",{className:"text-white/70 text-sm mb-2",children:P(new Date(t.timestamp),"EEEE dd MMMM yyyy à HH:mm",{locale:G})}),e.jsx(ee,{activityId:t.id})]})})]}),e.jsx("button",{onClick:r,className:"p-2 rounded-full transition-all duration-200",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},"aria-label":"Fermer le détail",children:e.jsx(m,{Icon:o.X,size:18,className:"text-white/80"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 20%, transparent)`},children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.duration_min}),e.jsx("div",{className:"text-white/70 text-sm",children:"Minutes"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 20%, transparent)`},children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.calories_est}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 20%, transparent)`},children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:Ae(t.intensity)}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité"})]})]}),t.notes&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 15%, transparent)`},children:[e.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[e.jsx(m,{Icon:o.FileText,size:14,style:{color:x}}),"Notes"]}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:t.notes})]}),e.jsx("div",{className:"mb-6",children:e.jsx(ee,{activityId:t.id,showDetails:!0})}),e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(m,{Icon:o.Info,size:14,className:"text-white/70"}),"Informations Techniques"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"ID :"}),e.jsxs("div",{className:"text-white/80 font-mono text-xs mt-1",children:[t.id.substring(0,8),"..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"Créé le :"}),e.jsx("div",{className:"text-white/80 text-xs mt-1",children:P(new Date(t.created_at),"dd/MM/yyyy HH:mm")})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[s&&e.jsx("button",{onClick:h,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:`linear-gradient(135deg, 
                      color-mix(in srgb, #EF4444 80%, transparent), 
                      color-mix(in srgb, #F59E0B 60%, transparent)
                    )`,border:"2px solid color-mix(in srgb, #EF4444 60%, transparent)",boxShadow:`
                      0 12px 40px color-mix(in srgb, #EF4444 40%, transparent),
                      0 0 60px color-mix(in srgb, #EF4444 30%, transparent),
                      inset 0 3px 0 rgba(255,255,255,0.4)
                    `,backdropFilter:"blur(20px) saturate(160%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{Icon:o.Trash2,size:16,className:"text-white"}),e.jsx("span",{children:"Supprimer"})]})}),e.jsx("button",{onClick:r,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:`linear-gradient(135deg, 
                    color-mix(in srgb, #6B7280 80%, transparent), 
                    color-mix(in srgb, #9CA3AF 60%, transparent)
                  )`,border:"2px solid color-mix(in srgb, #6B7280 60%, transparent)",boxShadow:`
                    0 8px 32px color-mix(in srgb, #6B7280 30%, transparent),
                    inset 0 2px 0 rgba(255,255,255,0.3)
                  `,backdropFilter:"blur(16px) saturate(140%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{Icon:o.X,size:16,className:"text-white"}),e.jsx("span",{children:"Fermer"})]})})]})]})})})}),document.body)},ss=()=>{const t=X(),{isPerformanceMode:r}=oe(),s=r?"div":A.div,i=()=>{t("/activity/input")};return e.jsx(s,{...!r&&{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"}},className:"text-center py-12 py-1",children:e.jsx(I,{className:"p-8",style:{background:`radial-gradient(ellipse at center,
            rgba(139, 92, 246, 0.15) 0%,
            rgba(167, 139, 250, 0.08) 50%,
            rgba(0, 0, 0, 0.4) 100%)`,borderColor:"rgba(139, 92, 246, 0.3)",boxShadow:`
            0 0 30px rgba(139, 92, 246, 0.2),
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1)
          `,backdropFilter:"blur(20px) saturate(1.2)"},children:e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                rgba(139, 92, 246, 0.3) 0%,
                rgba(167, 139, 250, 0.15) 70%,
                transparent 100%)`,border:"1px solid rgba(139, 92, 246, 0.4)",boxShadow:`
                0 0 25px rgba(139, 92, 246, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(m,{Icon:o.History,size:48,className:"text-violet-400",style:{filter:`drop-shadow(0 0 12px rgba(139, 92, 246, 0.8))
                         drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3))`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Construisez votre historique d'activités"}),e.jsx("p",{className:"text-white/70 text-lg",children:"Enregistrez vos premières activités pour suivre votre évolution"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(139, 92, 246, 0.3) 0%,
                    rgba(167, 139, 250, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(139, 92, 246, 0.4)",boxShadow:`
                    0 0 20px rgba(139, 92, 246, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.Clock,size:24,className:"text-violet-400",style:{filter:`drop-shadow(0 0 8px rgba(139, 92, 246, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Timeline complète"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Visualisez toutes vos activités dans l'ordre chronologique"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(139, 92, 246, 0.3) 0%,
                    rgba(167, 139, 250, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(139, 92, 246, 0.4)",boxShadow:`
                    0 0 20px rgba(139, 92, 246, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.TrendingUp,size:24,className:"text-violet-400",style:{filter:`drop-shadow(0 0 8px rgba(139, 92, 246, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Progression mesurée"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Suivez votre évolution semaine après semaine"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle,
                    rgba(139, 92, 246, 0.3) 0%,
                    rgba(167, 139, 250, 0.1) 70%,
                    transparent 100%)`,border:"1px solid rgba(139, 92, 246, 0.4)",boxShadow:`
                    0 0 20px rgba(139, 92, 246, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(m,{Icon:o.BarChart,size:24,className:"text-violet-400",style:{filter:`drop-shadow(0 0 8px rgba(139, 92, 246, 0.6))
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Statistiques détaillées"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Accédez aux métriques de chaque activité"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:i,className:"group relative px-8 py-4 text-white font-semibold rounded-2xl transform hover:scale-105 transition-all duration-300",style:{background:`linear-gradient(135deg,
                  rgba(139, 92, 246, 0.8) 0%,
                  rgba(167, 139, 250, 0.9) 100%)`,border:"2px solid rgba(139, 92, 246, 0.6)",boxShadow:`
                  0 0 30px rgba(139, 92, 246, 0.4),
                  0 8px 25px rgba(0, 0, 0, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(10px) saturate(1.2)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{Icon:o.Plus,size:24,className:"group-hover:rotate-90 transition-transform duration-300",style:{color:"white",filter:`drop-shadow(0 0 10px rgba(139, 92, 246, 0.8))
                             drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3))`}}),e.jsx("span",{className:"text-lg",children:"Enregistrer ma première activité"})]}),e.jsx("div",{className:"absolute inset-0 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300 -z-10",style:{background:`linear-gradient(135deg,
                    rgba(139, 92, 246, 0.6) 0%,
                    rgba(167, 139, 250, 0.6) 100%)`}})]})}),e.jsx("div",{className:"text-white/50 text-sm p-3 rounded-xl",style:{background:`radial-gradient(ellipse at center,
                rgba(139, 92, 246, 0.1) 0%,
                transparent 70%)`,border:"1px solid rgba(139, 92, 246, 0.2)",boxShadow:"0 0 15px rgba(139, 92, 246, 0.1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{Icon:o.Lightbulb,size:16,className:"text-violet-400",style:{filter:"drop-shadow(0 0 6px rgba(139, 92, 246, 0.6))"}}),e.jsx("span",{children:"Astuce : Connectez votre montre pour synchroniser automatiquement votre historique complet !"})]})})]})})})},rs=()=>{const{profile:t}=L(),{click:r,success:s,error:i}=W(),{showToast:a}=ie();Fe();const h=t?.userId,[x,n]=Ge.useState(null),{data:l,isLoading:p,error:c}=nt(100);k.useEffect(()=>{l!==void 0&&_.info("ACTIVITY_HISTORY_TAB_DIAGNOSTIC","Activity history loaded",{activitiesCount:l?.length||0,hasActivities:(l?.length||0)>0,isLoading:p,hasError:!!c,userId:h,timestamp:new Date().toISOString()})},[l,p,c,h]);const u=$e();k.useEffect(()=>{c&&(_.error("ACTIVITY_HISTORY_TAB","Failed to load activity history",{error:c instanceof Error?c.message:"Unknown error",userId:h,timestamp:new Date().toISOString()}),i(),a({type:"error",title:"Erreur de Chargement",message:"Impossible de charger votre historique d'activités.",duration:4e3}))},[c,h,i,a]);const g=k.useMemo(()=>l?l.reduce((b,F)=>{const y=P(new Date(F.timestamp),"yyyy-MM-dd");return b[y]||(b[y]=[]),b[y].push(F),b},{}):{},[l]),d=b=>{const F=new Date(b);return it(F)?"Aujourd'hui":at(F)?"Hier":P(F,"EEEE dd MMMM",{locale:G})},v=b=>{r(),n(b),_.info("ACTIVITY_HISTORY_TAB","Activity detail opened",{activityId:b.id,activityType:b.type,userId:h,timestamp:new Date().toISOString()})},j=b=>{_.info("ACTIVITY_HISTORY_TAB","Delete activity requested from history",{activityId:b,userId:h,timestamp:new Date().toISOString()}),u.mutate(b)};return p?e.jsx("div",{className:"space-y-6",children:[...Array(5)].map((b,F)=>e.jsx(I,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-1/2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-16 bg-white/5 rounded-xl"}),e.jsx("div",{className:"h-16 bg-white/5 rounded-xl"})]})]})},F))}):!l||l.length===0?e.jsx(ss,{}):e.jsxs(e.Fragment,{children:[e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6 w-full",children:Object.entries(g).map(([b,F])=>{const y=F.reduce((C,N)=>C+N.calories_est,0),f=F.reduce((C,N)=>C+N.duration_min,0);return e.jsx("div",{className:"activity-group-enter",children:e.jsxs(I,{className:"p-6",style:{background:`
                    radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
                    var(--glass-opacity)
                  `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                          linear-gradient(135deg, color-mix(in srgb, #8B5CF6 30%, transparent), color-mix(in srgb, #8B5CF6 20%, transparent))
                        `,border:"2px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent)"},children:e.jsx(m,{Icon:o.Calendar,size:18,style:{color:"#8B5CF6"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-xl",children:d(b)}),e.jsx("p",{className:"text-blue-200 text-sm",children:"Forge énergétique de la journée"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[y," kcal"]}),e.jsxs("div",{className:"text-white/60 text-sm",children:[F.length," activité",F.length>1?"s":""," • ",f," min"]})]})]}),e.jsx("div",{className:"space-y-3",children:F.map((C,N)=>e.jsx("div",{className:"group relative",children:e.jsx("div",{className:"p-5 rounded-xl cursor-pointer transition-all duration-200 hover:scale-[1.02] activity-item-enter",style:{background:`color-mix(in srgb, ${H(C.intensity)} 4%, transparent)`,border:`1px solid color-mix(in srgb, ${H(C.intensity)} 12%, transparent)`,backdropFilter:"blur(8px) saturate(120%)",animationDelay:`${N*.1}s`},onMouseEnter:w=>{w.currentTarget.style.background=`color-mix(in srgb, ${H(C.intensity)} 8%, transparent)`,w.currentTarget.style.borderColor=`color-mix(in srgb, ${H(C.intensity)} 20%, transparent)`,w.currentTarget.style.boxShadow=`0 4px 16px color-mix(in srgb, ${H(C.intensity)} 15%, transparent)`},onMouseLeave:w=>{w.currentTarget.style.background=`color-mix(in srgb, ${H(C.intensity)} 4%, transparent)`,w.currentTarget.style.borderColor=`color-mix(in srgb, ${H(C.intensity)} 12%, transparent)`,w.currentTarget.style.boxShadow="none"},onClick:()=>v(C),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.12) 0%, transparent 60%),
                                  linear-gradient(135deg, color-mix(in srgb, ${H(C.intensity)} 25%, transparent), color-mix(in srgb, ${H(C.intensity)} 15%, transparent))
                                `,border:`1px solid color-mix(in srgb, ${H(C.intensity)} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${H(C.intensity)} 20%, transparent)`},children:e.jsx(m,{Icon:o[Ee(C.type)],size:18,style:{color:H(C.intensity)}})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-semibold text-lg",children:C.type}),e.jsxs("div",{className:"text-white/70 text-sm",children:[Ae(C.intensity)," • ",P(new Date(C.timestamp),"HH:mm")]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[C.duration_min," min"]}),e.jsxs("div",{className:"text-white/60 text-sm",children:[C.calories_est," kcal"]})]}),e.jsx("button",{onClick:w=>{w.stopPropagation(),j(C.id)},disabled:u.isPending,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-2 rounded-full",style:{background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)"},title:"Supprimer cette activité",children:u.isPending?e.jsx(m,{Icon:o.Loader2,size:14,className:"text-red-400 animate-spin"}):e.jsx(m,{Icon:o.Trash2,size:14,className:"text-red-400"})})]})]})})},C.id))})]})},b)})}),e.jsx(Te,{children:x&&e.jsx(ts,{activity:x,onClose:()=>n(null),onDelete:j})})]})};function is(t){switch(t){case"daily":return{icon:"Activity",title:"Tracker",subtitle:"Suivez votre activité physique quotidienne",circuit:"activity",color:"#3B82F6"};case"insights":return{icon:"BarChart3",title:"Insights",subtitle:"Analyses avancées de vos performances",circuit:"activity",color:"#F59E0B"};case"progression":return{icon:"TrendingUp",title:"Progression",subtitle:"Évolution de vos performances physiques",circuit:"activity",color:"#10B981"};case"history":return{icon:"History",title:"Historique",subtitle:"Toutes vos séances et activités enregistrées",circuit:"activity",color:"#8B5CF6"};default:return{icon:"Activity",title:"Activité Physique",subtitle:"Suivez et analysez vos performances",circuit:"activity",color:"#3B82F6"}}}const gs=()=>{const t=Ye();X();const{showFeedback:r}=W(),s=k.useMemo(()=>{const h=t.hash.replace("#","");return(h?decodeURIComponent(h):"")||"daily"},[t.hash]),i=is(s),a=h=>{_.info("Activity tab changed",{tab:h})};return e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(We,{icon:i.icon,title:i.title,subtitle:i.subtitle,circuit:i.circuit,iconColor:i.color}),e.jsxs(U,{defaultValue:"daily",className:"w-full",onValueChange:a,forgeContext:"activity",children:[e.jsxs(U.List,{children:[e.jsx(U.Trigger,{value:"daily",icon:"Activity",children:"Tracker"}),e.jsx(U.Trigger,{value:"insights",icon:"BarChart3",children:"Insights"}),e.jsx(U.Trigger,{value:"progression",icon:"TrendingUp",children:"Progression"}),e.jsx(U.Trigger,{value:"history",icon:"History",children:"Historique"})]}),e.jsx(U.Panel,{value:"daily",className:"mt-6",children:e.jsx(Dt,{})}),e.jsx(U.Panel,{value:"insights",className:"mt-6",children:e.jsx(Vt,{})}),e.jsx(U.Panel,{value:"progression",className:"mt-6",children:e.jsx(es,{})}),e.jsx(U.Panel,{value:"history",className:"mt-6",children:e.jsx(rs,{})})]})]})};export{gs as default};
